diff -Naur inputbak/README.md input/README.md
--- inputbak/README.md	2026-01-01 18:27:33.889989921 +0300
+++ input/README.md	2026-01-01 18:28:05.437989909 +0300
@@ -13,6 +13,22 @@
 
 If you'd like to help translate microG, take a look at [TRANSLATION](TRANSLATION.md).
 
+About this fork
+-------
+This repository is a fork of [microG GmsCore](https://github.com/microg/GmsCore) to allow patched Google apps to run without root and under a different package name using GmsCore instead of Google Play Services, via the "GmsCore support" patch by ReVanced from [ReVanced Patches](https://github.com/revanced/revanced-patches) with the minimum amount of changes necessary to upstream.
+
+Goals of this fork:
+- Run next to an existing GMS installation such as [microG GmsCore](https://github.com/microg/GmsCore) or Google Play Services.
+- Usage with the "GmsCore support" patch by ReVanced from [ReVanced Patches](https://github.com/revanced/revanced-patches)
+- Feature parity with upstream
+
+Nongoals of this fork:
+- New features that do not contribute to the goal of this fork
+- Bug fixes that do not contribute to the goal of this fork
+
+Contributing to the fork
+-------
+You can create an issue or pull request to contribute to the fork. In both cases, ensure it aligns with this fork's goals.
 
 License
 -------
diff -Naur inputbak/build.gradle input/build.gradle
--- inputbak/build.gradle	2026-01-01 18:27:33.897989921 +0300
+++ input/build.gradle	2026-01-01 18:28:05.437989909 +0300
@@ -4,6 +4,9 @@
  */
 
 buildscript {
+    ext.applicationNamespace = "com.google.android.gms"
+    ext.basePackageName = "app.revanced"
+
     ext.cronetVersion = '102.5005.125'
     ext.wearableVersion = '0.1.1'
 
diff -Naur inputbak/firebase-auth/core/build.gradle input/firebase-auth/core/build.gradle
--- inputbak/firebase-auth/core/build.gradle	2026-01-01 18:27:33.901989921 +0300
+++ input/firebase-auth/core/build.gradle	2026-01-01 18:28:05.441989909 +0300
@@ -33,6 +33,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/firebase-auth/core/src/main/AndroidManifest.xml input/firebase-auth/core/src/main/AndroidManifest.xml
--- inputbak/firebase-auth/core/src/main/AndroidManifest.xml	2026-01-01 18:27:33.901989921 +0300
+++ input/firebase-auth/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.441989909 +0300
@@ -12,7 +12,7 @@
     <application>
         <service android:name="org.microg.gms.firebase.auth.FirebaseAuthService">
             <intent-filter>
-                <action android:name="com.google.firebase.auth.api.gms.service.START" />
+                <action android:name="${basePackageName}.firebase.auth.api.gms.service.START" />
             </intent-filter>
         </service>
         <activity
diff -Naur inputbak/gradle.properties input/gradle.properties
--- inputbak/gradle.properties	2026-01-01 18:27:33.921989921 +0300
+++ input/gradle.properties	2026-01-01 18:28:05.441989909 +0300
@@ -2,3 +2,4 @@
 org.gradle.configuration-cache=true
 org.gradle.caching=true
 org.gradle.jvmargs=-Xmx4096m -XX:+UseParallelGC --add-exports=jdk.compiler/com.sun.tools.javac.main=ALL-UNNAMED
+android.enableJetifier=true
diff -Naur inputbak/play-services-ads/core/build.gradle input/play-services-ads/core/build.gradle
--- inputbak/play-services-ads/core/build.gradle	2026-01-01 18:27:33.949989921 +0300
+++ input/play-services-ads/core/build.gradle	2026-01-01 18:28:05.441989909 +0300
@@ -23,6 +23,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-ads/core/src/main/AndroidManifest.xml input/play-services-ads/core/src/main/AndroidManifest.xml
--- inputbak/play-services-ads/core/src/main/AndroidManifest.xml	2026-01-01 18:27:33.949989921 +0300
+++ input/play-services-ads/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.441989909 +0300
@@ -7,7 +7,7 @@
     <application>
         <service android:name="org.microg.gms.ads.AdRequestService">
             <intent-filter>
-                <action android:name="com.google.android.gms.ads.service.START" />
+                <action android:name="${basePackageName}.android.gms.ads.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
diff -Naur inputbak/play-services-ads-identifier/core/build.gradle input/play-services-ads-identifier/core/build.gradle
--- inputbak/play-services-ads-identifier/core/build.gradle	2026-01-01 18:27:33.925989921 +0300
+++ input/play-services-ads-identifier/core/build.gradle	2026-01-01 18:28:05.445989909 +0300
@@ -21,6 +21,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-ads-identifier/core/src/main/AndroidManifest.xml input/play-services-ads-identifier/core/src/main/AndroidManifest.xml
--- inputbak/play-services-ads-identifier/core/src/main/AndroidManifest.xml	2026-01-01 18:27:33.925989921 +0300
+++ input/play-services-ads-identifier/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.445989909 +0300
@@ -8,7 +8,7 @@
     <application>
         <service android:name=".AdvertisingIdService">
             <intent-filter>
-                <action android:name="com.google.android.gms.ads.identifier.service.START" />
+                <action android:name="${basePackageName}.android.gms.ads.identifier.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
diff -Naur inputbak/play-services-ads-identifier/core/src/main/kotlin/org/microg/gms/ads/identifier/AdvertisingIdService.kt input/play-services-ads-identifier/core/src/main/kotlin/org/microg/gms/ads/identifier/AdvertisingIdService.kt
--- inputbak/play-services-ads-identifier/core/src/main/kotlin/org/microg/gms/ads/identifier/AdvertisingIdService.kt	2026-01-01 18:27:33.925989921 +0300
+++ input/play-services-ads-identifier/core/src/main/kotlin/org/microg/gms/ads/identifier/AdvertisingIdService.kt	2026-01-01 18:28:05.445989909 +0300
@@ -14,6 +14,7 @@
 import android.util.Log
 import androidx.core.os.bundleOf
 import com.google.android.gms.ads.identifier.internal.IAdvertisingIdService
+import com.google.android.gms.common.BuildConfig
 import org.microg.gms.common.GooglePackagePermission
 import org.microg.gms.common.PackageUtils
 import java.util.UUID
@@ -64,7 +65,7 @@
             for (packageName in packageNames) {
                 val applicationInfo = context.packageManager.getApplicationInfo(packageName, 0)
                 if (applicationInfo.targetSdkVersion > 33) {
-                    if (context.packageManager.checkPermission("com.google.android.gms.permission.AD_ID", packageName) == PackageManager.PERMISSION_DENIED) {
+                    if (context.packageManager.checkPermission(BuildConfig.BASE_PACKAGE_NAME + ".android.gms.permission.AD_ID", packageName) == PackageManager.PERMISSION_DENIED) {
                         throw SecurityException("Permission not granted")
                     }
                 }
diff -Naur inputbak/play-services-ads-lite/build.gradle input/play-services-ads-lite/build.gradle
--- inputbak/play-services-ads-lite/build.gradle	2026-01-01 18:27:33.937989921 +0300
+++ input/play-services-ads-lite/build.gradle	2026-01-01 18:28:05.445989909 +0300
@@ -21,6 +21,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     compileOptions {
diff -Naur inputbak/play-services-ads-lite/src/main/AndroidManifest.xml input/play-services-ads-lite/src/main/AndroidManifest.xml
--- inputbak/play-services-ads-lite/src/main/AndroidManifest.xml	2026-01-01 18:27:33.937989921 +0300
+++ input/play-services-ads-lite/src/main/AndroidManifest.xml	2026-01-01 18:28:05.449989909 +0300
@@ -6,7 +6,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android">
     <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
-    <uses-permission android:name="com.google.android.gms.permission.AD_ID" />
+    <uses-permission android:name="${basePackageName}.android.gms.permission.AD_ID" />
 
     <queries>
         <!-- Website links -->
diff -Naur inputbak/play-services-appinvite/core/build.gradle input/play-services-appinvite/core/build.gradle
--- inputbak/play-services-appinvite/core/build.gradle	2026-01-01 18:27:34.017989921 +0300
+++ input/play-services-appinvite/core/build.gradle	2026-01-01 18:28:05.449989909 +0300
@@ -27,6 +27,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-appinvite/core/src/main/AndroidManifest.xml input/play-services-appinvite/core/src/main/AndroidManifest.xml
--- inputbak/play-services-appinvite/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.017989921 +0300
+++ input/play-services-appinvite/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.449989909 +0300
@@ -11,7 +11,7 @@
             android:name="org.microg.gms.appinivite.AppInviteService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.appinvite.service.START" />
+                <action android:name="${basePackageName}.android.gms.appinvite.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
@@ -37,7 +37,7 @@
                 <data android:pathPrefix="/" />
             </intent-filter>
             <intent-filter>
-                <action android:name="com.google.firebase.dynamiclinks.VIEW_DYNAMIC_LINK" />
+                <action android:name="${basePackageName}.firebase.dynamiclinks.VIEW_DYNAMIC_LINK" />
 
                 <category android:name="android.intent.category.BROWSABLE" />
                 <category android:name="android.intent.category.DEFAULT" />
diff -Naur inputbak/play-services-appset/core/build.gradle input/play-services-appset/core/build.gradle
--- inputbak/play-services-appset/core/build.gradle	2026-01-01 18:27:34.017989921 +0300
+++ input/play-services-appset/core/build.gradle	2026-01-01 18:28:05.449989909 +0300
@@ -28,6 +28,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-appset/core/src/main/AndroidManifest.xml input/play-services-appset/core/src/main/AndroidManifest.xml
--- inputbak/play-services-appset/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.017989921 +0300
+++ input/play-services-appset/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.453989909 +0300
@@ -9,7 +9,7 @@
 
         <service android:name="org.microg.gms.appset.AppSetService">
             <intent-filter>
-                <action android:name="com.google.android.gms.appset.service.START" />
+                <action android:name="${basePackageName}.android.gms.appset.service.START" />
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/play-services-auth-api-phone/core/build.gradle input/play-services-auth-api-phone/core/build.gradle
--- inputbak/play-services-auth-api-phone/core/build.gradle	2026-01-01 18:27:34.021989921 +0300
+++ input/play-services-auth-api-phone/core/build.gradle	2026-01-01 18:28:05.453989909 +0300
@@ -23,6 +23,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-auth-api-phone/core/src/main/AndroidManifest.xml input/play-services-auth-api-phone/core/src/main/AndroidManifest.xml
--- inputbak/play-services-auth-api-phone/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.021989921 +0300
+++ input/play-services-auth-api-phone/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.453989909 +0300
@@ -27,7 +27,7 @@
             android:name="org.microg.gms.auth.phone.SmsRetrieverService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.phone.service.SmsRetrieverApiService.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.phone.service.SmsRetrieverApiService.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
diff -Naur inputbak/play-services-base/build.gradle input/play-services-base/build.gradle
--- inputbak/play-services-base/build.gradle	2026-01-01 18:27:34.077989921 +0300
+++ input/play-services-base/build.gradle	2026-01-01 18:28:05.453989909 +0300
@@ -19,12 +19,15 @@
 
     buildFeatures {
         aidl = true
+        buildConfig = true
     }
 
     defaultConfig {
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        buildConfigField "String", "BASE_PACKAGE_NAME", "\"$basePackageName\""
     }
 
     compileOptions {
diff -Naur inputbak/play-services-base/build.gradle.orig input/play-services-base/build.gradle.orig
--- inputbak/play-services-base/build.gradle.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-base/build.gradle.orig	2026-01-01 18:28:05.453989909 +0300
@@ -0,0 +1,49 @@
+/*
+ * SPDX-FileCopyrightText: 2015 microG Project Team
+ * SPDX-License-Identifier: Apache-2.0
+ */
+
+apply plugin: 'com.android.library'
+apply plugin: 'maven-publish'
+apply plugin: 'signing'
+
+android {
+    namespace "com.google.android.gms.base"
+
+    compileSdkVersion androidCompileSdk
+    buildToolsVersion "$androidBuildVersionTools"
+
+    aidlPackagedList "com/google/android/gms/common/data/DataHolder.aidl"
+    aidlPackagedList "com/google/android/gms/common/images/WebImage.aidl"
+    aidlPackagedList "com/google/android/gms/common/api/internal/IStatusCallback.aidl"
+
+    buildFeatures {
+        aidl = true
+    }
+
+    defaultConfig {
+        versionName version
+        minSdkVersion androidMinSdk
+        targetSdkVersion androidTargetSdk
+    }
+
+    compileOptions {
+        sourceCompatibility = 1.8
+        targetCompatibility = 1.8
+    }
+}
+
+apply from: '../gradle/publish-android.gradle'
+
+description = 'microG implementation of play-services-base'
+
+dependencies {
+    // Dependencies from play-services-base:18.8.0
+    api 'androidx.collection:collection:1.0.0'
+    api 'androidx.core:core:1.9.0'
+    api 'androidx.fragment:fragment:1.1.0'
+    api project(':play-services-basement')
+    api project(':play-services-tasks')
+
+    annotationProcessor project(':safe-parcel-processor')
+}
diff -Naur inputbak/play-services-base/core/package/build.gradle input/play-services-base/core/package/build.gradle
--- inputbak/play-services-base/core/package/build.gradle	2026-01-01 18:27:34.077989921 +0300
+++ input/play-services-base/core/package/build.gradle	2026-01-01 18:28:05.457989909 +0300
@@ -22,6 +22,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-base/core/package/src/main/AndroidManifest.xml input/play-services-base/core/package/src/main/AndroidManifest.xml
--- inputbak/play-services-base/core/package/src/main/AndroidManifest.xml	2026-01-01 18:27:34.077989921 +0300
+++ input/play-services-base/core/package/src/main/AndroidManifest.xml	2026-01-01 18:28:05.457989909 +0300
@@ -15,7 +15,7 @@
             android:name="org.microg.gms.moduleinstall.ModuleInstallService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.chimera.container.moduleinstall.ModuleInstallService.START" />
+                <action android:name="${basePackageName}.android.gms.chimera.container.moduleinstall.ModuleInstallService.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
diff -Naur inputbak/play-services-base/core/src/main/java/org/microg/gms/AbstractGmsServiceBroker.java input/play-services-base/core/src/main/java/org/microg/gms/AbstractGmsServiceBroker.java
--- inputbak/play-services-base/core/src/main/java/org/microg/gms/AbstractGmsServiceBroker.java	2026-01-01 18:27:34.081989921 +0300
+++ input/play-services-base/core/src/main/java/org/microg/gms/AbstractGmsServiceBroker.java	2026-01-01 18:28:05.457989909 +0300
@@ -23,6 +23,7 @@
 import android.os.RemoteException;
 import android.util.Log;
 
+import com.google.android.gms.common.BuildConfig;
 import com.google.android.gms.common.api.Scope;
 import com.google.android.gms.common.internal.*;
 
diff -Naur inputbak/play-services-base/core/src/main/java/org/microg/gms/common/PackageUtils.java input/play-services-base/core/src/main/java/org/microg/gms/common/PackageUtils.java
--- inputbak/play-services-base/core/src/main/java/org/microg/gms/common/PackageUtils.java	2026-01-01 18:27:34.081989921 +0300
+++ input/play-services-base/core/src/main/java/org/microg/gms/common/PackageUtils.java	2026-01-01 18:28:05.457989909 +0300
@@ -28,6 +28,7 @@
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import com.google.android.gms.common.BuildConfig;
 import org.microg.gms.utils.ExtendedPackageInfo;
 
 import java.lang.reflect.Method;
@@ -50,6 +51,7 @@
 
     @Deprecated
     public static boolean isGooglePackage(@NonNull Context context, @Nullable String packageName) {
+        packageName = PackageSpoofUtils.spoofPackageName(context.getPackageManager(), packageName);
         if (packageName == null) return false;
         return new ExtendedPackageInfo(context, packageName).isGoogleOrPlatformPackage();
     }
@@ -59,7 +61,7 @@
      */
     @Deprecated
     public static boolean callerHasExtendedAccessPermission(@NonNull Context context) {
-        return context.checkCallingPermission("org.microg.gms.EXTENDED_ACCESS") == PackageManager.PERMISSION_GRANTED;
+        return context.checkCallingPermission(BuildConfig.BASE_PACKAGE_NAME + ".microg.gms.EXTENDED_ACCESS") == PackageManager.PERMISSION_GRANTED;
     }
 
     public static void assertGooglePackagePermission(@NonNull Context context, GooglePackagePermission permission) {
@@ -74,7 +76,17 @@
 
     public static boolean callerHasGooglePackagePermission(@NonNull Context context, GooglePackagePermission permission) {
         for (String packageCandidate : getCallingPackageCandidates(context)) {
-            if (new ExtendedPackageInfo(context, packageCandidate).hasGooglePackagePermission(permission)) {
+            String packageName = PackageSpoofUtils.spoofPackageName(
+                    context.getPackageManager(),
+                    packageCandidate
+            );
+
+            // See https://github.com/ReVanced/GmsCore/issues/10.
+            ExtendedPackageInfo extendedPackageInfo = new ExtendedPackageInfo(context, packageName);
+            if (!extendedPackageInfo.isInstalled())
+                return true;
+
+            if (new ExtendedPackageInfo(context, packageName).hasGooglePackagePermission(permission)) {
                 return true;
             }
         }
@@ -185,7 +197,7 @@
         if (packageName == null) {
             packageName = firstPackageFromUserId(context, callingUid);
         }
-        return packageName;
+        return PackageSpoofUtils.spoofPackageName(context.getPackageManager(), packageName);
     }
 
     public static String[] getCallingPackageCandidates(@NonNull Context context) {
diff -Naur inputbak/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt input/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt
--- inputbak/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt	2026-01-01 18:27:34.085989921 +0300
+++ input/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt	2026-01-01 18:28:05.461989909 +0300
@@ -91,6 +91,10 @@
         PERMISSIONS_PRIVILEGED
     ),
     Pair(
+        PackageAndCertHash("com.google.android.apps.youtube", SHA1, "24bb24c05e47e0aefa68a58a766179d9b613a600"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
         PackageAndCertHash("com.google.android.apps.youtube.music", SHA1, "afb0fed5eeaebdd86f56a97742f4b6b33ef59875"),
         PERMISSIONS_PRIVILEGED
     ),
diff -Naur inputbak/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt.orig input/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt.orig
--- inputbak/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-base/core/src/main/kotlin/org/microg/gms/common/KnownGooglePackages.kt.orig	2026-01-01 18:27:15.529989928 +0300
@@ -0,0 +1,229 @@
+/*
+ * SPDX-FileCopyrightText: 2024 microG Project Team
+ * SPDX-License-Identifier: Apache-2.0
+ */
+
+package org.microg.gms.common
+
+import com.google.android.gms.common.internal.CertData
+import org.microg.gms.common.GooglePackagePermission.*
+import org.microg.gms.utils.digest
+import org.microg.gms.utils.toHexString
+
+enum class GooglePackagePermission {
+    ACCOUNT, // Find accounts
+    AD_ID, // Advertising ID
+    APP_CERT, // Receive certificate confirming valid app installation (incl. Spatula)
+    AUTH, // Sign in to Google account without user interface confirmation
+    CREDENTIALS, // Access to credentials
+    GAMES, // Google Play Games first party access
+    IMPERSONATE, // Allow to act as another package
+    OWNER, // Details about own accounts (name, email, photo)
+    PEOPLE, // Details about contacts
+    REPORTING, // Access reporting service
+    SAFETYNET, // Access SafetyNet UUID
+    WALLET,
+}
+
+// These are SHA-256 hashes of the Google privileged signing certificates
+private val KNOWN_GOOGLE_PRIVILEGED_CERT_HASHES = listOf(
+    "f0fd6c5b410f25cb25c3b53346c8972fae30f8ee7411df910480ad6b2d60db83",
+    "7ce83c1b71f3d572fed04c8d40c5cb10ff75e6d87d9df6fbd53f0468c2905053",
+)
+
+// These are the permissions that we grant to apps signed with a Google
+// privileged platform signing certificate. Those could be in the same
+// shared UID on regular Play Services and thus have full access by
+// design, as they could even directly access all private details in GMS.
+private val PERMISSIONS_PRIVILEGED = GooglePackagePermission.entries.toSet()
+
+// These are SHA-256 hashes of signing certificates used by official Google apps
+// Signing certificates that are only used for a small number of apps are likely not
+// official Google apps, but either acquisitions or independent teams / projects
+// within Google. We don't put them here, but via KNOWN_GOOGLE_PACKAGES.
+private val KNOWN_GOOGLE_APP_CERT_HASHES = listOf(
+    "3d7a1223019aa39d9ea0e3436ab7c0896bfb4fb679f4de5fe7c23f326c8f994a"
+)
+
+// This is a subset of permissions that we grant to apps signed with an official
+// Google apps certificate. Note that this has lower priority than the
+// KNOWN_GOOGLE_PACKAGES list, so if any app needs more permissions than this,
+// this can be handled through KNOWN_GOOGLE_PACKAGES.
+private val PERMISSIONS_APP = setOf(ACCOUNT, APP_CERT, AUTH, OWNER, PEOPLE, REPORTING, SAFETYNET)
+
+private const val SHA1 = "SHA1"
+private const val SHA256 = "SHA-256"
+
+data class PackageAndCertHash(val packageName: String, val algorithm: String, val certHash: String)
+
+private val KNOWN_GOOGLE_PACKAGES = mapOf(
+    // Legacy set
+    // These include all previously KNOWN_GOOGLE_PACKAGES and grant them all google package permissions
+    // Those should be replaced by new entries that
+    // - use SHA-256 instead of SHA-1
+    // - has more accurate permission set (in most cases, ACCOUNT+AUTH+OWNER is sufficient)
+    Pair(
+        PackageAndCertHash("com.google.android.apps.classroom", SHA1, "46f6c8987311e131f4f558d8e0ae145bebab6da3"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.inbox", SHA1, "aa87ce1260c008d801197bb4ecea4ab8929da246"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.playconsole", SHA1, "d6c35e55b481aefddd74152ca7254332739a81d6"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.travel.onthego", SHA1, "0cbe08032217d45e61c0bc72f294395ee9ecb5d5"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.tycho", SHA1, "01b844184e360686aa98b48eb16e05c76d4a72ad"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.contacts", SHA1, "ee3e2b5d95365c5a1ccc2d8dfe48d94eb33b3ebe"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.wearable.app", SHA1, "a197f9212f2fed64f0ff9c2a4edf24b9c8801c8c"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.youtube.music", SHA1, "afb0fed5eeaebdd86f56a97742f4b6b33ef59875"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.vr.home", SHA1, "fc1edc68f7e3e4963c998e95fc38f3de8d1bfc96"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.vr.cyclops", SHA1, "188c5ca3863fa121216157a5baa80755ceda70ab"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.waze", SHA1, "35b438fe1bc69d975dc8702dc16ab69ebf65f26f"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.wellbeing", SHA1, "4ebdd02380f1fa0b6741491f0af35625dba76e9f"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.village.boond", SHA1, "48e7985b8f901df335b5d5223579c81618431c7b"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.subscriptions.red", SHA1, "de8304ace744ae4c4e05887a27a790815e610ff0"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.meetings", SHA1, "47a6936b733dbdb45d71997fbe1d610eca36b8bf"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.nbu.paisa.user", SHA1, "80df78bb700f9172bc671779b017ddefefcbf552"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.dynamite", SHA1, "519c5a17a60596e6fe5933b9cb4285e7b0e5eb7b"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.projection.gearhead", SHA1, "9ca91f9e704d630ef67a23f52bf1577a92b9ca5d"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.stadia.android", SHA1, "133aad3b3d3b580e286573c37f20549f9d3d1cce"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.kids.familylink", SHA1, "88652b8464743e5ce80da0d4b890d13f9b1873df"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.walletnfcrel", SHA1, "82759e2db43f9ccbafce313bc674f35748fabd7a"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.recorder", SHA1, "394d84cd2cf89d3453702c663f98ec6554afc3cd"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.messaging", SHA1, "0980a12be993528c19107bc21ad811478c63cefc"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.tachyon", SHA1, "a0bc09af527b6397c7a9ef171d6cf76f757becc3"),
+        PERMISSIONS_PRIVILEGED
+    ),
+    Pair(
+        PackageAndCertHash("com.google.android.apps.access.wifi.consumer", SHA1,"d850379540d68fbec82a742ab6a8321a3f9a4c7c"),
+        PERMISSIONS_PRIVILEGED
+    ),
+
+    // Google Jamboard
+    Pair(
+        PackageAndCertHash("com.google.android.apps.jam", SHA256, "9db7ff389ab6a30d5f5c92a8629ff0baa93fa8430f0503c04d72640a1cf323f5"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Fitbit
+    Pair(
+        PackageAndCertHash("com.fitbit.FitbitMobile", SHA256, "fa6a198803aac1939fed6bab9295e5184c00966bf912f8c5faff26576cc770ff"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Google Tasks
+    Pair(
+        PackageAndCertHash("com.google.android.apps.tasks", SHA256, "99f6cc5308e6f3318a3bf168bf106d5b5defe2b4b9c561e5ddd7924a7a2ba1e2"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Google familylink
+    Pair(
+        PackageAndCertHash("com.google.android.apps.kids.familylink", SHA256, "6b58bb84c1c6d081d950448ff5c051a34769d7fd8d415452c86efeb808716c0e"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Google Kids home
+    Pair(
+        PackageAndCertHash("com.google.android.apps.kids.home", SHA256, "8f7bd4c5c0273a1a0dd6b3bfa8cc8e9f980a25108adcfd7be9962e8ae9feeb6f"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Google GFiber
+    Pair(
+        PackageAndCertHash("com.google.android.apps.fiber.myfiber", SHA256, "4a853c50adda4406495652fe78f32252757c8dd761f3601a7b2e0df86291429d"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Google NotebookLM
+    Pair(
+        PackageAndCertHash("com.google.android.apps.labs.language.tailwind", SHA256, "ba49176908275f83be9ae1034968f0b18e65177a64e5a40b3a621f148dfb6fa2"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+
+    // Waymo
+    Pair(
+        PackageAndCertHash("com.waymo.carapp", SHA256, "c600dafe48f6ee770dd814261bd4b64708bc19dd014322107b58e836d8f2634e"),
+        setOf(ACCOUNT, AUTH, OWNER)
+    ),
+)
+
+fun isGooglePackage(pkg: PackageAndCertHash): Boolean {
+    if (pkg.algorithm == SHA256 && pkg.certHash in KNOWN_GOOGLE_PRIVILEGED_CERT_HASHES) return true
+    if (pkg.algorithm == SHA256 && pkg.certHash in KNOWN_GOOGLE_APP_CERT_HASHES) return true
+    return KNOWN_GOOGLE_PACKAGES.containsKey(pkg)
+}
+fun getGooglePackagePermissions(pkg: PackageAndCertHash): Set<GooglePackagePermission> {
+    if (KNOWN_GOOGLE_PACKAGES.containsKey(pkg)) return KNOWN_GOOGLE_PACKAGES[pkg].orEmpty()
+    if (pkg.algorithm == SHA256 && pkg.certHash in KNOWN_GOOGLE_PRIVILEGED_CERT_HASHES) return PERMISSIONS_PRIVILEGED
+    if (pkg.algorithm == SHA256 && pkg.certHash in KNOWN_GOOGLE_APP_CERT_HASHES) return PERMISSIONS_APP
+    return emptySet()
+}
+fun hasGooglePackagePermission(pkg: PackageAndCertHash, permission: GooglePackagePermission) = getGooglePackagePermissions(pkg).contains(permission)
+
+fun isGooglePackage(packageName: String, certificate: CertData): Boolean =
+    listOf(SHA1, SHA256).any { isGooglePackage(PackageAndCertHash(packageName, it, certificate.digest(it).toHexString())) }
\ No newline at end of file
diff -Naur inputbak/play-services-base/core/src/main/kotlin/org/microg/gms/common/PackageSpoofUtils.kt input/play-services-base/core/src/main/kotlin/org/microg/gms/common/PackageSpoofUtils.kt
--- inputbak/play-services-base/core/src/main/kotlin/org/microg/gms/common/PackageSpoofUtils.kt	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-base/core/src/main/kotlin/org/microg/gms/common/PackageSpoofUtils.kt	2026-01-01 18:28:05.461989909 +0300
@@ -0,0 +1,157 @@
+package org.microg.gms.common
+
+import android.content.pm.PackageManager
+import android.os.Bundle
+import android.util.Log
+import com.google.android.gms.common.BuildConfig
+import java.util.*
+
+// Slightly modified implementation from https://github.com/shadow578
+/**
+ * Utilities to spoof package information.
+ */
+object PackageSpoofUtils {
+    private const val TAG = "SpoofUtils"
+    private const val META_SPOOF_PACKAGE_NAME =
+        BuildConfig.BASE_PACKAGE_NAME + ".android.gms.SPOOFED_PACKAGE_NAME"
+    private const val META_SPOOF_PACKAGE_SIGNATURE =
+        BuildConfig.BASE_PACKAGE_NAME + ".android.gms.SPOOFED_PACKAGE_SIGNATURE"
+
+    private val spoofedPackageNameCache = HashMap<String, String>()
+    private val spoofedPackageSignatureCache = HashMap<String, String>()
+
+    /**
+     * Spoof the package name of a package, if a spoofed name is set.
+     *
+     * @param packageManager [PackageManager] used to get package information.
+     * @param realPackageName The real package name.
+     * @return Either the spoofed or the real package name, depending on if the package requested spoofing.
+     */
+    @JvmStatic
+    fun spoofPackageName(
+        packageManager: PackageManager,
+        realPackageName: String?
+    ): String? {
+        if (realPackageName.isNullOrEmpty()) return realPackageName
+
+        val spoofedPackageName = getSpoofedPackageName(packageManager, realPackageName)
+        return if (!spoofedPackageName.isNullOrEmpty()) {
+            Log.i(TAG, "Package name of $realPackageName spoofed to $spoofedPackageName")
+            spoofedPackageName
+        } else realPackageName
+    }
+
+    /**
+     * Spoof the signature of a package, if a spoofed name is set.
+     *
+     * @param packageManager [PackageManager] used to get package information.
+     * @param packageName Name of the package to check.
+     * @param realSignature The real package signature.
+     * @return Either the spoofed or the real signature, depending on if the package requested spoofing.
+     */
+    @JvmStatic
+    @JvmName("spoofStringSignature")
+    fun spoofSignature(
+        packageManager: PackageManager,
+        packageName: String,
+        realSignature: String?
+    ): String? {
+        val spoofedSignature = getSpoofedSignature(packageManager, packageName)
+
+        if (spoofedSignature.isNullOrEmpty()) return realSignature
+
+        Log.i(TAG, "Package signature of $packageName spoofed to $spoofedSignature")
+        return spoofedSignature
+    }
+
+    /**
+     * Spoof the signature of a package, if a spoofed name is set.
+     *
+     * @param packageManager [PackageManager] used to get package information.
+     * @param packageName Name of the package to check.
+     * @param realSignature The real package signature.
+     * @return Either the spoofed or the real signature, depending on if the package requested spoofing.
+     */
+    @JvmStatic
+    @JvmName("spoofBytesSignature")
+    fun spoofSignature(
+        packageManager: PackageManager,
+        packageName: String,
+        realSignature: ByteArray?
+    ): ByteArray? {
+        val spoofedSignatureString = getSpoofedSignature(packageManager, packageName)
+
+        if (spoofedSignatureString.isNullOrEmpty()) return realSignature
+
+        Log.i(TAG, "Package signature of $packageName spoofed to $spoofedSignatureString")
+
+        return spoofedSignatureString.chunked(2)
+            .map { it.toInt(16).toByte() }
+            .toByteArray()
+    }
+
+    /**
+     * Get the spoofed package name for a package.
+     *
+     * @param packageManager [PackageManager] used to get package information.
+     * @param packageName Name of the package to get the spoofed name of.
+     * @return Spoofed name string, or null if none set.
+     */
+    private fun getSpoofedPackageName(
+        packageManager: PackageManager,
+        packageName: String
+    ): String? {
+        return spoofedPackageNameCache[packageName] ?: run {
+            val meta = getPackageMetadata(packageManager, packageName)
+            val spoofedPackageName = meta?.getString(META_SPOOF_PACKAGE_NAME)
+            if (spoofedPackageName != null) {
+                spoofedPackageNameCache[packageName] = spoofedPackageName
+            }
+
+            spoofedPackageName
+        }
+    }
+
+    /**
+     * Get the spoofed package signature for a package.
+     *
+     * @param packageManager [PackageManager] used to get package information.
+     * @param packageName Name of the package to get spoofed signature of.
+     * @return Spoofed signature string, or null if none set.
+     */
+    private fun getSpoofedSignature(
+        packageManager: PackageManager,
+        packageName: String
+    ): String? {
+        return spoofedPackageSignatureCache[packageName] ?: run {
+            val meta = getPackageMetadata(packageManager, packageName)
+            val spoofedSignature = meta?.getString(META_SPOOF_PACKAGE_SIGNATURE)
+            if (spoofedSignature != null) {
+                spoofedPackageSignatureCache[packageName] = spoofedSignature
+            }
+
+            spoofedSignature
+        }
+    }
+
+    /**
+     * Get package metadata.
+     *
+     * @param packageManager [PackageManager] used to get package information.
+     * @param packageName Name of the package to get metadata of.
+     * @return Package metadata bundle.
+     */
+    private fun getPackageMetadata(packageManager: PackageManager, packageName: String): Bundle? {
+        return try {
+            // PackageManager.getPackageInfo() has been deprecated in targetSdkVersion 30+
+            // To solve this, add the QUERY_ALL_PACKAGES permission to AndroidManifest.xml
+            packageManager
+                .getPackageInfo(packageName, PackageManager.GET_META_DATA)
+                ?.applicationInfo
+                ?.metaData
+        } catch (e: PackageManager.NameNotFoundException) {
+            Log.e(TAG, "Failed to get application metadata for $packageName", e)
+            null
+        }
+    }
+}
\ No newline at end of file
diff -Naur inputbak/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java input/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java
--- inputbak/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java	2026-01-01 18:27:34.129989921 +0300
+++ input/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java	2026-01-01 18:28:05.461989909 +0300
@@ -29,6 +29,7 @@
 import android.content.pm.Signature;
 import android.os.IBinder;
 import android.util.Log;
+import com.google.android.gms.base.BuildConfig;
 
 import java.security.MessageDigest;
 import java.security.NoSuchAlgorithmException;
@@ -297,7 +298,7 @@
             if (resolveInfo == null || resolveInfo.serviceInfo == null) return false;
             if (resolveInfo.serviceInfo.name.startsWith("org.microg.")) return true;
             try {
-                PermissionInfo info = context.getPackageManager().getPermissionInfo("org.microg.gms.EXTENDED_ACCESS", 0);
+                PermissionInfo info = context.getPackageManager().getPermissionInfo(BuildConfig.BASE_PACKAGE_NAME + ".microg.gms.EXTENDED_ACCESS", 0);
                 return info.packageName.equals(resolveInfo.serviceInfo.packageName);
             } catch (PackageManager.NameNotFoundException e) {
                 return false;
diff -Naur inputbak/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java.orig input/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java.orig
--- inputbak/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-base/src/main/java/org/microg/gms/common/MultiConnectionKeeper.java.orig	2026-01-01 18:28:05.465989909 +0300
@@ -0,0 +1,347 @@
+/*
+ * Copyright (C) 2013-2017 microG Project Team
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.microg.gms.common;
+
+import android.annotation.SuppressLint;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.ServiceConnection;
+import android.content.SharedPreferences;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.PermissionInfo;
+import android.content.pm.ResolveInfo;
+import android.content.pm.Signature;
+import android.os.IBinder;
+import android.util.Log;
+
+import java.security.MessageDigest;
+import java.security.NoSuchAlgorithmException;
+import java.util.Arrays;
+import java.util.HashMap;
+import java.util.HashSet;
+import java.util.LinkedList;
+import java.util.List;
+import java.util.Map;
+import java.util.Objects;
+import java.util.Set;
+
+import static android.os.Build.VERSION.SDK_INT;
+import static org.microg.gms.common.Constants.GMS_PACKAGE_NAME;
+import static org.microg.gms.common.Constants.USER_MICROG_PACKAGE_NAME;
+import static org.microg.gms.common.Constants.GMS_PACKAGE_SIGNATURE_SHA1;
+import static org.microg.gms.common.Constants.GMS_SECONDARY_PACKAGE_SIGNATURE_SHA1;
+import static org.microg.gms.common.Constants.MICROG_PACKAGE_SIGNATURE_SHA1;
+
+public class MultiConnectionKeeper {
+    private static final String TAG = "GmsMultiConKeeper";
+    private static final String PREF_NAME = "org.microg.gms_connection";
+    private static final String PREF_TARGET = "target";
+    private static final String[] GOOGLE_PRIMARY_KEYS = {GMS_PACKAGE_SIGNATURE_SHA1, GMS_SECONDARY_PACKAGE_SIGNATURE_SHA1};
+
+    private static final String[] MICROG_PRIMARY_KEYS = {MICROG_PACKAGE_SIGNATURE_SHA1};
+    private static MultiConnectionKeeper INSTANCE;
+
+    private final Context context;
+
+    private final String targetPackage;
+    private final Map<String, Connection> connections = new HashMap<String, Connection>();
+
+    private Boolean isSystem(PackageManager pm, String packageId) throws PackageManager.NameNotFoundException {
+        ApplicationInfo ai = pm.getApplicationInfo(packageId, PackageManager.GET_META_DATA);
+        return (ai.flags & (ApplicationInfo.FLAG_SYSTEM | ApplicationInfo.FLAG_UPDATED_SYSTEM_APP)) != 0;
+    }
+
+    private Boolean isGoogleOrMicrogSig(PackageManager pm, String packageId) throws PackageManager.NameNotFoundException {
+        List<String> signatures = new LinkedList<>(Arrays.asList(GOOGLE_PRIMARY_KEYS));
+        signatures.addAll(Arrays.asList(MICROG_PRIMARY_KEYS));
+        return signatureIsIn(pm, packageId, signatures);
+    }
+
+    private Boolean isSystemGoogleOrMicrogSig(PackageManager pm, String packageId) throws PackageManager.NameNotFoundException {
+        return isSystem(pm, packageId) || isGoogleOrMicrogSig(pm, packageId);
+    }
+
+    private Boolean isMicrogSig(PackageManager pm, String packageId) throws PackageManager.NameNotFoundException {
+        List<String> signatures = Arrays.asList(MICROG_PRIMARY_KEYS);
+        return signatureIsIn(pm, packageId, signatures);
+    }
+
+    private Boolean signatureIsIn(PackageManager pm, String packageId, List<String> signatures) throws PackageManager.NameNotFoundException {
+        Signature[] appSignatures = pm.getPackageInfo(packageId, PackageManager.GET_SIGNATURES).signatures;
+        for (Signature sig : appSignatures) {
+            if (sig != null && signatures.contains(sha1sum(sig.toByteArray())))
+                return true;
+        }
+        return false;
+    }
+
+    private String sha1sum(byte[] bytes) {
+        MessageDigest md;
+        try {
+            md = MessageDigest.getInstance("SHA1");
+        } catch (final NoSuchAlgorithmException e) {
+            return null;
+        }
+        if (md != null) {
+            bytes = md.digest(bytes);
+            if (bytes != null) {
+                StringBuilder sb = new StringBuilder(2 * bytes.length);
+                for (byte b : bytes) {
+                    sb.append(String.format("%02x", b));
+                }
+                return sb.toString();
+            }
+        }
+        return null;
+    }
+
+    private String getTargetPackageWithoutPref() {
+        // Pref: gms > microG > self
+        PackageManager pm = context.getPackageManager();
+        try {
+            if (isSystemGoogleOrMicrogSig(pm, GMS_PACKAGE_NAME)) {
+                Log.d(TAG, GMS_PACKAGE_NAME + " found !");
+                return GMS_PACKAGE_NAME;
+            } else {
+                Log.w(TAG, GMS_PACKAGE_NAME + " found with another signature");
+            }
+        } catch (PackageManager.NameNotFoundException e) {
+            Log.d(TAG, GMS_PACKAGE_NAME + " not found");
+        }
+        try {
+            if (isMicrogSig(pm, USER_MICROG_PACKAGE_NAME)) {
+                Log.d(TAG, USER_MICROG_PACKAGE_NAME + " found !");
+                return USER_MICROG_PACKAGE_NAME;
+            } else {
+                Log.w(TAG, USER_MICROG_PACKAGE_NAME + " found with another signature");
+            }
+        } catch (PackageManager.NameNotFoundException e) {
+            Log.d(TAG, USER_MICROG_PACKAGE_NAME + " not found");
+        }
+        return context.getPackageName();
+    }
+
+    private String getTargetPackage() {
+        SharedPreferences prefs = context.getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);
+        String target;
+        if ((target = prefs.getString(PREF_TARGET, null)) != null) {
+            return target;
+        }
+        target = getTargetPackageWithoutPref();
+        prefs.edit().putString(PREF_TARGET, target).apply();
+        return target;
+    }
+
+    public MultiConnectionKeeper(Context context) {
+        this.context = context;
+        targetPackage = getTargetPackage();
+    }
+
+    public synchronized static MultiConnectionKeeper getInstance(Context context) {
+        if (INSTANCE == null)
+            INSTANCE = new MultiConnectionKeeper(context.getApplicationContext());
+        return INSTANCE;
+    }
+
+    public synchronized boolean bind(String action, ServiceConnection connection) {
+        return bind(action, connection, false);
+    }
+
+    public synchronized boolean bind(String action, ServiceConnection connection, boolean requireMicrog) {
+        Connection con = connections.get(action);
+        Log.d(TAG, "bind(" + action + ", " + connection + ", " + requireMicrog + ") has=" + (con != null));
+        if (con != null) {
+            if (!con.forwardsConnection(connection)) {
+                con.addConnectionForward(connection);
+                if (!con.isBound())
+                    con.bind();
+            }
+        } else {
+            con = new Connection(action, requireMicrog);
+            con.addConnectionForward(connection);
+            con.bind();
+            connections.put(action, con);
+        }
+        Log.d(TAG, "bind() : bound=" + con.isBound());
+        return con.isBound();
+    }
+
+    public synchronized void unbind(String action, ServiceConnection connection) {
+        Log.d(TAG, "unbind(" + action + ", " + connection + ")");
+        Connection con = connections.get(action);
+        if (con != null) {
+            con.removeConnectionForward(connection);
+            if (con.isBound()) {
+                if (!con.hasForwards()) {
+                    con.unbind();
+                    connections.remove(action);
+                } else {
+                    Log.d(TAG, "Not unbinding for " + connection + ": has pending other bindings on action " + action);
+                }
+            }
+        }
+    }
+
+    public class Connection {
+        private final String actionString;
+        private final boolean requireMicrog;
+        private final Set<ServiceConnection> connectionForwards = new HashSet<ServiceConnection>();
+        private boolean bound = false;
+        private boolean connected = false;
+        private IBinder binder;
+        private ComponentName component;
+        private ServiceConnection serviceConnection = new ServiceConnection() {
+            @Override
+            public void onServiceConnected(ComponentName componentName, IBinder iBinder) {
+                Log.d(TAG, "Connection(" + actionString + ") : ServiceConnection : " +
+                        "onServiceConnected(" + componentName + ")");
+                binder = iBinder;
+                component = componentName;
+                for (ServiceConnection connection : connectionForwards) {
+                    connection.onServiceConnected(componentName, iBinder);
+                }
+                connected = true;
+            }
+
+            @Override
+            public void onServiceDisconnected(ComponentName componentName) {
+                Log.d(TAG, "Connection(" + actionString + ") : ServiceConnection : " +
+                        "onServiceDisconnected(" + componentName + ")");
+                binder = null;
+                component = componentName;
+                for (ServiceConnection connection : connectionForwards) {
+                    connection.onServiceDisconnected(componentName);
+                }
+                connected = false;
+                bound = false;
+            }
+        };
+
+        public Connection(String actionString) {
+            this(actionString, false);
+        }
+
+        public Connection(String actionString, boolean requireMicrog) {
+            this.actionString = actionString;
+            this.requireMicrog = requireMicrog;
+        }
+
+        private Intent getIntent() {
+            Intent intent;
+            ResolveInfo resolveInfo;
+            PackageManager pm = context.getPackageManager();
+            if (!Objects.equals(targetPackage, context.getPackageName())) {
+                intent = new Intent(actionString).setPackage(targetPackage);
+                try {
+                    if ((resolveInfo = context.getPackageManager().resolveService(intent, 0)) != null) {
+                        if (requireMicrog && !isMicrog(resolveInfo)) {
+                            Log.w(TAG, "GMS service found for " + actionString + " but looks not like microG");
+                        } else {
+                            if (isSystemGoogleOrMicrogSig(pm, targetPackage)){
+                                Log.d(TAG, "GMS service found for " + actionString);
+                                return intent;
+                            } else {
+                                Log.w(TAG, "GMS service found for " + actionString + " but is not system, and doesn't have microG or Google signature");
+                            }
+                        }
+                    }
+                } catch (PackageManager.NameNotFoundException e) {
+                    Log.d(TAG, targetPackage + " not found");
+                }
+            }
+            intent = new Intent(actionString).setPackage(context.getPackageName());
+            if (context.getPackageManager().resolveService(intent, 0) != null) {
+                Log.d(TAG, "Found service for " + actionString + " in self package, using it instead");
+                return intent;
+            }
+            return null;
+        }
+
+        @SuppressLint("InlinedApi")
+        public void bind() {
+            Log.d(TAG, "Connection(" + actionString + ") : bind()");
+            Intent intent;
+            if ((intent = getIntent()) == null) {
+                Log.w(TAG, "No service found for " + actionString);
+                return;
+            }
+
+            int flags = Context.BIND_AUTO_CREATE | Context.BIND_DEBUG_UNBIND;
+            if (SDK_INT >= 14) {
+                flags |= Context.BIND_ADJUST_WITH_ACTIVITY;
+            }
+            bound = context.bindService(intent, serviceConnection, flags);
+            Log.d(TAG, "Connection(" + actionString + ") :  bind() : bindService=" + bound);
+            if (!bound) {
+                context.unbindService(serviceConnection);
+            }
+        }
+
+        public boolean isMicrog(ResolveInfo resolveInfo) {
+            if (resolveInfo == null || resolveInfo.serviceInfo == null) return false;
+            if (resolveInfo.serviceInfo.name.startsWith("org.microg.")) return true;
+            try {
+                PermissionInfo info = context.getPackageManager().getPermissionInfo("org.microg.gms.EXTENDED_ACCESS", 0);
+                return info.packageName.equals(resolveInfo.serviceInfo.packageName);
+            } catch (PackageManager.NameNotFoundException e) {
+                return false;
+            }
+        }
+
+        public boolean isBound() {
+            return bound;
+        }
+
+        public IBinder getBinder() {
+            return binder;
+        }
+
+        public void unbind() {
+            Log.d(TAG, "Connection(" + actionString + ") : unbind()");
+            try {
+                context.unbindService(serviceConnection);
+            } catch (IllegalArgumentException e) { // not bound (whatever reason)
+                Log.w(TAG, e);
+            }
+            bound = false;
+        }
+
+        public void addConnectionForward(ServiceConnection connection) {
+            connectionForwards.add(connection);
+            if (connected) {
+                connection.onServiceConnected(component, binder);
+            }
+        }
+
+        public void removeConnectionForward(ServiceConnection connection) {
+            connectionForwards.remove(connection);
+            if (connected) {
+                connection.onServiceDisconnected(component);
+            }
+        }
+
+        public boolean forwardsConnection(ServiceConnection connection) {
+            return connectionForwards.contains(connection);
+        }
+
+        public boolean hasForwards() {
+            return !connectionForwards.isEmpty();
+        }
+    }
+}
diff -Naur inputbak/play-services-basement/build.gradle input/play-services-basement/build.gradle
--- inputbak/play-services-basement/build.gradle	2026-01-01 18:27:34.133989921 +0300
+++ input/play-services-basement/build.gradle	2026-01-01 18:28:05.465989909 +0300
@@ -30,7 +30,12 @@
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
         buildConfigField "int", "VERSION_CODE", "$appVersionCode"
+        buildConfigField "String", "BASE_PACKAGE_NAME", "\"$basePackageName\""
         consumerProguardFile 'consumer-rules.pro'
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     compileOptions {
diff -Naur inputbak/play-services-basement/build.gradle.orig input/play-services-basement/build.gradle.orig
--- inputbak/play-services-basement/build.gradle.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-basement/build.gradle.orig	2026-01-01 18:28:05.465989909 +0300
@@ -0,0 +1,55 @@
+/*
+ * SPDX-FileCopyrightText: 2015 microG Project Team
+ * SPDX-License-Identifier: Apache-2.0
+ */
+
+apply plugin: 'com.android.library'
+apply plugin: 'maven-publish'
+apply plugin: 'signing'
+
+android {
+    namespace "com.google.android.gms.common"
+
+    compileSdkVersion androidCompileSdk
+    buildToolsVersion "$androidBuildVersionTools"
+
+    aidlPackagedList "com/google/android/gms/common/api/Status.aidl"
+    aidlPackagedList "com/google/android/gms/common/ConnectionResult.aidl"
+    aidlPackagedList "com/google/android/gms/common/internal/IAccountAccessor.aidl"
+    aidlPackagedList "com/google/android/gms/common/internal/ICancelToken.aidl"
+    aidlPackagedList "com/google/android/gms/common/server/FavaDiagnosticsEntity.aidl"
+    aidlPackagedList "com/google/android/gms/dynamic/IObjectWrapper.aidl"
+
+    buildFeatures {
+        aidl = true
+        buildConfig = true
+    }
+
+    defaultConfig {
+        versionName version
+        minSdkVersion androidMinSdk
+        targetSdkVersion androidTargetSdk
+        buildConfigField "int", "VERSION_CODE", "$appVersionCode"
+        consumerProguardFile 'consumer-rules.pro'
+    }
+
+    compileOptions {
+        sourceCompatibility = 1.8
+        targetCompatibility = 1.8
+    }
+}
+
+apply from: '../gradle/publish-android.gradle'
+
+description = 'microG implementation of play-services-basement'
+
+dependencies {
+    // Dependencies from play-services-basement:18.8.0
+    api 'androidx.collection:collection:1.0.0'
+    api 'androidx.core:core:1.2.0'
+    api 'androidx.fragment:fragment:1.1.0'
+    // TODO: Dependencies from play-services-stats:17.1.0
+    api 'androidx.legacy:legacy-support-core-utils:1.0.0'
+
+    annotationProcessor project(':safe-parcel-processor')
+}
diff -Naur inputbak/play-services-basement/src/main/AndroidManifest.xml input/play-services-basement/src/main/AndroidManifest.xml
--- inputbak/play-services-basement/src/main/AndroidManifest.xml	2026-01-01 18:27:34.133989921 +0300
+++ input/play-services-basement/src/main/AndroidManifest.xml	2026-01-01 18:28:05.465989909 +0300
@@ -7,7 +7,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android">
     <application>
         <meta-data
-                android:name="com.google.android.gms.version"
+                android:name="${basePackageName}.android.gms.version"
                 android:value="@integer/google_play_services_version"/>
     </application>
 </manifest>
diff -Naur inputbak/play-services-basement/src/main/java/org/microg/gms/auth/AuthConstants.java input/play-services-basement/src/main/java/org/microg/gms/auth/AuthConstants.java
--- inputbak/play-services-basement/src/main/java/org/microg/gms/auth/AuthConstants.java	2026-01-01 18:27:34.149989921 +0300
+++ input/play-services-basement/src/main/java/org/microg/gms/auth/AuthConstants.java	2026-01-01 18:28:05.465989909 +0300
@@ -16,6 +16,8 @@
 
 package org.microg.gms.auth;
 
+import com.google.android.gms.common.BuildConfig;
+
 public class AuthConstants {
     public static final String DEFAULT_ACCOUNT = "<<default account>>";
     public static final String SCOPE_GET_ACCOUNT_ID = "^^_account_id_^^";
@@ -23,7 +25,7 @@
     public static final String PROVIDER_METHOD_CLEAR_PASSWORD = "clear_password";
     public static final String PROVIDER_EXTRA_CLEAR_PASSWORD = "clear_password";
     public static final String PROVIDER_EXTRA_ACCOUNTS = "accounts";
-    public static final String DEFAULT_ACCOUNT_TYPE = "com.google";
+    public static final String DEFAULT_ACCOUNT_TYPE = BuildConfig.BASE_PACKAGE_NAME;
     public static final String WORK_ACCOUNT_TYPE = "com.google.work";
 
     public static final String KEY_ACCOUNT_SERVICES = "services";
diff -Naur inputbak/play-services-basement/src/main/java/org/microg/gms/common/Constants.java input/play-services-basement/src/main/java/org/microg/gms/common/Constants.java
--- inputbak/play-services-basement/src/main/java/org/microg/gms/common/Constants.java	2026-01-01 18:27:34.149989921 +0300
+++ input/play-services-basement/src/main/java/org/microg/gms/common/Constants.java	2026-01-01 18:28:05.469989909 +0300
@@ -20,7 +20,8 @@
 
 public class Constants {
     public static final int GMS_VERSION_CODE = (BuildConfig.VERSION_CODE / 1000) * 1000;
-    public static final String GMS_PACKAGE_NAME = "com.google.android.gms";
+    public static final String GOOGLE_SERVICES_PACKAGE_NAME = "com.google.android.gms";
+    public static final String GMS_PACKAGE_NAME = BuildConfig.BASE_PACKAGE_NAME + ".android.gms";
     public static final String USER_MICROG_PACKAGE_NAME = "org.microg.gms";
     public static final String GSF_PACKAGE_NAME = "com.google.android.gsf";
     public static final String GMS_PACKAGE_SIGNATURE_SHA1 = "38918a453d07199354f8b19af05ec6562ced5788";
diff -Naur inputbak/play-services-basement/src/main/java/org/microg/gms/common/GmsService.java input/play-services-basement/src/main/java/org/microg/gms/common/GmsService.java
--- inputbak/play-services-basement/src/main/java/org/microg/gms/common/GmsService.java	2026-01-01 18:27:34.149989921 +0300
+++ input/play-services-basement/src/main/java/org/microg/gms/common/GmsService.java	2026-01-01 18:41:44.101989596 +0300
@@ -16,107 +16,109 @@
 
 package org.microg.gms.common;
 
+import com.google.android.gms.common.BuildConfig;
+
 public enum GmsService {
     UNKNOWN(-2),
     ANY(-1),
-    GAMES(1, "com.google.android.gms.games.service.START", "com.google.android.gms.games.internal.connect.service.START"),
-    PLUS(2, "com.google.android.gms.plus.service.START", "com.google.android.gms.plus.service.internal.START"),
-    PANORAMA(3, "com.google.android.gms.panorama.service.START"),
-    WALLET(4, "com.google.android.gms.wallet.service.BIND"),
-    PEOPLE(5, "com.google.android.gms.people.service.START"),
+    GAMES(1, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.games.service.START", BuildConfig.BASE_PACKAGE_NAME + ".android.gms.games.internal.connect.service.START"),
+    PLUS(2, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.plus.service.START", BuildConfig.BASE_PACKAGE_NAME + ".android.gms.plus.service.internal.START"),
+    PANORAMA(3, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.panorama.service.START"),
+    WALLET(4, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.wallet.service.BIND"),
+    PEOPLE(5, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.people.service.START"),
     LOCATION(6),
-    APP_STATE(7, "com.google.android.gms.appstate.service.START"),
-    ADMOB(8, "com.google.android.gms.ads.service.START"),
-    ACCOUNT(9, "com.google.android.gms.accounts.ACCOUNT_SERVICE"),
-    CAST(10, "com.google.android.gms.cast.service.BIND_CAST_DEVICE_CONTROLLER_SERVICE"),
-    DRIVE(11, "com.google.android.gms.drive.ApiService.START"),
-    ADDRESS(12, "com.google.android.gms.identity.service.BIND"),
-    CAR(13, "com.google.android.gms.car.service.START"),
-    WEAR(14, "com.google.android.gms.wearable.BIND"),
-    AUTH_PROXY(16, "com.google.android.gms.auth.service.START"),
+    APP_STATE(7, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.appstate.service.START"),
+    ADMOB(8, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.service.START"),
+    ACCOUNT(9, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.accounts.ACCOUNT_SERVICE"),
+    CAST(10, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.cast.service.BIND_CAST_DEVICE_CONTROLLER_SERVICE"),
+    DRIVE(11, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.drive.ApiService.START"),
+    ADDRESS(12, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.identity.service.BIND"),
+    CAR(13, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.car.service.START"),
+    WEAR(14, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.wearable.BIND"),
+    AUTH_PROXY(16, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.service.START"),
     IDENTITY(15),
-    FITNESS(17, "com.google.android.gms.fitness.GoogleFitnessService.START"),
-    REMINDERS(18, "com.google.android.gms.reminders.service.START"),
-    LIGHT_INDEX(19, "com.google.android.gms.icing.LIGHTWEIGHT_INDEX_SERVICE"),
-    DEVICE_CONNECTIONS(20, "com.google.android.gms.deviceconnection.service.START"),
-    APP_DATA_SEARCH(21, "com.google.android.gms.icing.INDEX_SERVICE"),
-    REPORTING(22, "com.google.android.gms.location.reporting.service.START", "com.google.android.location.reporting.service.START"),
-    GOOGLE_LOCATION_MANAGER(23, "com.google.android.location.internal.GoogleLocationManagerService.START"),
-    PLAY_LOG(24, "com.google.android.gms.playlog.service.START"),
-    DROID_GUARD(25, "com.google.android.gms.droidguard.service.START"),
-    LOCKBOX(26, "com.google.android.gms.lockbox.service.START"),
-    CAST_MIRRORING(27, "com.google.android.gms.cast_mirroring.service.START"),
-    NETWORK_QUALITY(28, "com.google.android.gms.mdm.services.START"),
-    FEEDBACK(29, "com.google.android.gms.feedback.internal.IFeedbackService"),
+    FITNESS(17, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.GoogleFitnessService.START"),
+    REMINDERS(18, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.reminders.service.START"),
+    LIGHT_INDEX(19, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.icing.LIGHTWEIGHT_INDEX_SERVICE"),
+    DEVICE_CONNECTIONS(20, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.deviceconnection.service.START"),
+    APP_DATA_SEARCH(21, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.icing.INDEX_SERVICE"),
+    REPORTING(22, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.location.reporting.service.START", BuildConfig.BASE_PACKAGE_NAME + ".android.location.reporting.service.START"),
+    GOOGLE_LOCATION_MANAGER(23, BuildConfig.BASE_PACKAGE_NAME + ".android.location.internal.GoogleLocationManagerService.START"),
+    PLAY_LOG(24, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.playlog.service.START"),
+    DROID_GUARD(25, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.droidguard.service.START"),
+    LOCKBOX(26, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.lockbox.service.START"),
+    CAST_MIRRORING(27, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.cast_mirroring.service.START"),
+    NETWORK_QUALITY(28, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.mdm.services.START"),
+    FEEDBACK(29, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.feedback.internal.IFeedbackService"),
     SEARCH_ADMINISTRATION(30),
-    AUTO_BACKUP(31, "com.google.android.gms.photos.autobackup.service.START"),
+    AUTO_BACKUP(31, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.photos.autobackup.service.START"),
     SEARCH_QUERIES(32),
     GLOBAL_SEARCH_ADMIN(33),
     CLOUD_SAVE(34),
-    UDC(35, "com.google.android.gms.udc.service.START"),
+    UDC(35, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.udc.service.START"),
     SEARCH_CORPORA(36),
-    DEVICE_MANAGER(37, "com.google.android.gms.mdm.services.DeviceManagerApiService.START"),
-    PSEUDONYMOUS_ID(38, "com.google.android.gms.pseudonymous.service.START"),
-    COMMON(39, "com.google.android.gms.common.service.START"),
-    CLEARCUT_LOGGER(40, "com.google.android.gms.clearcut.service.START"),
-    USAGE_REPORTING(41, "com.google.android.gms.usagereporting.service.START"),
-    KIDS(42, "com.google.android.gms.kids.service.START"),
-    DOWNLOAD(43, "com.google.android.gms.common.download.START"),
-    SIGN_IN(44, "com.google.android.gms.signin.service.START"),
-    SAFETY_NET(45, "com.google.android.gms.safetynet.service.START"),
-    ADMOB_GSERVICES_VALUE(46, "com.google.android.gms.ads.gservice.START"),
-    CONTEXT_MANAGER(47, "com.google.android.contextmanager.service.ContextManagerService.START"),
-    AUDIO_MODEM(48, "com.google.android.gms.audiomodem.service.AudioModemService.START"),
-    NEARBY(49, "com.google.android.gms.nearby.sharing.service.NearbySharingService.START"),
-    LIGHTWEIGHT_NETWORK_QUALITY(50, "com.google.android.gms.herrevad.services.LightweightNetworkQualityAndroidService.START"),
-    PHENOTYPE(51, "com.google.android.gms.phenotype.service.START"),
-    VOICE_UNLOCK(52, "com.google.android.gms.speech.service.START"),
-
-    NEARBY_CONNECTIONS(54, "com.google.android.gms.nearby.connection.service.START"),
-    FIT_SENSORS(55, "com.google.android.gms.fitness.SensorsApi"),
-    FIT_RECORDING(56, "com.google.android.gms.fitness.RecordingApi"),
-    FIT_HISTORY(57, "com.google.android.gms.fitness.HistoryApi"),
-    FIT_SESSIONS(58, "com.google.android.gms.fitness.SessionsApi"),
-    FIT_BLE(59, "com.google.android.gms.fitness.BleApi"),
-    FIT_CONFIG(60, "com.google.android.gms.fitness.ConfigApi"),
-    FIT_INTERNAL(61, "com.google.android.gms.fitness.InternalApi"),
-    NEARBY_MESSAGES(62, "com.google.android.gms.nearby.messages.service.NearbyMessagesService.START"),
-    GOOGLE_HELP(63, "com.google.android.gms.googlehelp.service.GoogleHelpService.START"),
-    CHECKIN_CONFIG(64, "com.google.android.gms.config.START"),
-    PLACES_GEO_DATA(65, "com.google.android.gms.location.places.GeoDataApi"),
+    DEVICE_MANAGER(37, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.mdm.services.DeviceManagerApiService.START"),
+    PSEUDONYMOUS_ID(38, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.pseudonymous.service.START"),
+    COMMON(39, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.common.service.START"),
+    CLEARCUT_LOGGER(40, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.clearcut.service.START"),
+    USAGE_REPORTING(41, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.usagereporting.service.START"),
+    KIDS(42, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.kids.service.START"),
+    DOWNLOAD(43, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.common.download.START"),
+    SIGN_IN(44, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.signin.service.START"),
+    SAFETY_NET(45, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.safetynet.service.START"),
+    ADMOB_GSERVICES_VALUE(46, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.gservice.START"),
+    CONTEXT_MANAGER(47, BuildConfig.BASE_PACKAGE_NAME + ".android.contextmanager.service.ContextManagerService.START"),
+    AUDIO_MODEM(48, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.audiomodem.service.AudioModemService.START"),
+    NEARBY(49, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.sharing.service.NearbySharingService.START"),
+    LIGHTWEIGHT_NETWORK_QUALITY(50, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.herrevad.services.LightweightNetworkQualityAndroidService.START"),
+    PHENOTYPE(51, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.phenotype.service.START"),
+    VOICE_UNLOCK(52, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.speech.service.START"),
+
+    NEARBY_CONNECTIONS(54, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.connection.service.START"),
+    FIT_SENSORS(55, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.SensorsApi"),
+    FIT_RECORDING(56, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.RecordingApi"),
+    FIT_HISTORY(57, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.HistoryApi"),
+    FIT_SESSIONS(58, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.SessionsApi"),
+    FIT_BLE(59, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.BleApi"),
+    FIT_CONFIG(60, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.ConfigApi"),
+    FIT_INTERNAL(61, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fitness.InternalApi"),
+    NEARBY_MESSAGES(62, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.messages.service.NearbyMessagesService.START"),
+    GOOGLE_HELP(63, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.googlehelp.service.GoogleHelpService.START"),
+    CHECKIN_CONFIG(64, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.config.START"),
+    PLACES_GEO_DATA(65, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.location.places.GeoDataApi"),
     IME_UPDATES(66),
-    PLACES_PLACE_DETECTION(67, "com.google.android.gms.location.places.PlaceDetectionApi"),
-    AUTH_CREDENTIALS(68, "com.google.android.gms.auth.api.credentials.service.START"),
-    NEARBY_BOOTSTRAP(69, "com.google.android.gms.nearby.bootstrap.service.NearbyBootstrapService.START"),
+    PLACES_PLACE_DETECTION(67, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.location.places.PlaceDetectionApi"),
+    AUTH_CREDENTIALS(68, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.credentials.service.START"),
+    NEARBY_BOOTSTRAP(69, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.bootstrap.service.NearbyBootstrapService.START"),
     PLUS_INTERNAL(70),
     MAPS_API(71),
     TRUSTAGENT_TRUSTED_DEVICES(72),
     SEARCH_AUTH(73),
     ACCOUNT_STATUS(74),
-    SMARTDEVICE_D2D_SOURCE_DEVICE(75, "com.google.android.gms.smartdevice.d2d.SourceDeviceService.START"),
-    SMARTDEVICE_D2D_TARGET_DEVICE(76, "com.google.android.gms.smartdevice.d2d.TargetDeviceService.START"),
-    APP_INVITE(77, "com.google.android.gms.appinvite.service.START"),
+    SMARTDEVICE_D2D_SOURCE_DEVICE(75, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.smartdevice.d2d.SourceDeviceService.START"),
+    SMARTDEVICE_D2D_TARGET_DEVICE(76, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.smartdevice.d2d.TargetDeviceService.START"),
+    APP_INVITE(77, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.appinvite.service.START"),
     SEARCH_NATIVE_API(78),
-    WALLET_TAP_AND_PAY(79, "com.google.android.gms.tapandpay.service.BIND"),
-    CHROME_SYNC(80, "com.google.android.gms.chromesync.service.START"),
-    SMARTDEVICE_SETUP_ACCOUNTS_BOOTSTRAP(81, "com.google.android.gms.smartdevice.setup.accounts.AccountsService.START"),
+    WALLET_TAP_AND_PAY(79, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.tapandpay.service.BIND"),
+    CHROME_SYNC(80, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.chromesync.service.START"),
+    SMARTDEVICE_SETUP_ACCOUNTS_BOOTSTRAP(81, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.smartdevice.setup.accounts.AccountsService.START"),
     GSA(82),
-    CAST_REMOTE_DISPLAY(83, "com.google.android.gms.cast.remote_display.service.START"),
-    TRUSTAGENT(85, "com.google.android.gms.trustagent.StateApi.START"),
+    CAST_REMOTE_DISPLAY(83, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.cast.remote_display.service.START"),
+    TRUSTAGENT(85, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.trustagent.StateApi.START"),
     TRUSTAGENT_STATE(85),
     YOUTUBE(86),
     AUTH_SIGN_IN(87),
     VISION(88),
     TRUSTAGENT_BRIDGE(89),
     BACKUP_STATS(90),
-    AUTH_GOOGLE_SIGN_IN(91, "com.google.android.gms.auth.api.signin.service.START"),
+    AUTH_GOOGLE_SIGN_IN(91, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.signin.service.START"),
 
-    MEASUREMENT(93, "com.google.android.gms.measurement.START"),
+    MEASUREMENT(93, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.measurement.START"),
     WEAVE_DEVICE(94),
     AD_MEASUREMENT(95),
 
 
-    FREIGHTER(98, "com.google.android.gms.freighter.service.START"),
+    FREIGHTER(98, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.freighter.service.START"),
     WEAVE_MANAGEMENT(99),
     WEAVE_COMMAND(100),
     WEAVE_APP_ACCESS(101),
@@ -128,36 +130,36 @@
     AUTH_AUTHZEN_INTERNAL_DATA(107),
     AUTH_PROXIMITY(108),
     ACCOUNT_SETTINGS(109),
-    GUNS(110, "com.google.android.gms.notifications.service.START"),
-    BEACON(111, "com.google.android.gms.beacon.internal.IBleService.START"),
+    GUNS(110, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.notifications.service.START"),
+    BEACON(111, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.beacon.internal.IBleService.START"),
     FIREBASE_AUTH(112, "com.google.firebase.auth.api.gms.service.START"),
-    APP_INDEXING(113, "com.google.android.gms.icing.APP_INDEXING_SERVICE"),
+    APP_INDEXING(113, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.icing.APP_INDEXING_SERVICE"),
     WALLET_P2P(114),
     WALLET_P2P_INTERNAL(115),
-    GASS(116, "com.google.android.gms.gass.START"),
+    GASS(116, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gass.START"),
     U2F_API(117),
     U2F_PRIVILEGED_API(118),
     U2F_ZERO_PARTY_API(119),
-    WORK_ACCOUNT_API(120, "com.google.android.gms.auth.account.workaccount.START"),
-    INSTANT_APPS(121, "com.google.android.gms.instantapps.START"),
-    CAST_FIRST_PARTY(122, "com.google.android.gms.cast.firstparty.START"),
-    ADMOB_CACHE(123, "com.google.android.gms.ads.service.CACHE"),
-    BOOT_COUNT(124, "com.google.android.gms.clearcut.bootcount.service.START"),
+    WORK_ACCOUNT_API(120, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.account.workaccount.START"),
+    INSTANT_APPS(121, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.instantapps.START"),
+    CAST_FIRST_PARTY(122, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.cast.firstparty.START"),
+    ADMOB_CACHE(123, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.service.CACHE"),
+    BOOT_COUNT(124, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.clearcut.bootcount.service.START"),
     FIT_GOALS(125),
-    SMS_RETRIEVER(126, "com.google.android.gms.auth.api.phone.service.SmsRetrieverApiService.START"),
+    SMS_RETRIEVER(126, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.phone.service.SmsRetrieverApiService.START"),
     MOBILE_DATA_HUB(127),
     AUTH_ACCOUNT_TRANSFER(128),
-    CRYPTAUTH_API(129, "com.google.android.gms.auth.cryptauth.cryptauthservice.START"),
-    CHECKIN_API(130, "com.google.android.gms.checkin.START"),
+    CRYPTAUTH_API(129, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.cryptauth.cryptauthservice.START"),
+    CHECKIN_API(130, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.checkin.START"),
     DYNAMIC_LINKS_API(131, "com.google.firebase.dynamiclinks.service.START"),
-    FONT_API(132, "com.google.android.gms.fonts.service.START"),
+    FONT_API(132, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fonts.service.START"),
     TEST_SUPPORT(133),
     LOCATION_SHARING(134),
-    ROMANESCO(135, "com.google.android.gms.romanesco.service.START"),
+    ROMANESCO(135, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.romanesco.service.START"),
     AUTH_MANAGED_EMM_API(136),
     NETWORK_SCORER(137),
     NETWORK_RECOMMENDATION(138),
-    BRELLA(139, "com.google.android.gms.learning.trainer.START"),
+    BRELLA(139, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.learning.trainer.START"),
     RESTORE_SESSION(140),
     PEER_DOWNLOAD_MANAGER(141),
     AUTH_PROXIMITY_DEVICE_SYNC(142),
@@ -166,85 +168,85 @@
     PREDICT_ON_DEVICE(145),
     APP_PREVIEW_MESSAGING(146),
     LOCAL_RESTORE(147),
-    FIDO2_API(148, "com.google.android.gms.fido.fido2.regular.START"),
-    FIDO2_PRIVILEGED_API(149, "com.google.android.gms.fido.fido2.privileged.START"),
+    FIDO2_API(148, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fido.fido2.regular.START"),
+    FIDO2_PRIVILEGED_API(149, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fido.fido2.privileged.START"),
     TELEPHONY_SPAM(150),
     AUTH_UNCERTIFIED_DEVICE(151),
-    MOBILE_DATA_DOWNLOAD(152, "com.google.android.mdd.service.START"),
-    AUTH_ACCOUNT_DATA(153, "com.google.android.gms.auth.account.data.service.START"),
-    AUDIT(154, "com.google.android.gms.audit.service.START"),
-    CONSTELLATION(155, "com.google.android.gms.constellation.service.START"),
+    MOBILE_DATA_DOWNLOAD(152, BuildConfig.BASE_PACKAGE_NAME + ".android.mdd.service.START"),
+    AUTH_ACCOUNT_DATA(153, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.account.data.service.START"),
+    AUDIT(154, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.audit.service.START"),
+    CONSTELLATION(155, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.constellation.service.START"),
     GROWTH(156),
-    SYSTEM_UPDATE(157, "com.google.android.gms.update.START_API_SERVICE"),
+    SYSTEM_UPDATE(157, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.update.START_API_SERVICE"),
     MOBILE_DATA_PLAN(158),
     SMARTDEVICE_WIFI_HELPER(159),
-    MOBSTORE_FILE(160, "com.google.android.mobstore.service.START"),
+    MOBSTORE_FILE(160, BuildConfig.BASE_PACKAGE_NAME + ".android.mobstore.service.START"),
     CAST_API(161),
     CURATOR(162),
-    USER_LOCATION(163, "com.google.android.gms.userlocation.service.START"),
+    USER_LOCATION(163, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.userlocation.service.START"),
     MOBILE_DATA_HUB_LISTENER(164),
     EXAMPLE(165),
-    ADMOB_HTTP_CLIENT(166, "com.google.android.gms.ads.service.HTTP"),
-    LANGUAGE_PROFILE(167, "com.google.android.gms.languageprofile.service.START"),
-    MDNS(168, "com.google.android.gms.mdns.service.START"),
+    ADMOB_HTTP_CLIENT(166, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.service.HTTP"),
+    LANGUAGE_PROFILE(167, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.languageprofile.service.START"),
+    MDNS(168, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.mdns.service.START"),
     NEARBY_SETUP(169),
     ANALYTICS(170),
     SUBSCRIPTIONS(171),
-    FOLSOM(172, "com.google.android.gms.auth.key.retrieval.service.START"),
-    SEMANTIC_LOCATION(173, "com.google.android.gms.semanticlocation.service.START_ODLH"),
+    FOLSOM(172, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.key.retrieval.service.START"),
+    SEMANTIC_LOCATION(173, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.semanticlocation.service.START_ODLH"),
     VEHICLE(174),
     BACKUP_NOW(175),
     AUTH_EARLY_UPDATE(176),
     AUTOFILL(177),
     MATCHSTICK(178),
     AUTH_CREDENTIALS_INTERNAL(179),
-    FIDO2_ZERO_PARTY_API(180, "com.google.android.gms.fido.fido2.zeroparty.START"),
-    G1_RESTORE(181, "com.google.android.gms.backup.G1_RESTORE"),
-    G1_BACKUP(182, "com.google.android.gms.backup.G1_BACKUP"),
+    FIDO2_ZERO_PARTY_API(180, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fido.fido2.zeroparty.START"),
+    G1_RESTORE(181, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.backup.G1_RESTORE"),
+    G1_BACKUP(182, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.backup.G1_BACKUP"),
     CODELAB(183),
     DRIVING_MODE(184),
-    OSS_LICENSES_SERVICE(185, "com.google.android.gms.oss.licenses.service.START"),
+    OSS_LICENSES_SERVICE(185, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.oss.licenses.service.START"),
     CLEAR_CONTACT_INTERACTIONS_SERVICE(186),
     AUTH_MANAGED_POLICY_SERVICE(187),
-    PAY_SECURE_ELEMENT_SERVICE(188, "com.google.android.gms.payse.service.BIND"),
-    RCS(189, "com.google.android.gms.rcs.START"),
+    PAY_SECURE_ELEMENT_SERVICE(188, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.payse.service.BIND"),
+    RCS(189, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.rcs.START"),
     SMARTDEVICE_POST_SETUP(190),
-    CARRIER_AUTH(191, "com.google.android.gms.carrierauth.service.START"),
-    SYSTEM_UPDATE_SINGLE_UESR(192, "com.google.android.gms.update.START_SINGLE_USER_API_SERVICE"),
-    APPUSAGE(193, "com.google.android.gms.appusage.service.START"),
-    NEARBY_SHARING(194, "com.google.android.gms.nearby.sharing.START_SERVICE"),
-    ADMOB_CONSENT_SERVICE(195, "com.google.android.gms.ads.service.CONSENT_LOOKUP"),
-    CREDENTIAL_MANAGER(196, "com.google.android.gms.credential.manager.service.firstparty.START"),
-    SMS_RETRIEVER_INTERNAL(197, "com.google.android.gms.auth.api.phone.service.InternalService.START"),
-    PAY(198, "com.google.android.gms.pay.service.BIND", "com.google.android.gms.pay.service.THIRD_PARTY"),
-    ASTERISM(199, "com.google.android.gms.asterism.service.START"),
+    CARRIER_AUTH(191, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.carrierauth.service.START"),
+    SYSTEM_UPDATE_SINGLE_UESR(192, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.update.START_SINGLE_USER_API_SERVICE"),
+    APPUSAGE(193, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.appusage.service.START"),
+    NEARBY_SHARING(194, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.sharing.START_SERVICE"),
+    ADMOB_CONSENT_SERVICE(195, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.service.CONSENT_LOOKUP"),
+    CREDENTIAL_MANAGER(196, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.credential.manager.service.firstparty.START"),
+    SMS_RETRIEVER_INTERNAL(197, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.phone.service.InternalService.START"),
+    PAY(198, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.pay.service.BIND", BuildConfig.BASE_PACKAGE_NAME + ".android.gms.pay.service.THIRD_PARTY"),
+    ASTERISM(199, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.asterism.service.START"),
     MOBILE_SUBSCRIPTION(200),
-    GMS_RESTORE(201, "com.google.android.gms.backup.GMS_MODULE_RESTORE"),
-    FACS_CACHE(202, "com.google.android.gms.facs.cache.service.START"),
+    GMS_RESTORE(201, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.backup.GMS_MODULE_RESTORE"),
+    FACS_CACHE(202, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.facs.cache.service.START"),
     ADMOB_SDK_SIGNAL(203),
     PLATFORM_CONFIGURATOR(204),
-    RECAPTCHA(205, "com.google.android.gms.recaptcha.service.START"),
+    RECAPTCHA(205, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.recaptcha.service.START"),
     DUOKIT_SERVICE(206),
     SYSTEM_UPDATE_TV_API(207),
-    CONTACT_SYNC(208, "com.google.android.gms.people.contactssync.service.START"),
+    CONTACT_SYNC(208, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.people.contactssync.service.START"),
     FEEDBACK_CAR(209),
     SMARTDEVICE_SOURCE_DIRECT_TRANSFER(210),
     SMARTDEVICE_TARGET_DIRECT_TRANSFER(211),
-    AUTH_API_IDENTITY_SIGNIN(212, "com.google.android.gms.auth.api.identity.service.signin.START"),
+    AUTH_API_IDENTITY_SIGNIN(212, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.identity.service.signin.START"),
     IDENTITY_GIS_INTERNAL(213),
-    FIDO_CREDENTIAL_STORE(214, "com.google.android.gms.fido.credentialstore.internal_service.START"),
-    MDI_SYNC(215, "com.google.android.gms.mdisync.service.START"),
-    EVENT_ATTESTATION(216, "com.google.android.gms.ads.identifier.service.EVENT_ATTESTATION"),
+    FIDO_CREDENTIAL_STORE(214, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fido.credentialstore.internal_service.START"),
+    MDI_SYNC(215, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.mdisync.service.START"),
+    EVENT_ATTESTATION(216, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.identifier.service.EVENT_ATTESTATION"),
     GCONNECT_EXP(217),
-    SCHEDULER(218, "com.google.android.gms.scheduler.ACTION_PROXY_SCHEDULE"),
-    AUTH_API_IDENTITY_AUTHORIZATION(219, "com.google.android.gms.auth.api.identity.service.authorization.START"),
-    FACS_INTERNAL_SYNC(220, "com.google.android.gms.facs.internal.service.START"),
-    AUTH_CONFIG_SYNC(221, "com.google.android.gms.auth.config.service.START"),
+    SCHEDULER(218, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.scheduler.ACTION_PROXY_SCHEDULE"),
+    AUTH_API_IDENTITY_AUTHORIZATION(219, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.identity.service.authorization.START"),
+    FACS_INTERNAL_SYNC(220, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.facs.internal.service.START"),
+    AUTH_CONFIG_SYNC(221, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.config.service.START"),
     ENTERPRISE(222),
-    AUTH_API_IDENTITY_CREDENTIAL_SAVING(223, "com.google.android.gms.auth.api.identity.service.credentialsaving.START"),
-    GOOGLE_AUTH(224, "com.google.android.gms.auth.account.authapi.START"),
-    ENTERPRISE_LOADER(225, "com.google.android.gms.enterprise.loader.service.START"),
-    THUNDERBIRD(226, "com.google.android.gms.thunderbird.service.START"),
+    AUTH_API_IDENTITY_CREDENTIAL_SAVING(223, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.api.identity.service.credentialsaving.START"),
+    GOOGLE_AUTH(224, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.account.authapi.START"),
+    ENTERPRISE_LOADER(225, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.enterprise.loader.service.START"),
+    THUNDERBIRD(226, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.thunderbird.service.START"),
 
 
     BACKUP(229),
@@ -254,7 +256,7 @@
     CHIMERA_COMPONENTS_TEST(233),
     AUTH_EASYUNLOCK(234),
     COMMON_ACCOUNT(235),
-    NEARBY_EXPOSURE_NOTIFICATION(236, "com.google.android.gms.nearby.exposurenotification.START"),
+    NEARBY_EXPOSURE_NOTIFICATION(236, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.exposurenotification.START"),
     CONTACT_INTERACTIONS(237),
     PERMISSION(238),
     PSEUDONYMOUS(239),
@@ -275,39 +277,39 @@
     STATS(254),
     PLATFORM_DATA_INDEXER(255),
     CONTAINER(256),
-    GMS_COMPLIANCE(257, "com.google.android.gms.gmscompliance.service.START"),
-    AUTH_BLOCKSTORE(258, "com.google.android.gms.auth.blockstore.service.START"),
+    GMS_COMPLIANCE(257, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gmscompliance.service.START"),
+    AUTH_BLOCKSTORE(258, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.blockstore.service.START"),
     COMMON_BASE(259),
     GROWTH_UPGRADEPARTY(260),
     ADSIDENTITY(261),
-    FIDO_SOURCE_DIRECT_TRANSFER(262, "com.google.android.gms.fido.sourcedevice.service.START"),
+    FIDO_SOURCE_DIRECT_TRANSFER(262, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fido.sourcedevice.service.START"),
     STREAM_PROTECT(263),
     CHIMERA(264),
-    NEARBY_FAST_PAIR(265, "com.google.android.gms.nearby.fastpair.START"),
+    NEARBY_FAST_PAIR(265, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.nearby.fastpair.START"),
 
     COMMON_API(267),
-    LIGHTER_MESSAGING(268, "com.google.android.gms.matchstick.lighter.service.START"),
-    FIDO_TARGET_DIRECT_TRANSFER(269, "com.google.android.gms.fido.targetdevice.internal_service.START"),
-    CLIENT_TELEMETRY(270, "com.google.android.gms.common.telemetry.service.START"),
+    LIGHTER_MESSAGING(268, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.matchstick.lighter.service.START"),
+    FIDO_TARGET_DIRECT_TRANSFER(269, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.fido.targetdevice.internal_service.START"),
+    CLIENT_TELEMETRY(270, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.common.telemetry.service.START"),
 
 
     FIDO_CLIENT_UI(273),
     FIDO_SHARED_LIBRARY(274),
-    SMARTDEVICE_SECOND_DEVICE_AUTH(275, "com.google.android.gms.setup.auth.SecondDeviceAuth.START"),
+    SMARTDEVICE_SECOND_DEVICE_AUTH(275, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.setup.auth.SecondDeviceAuth.START"),
     AUTH_MAGICTETHER(276),
-    LOCATION_SHARING_REPORTER(277, "com.google.android.gms.locationsharingreporter.service.START"),
+    LOCATION_SHARING_REPORTER(277, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.locationsharingreporter.service.START"),
 
-    WALLET_OCR(279, "com.google.android.gms.ocr.service.START"),
+    WALLET_OCR(279, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ocr.service.START"),
     ALL(280),
-    WALLET_OCR_INTERNAL(281, "com.google.android.gms.ocr.service.internal.START"),
+    WALLET_OCR_INTERNAL(281, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ocr.service.internal.START"),
     GSERVICES_API(282),
     FIND_MY_DEVICE(283),
     FIND_MY_DEVICE_SPOT(284),
-    PO_TOKENS(285, "com.google.android.gms.potokens.service.START"),
+    PO_TOKENS(285, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.potokens.service.START"),
     EXPOSURE_NOTIFICATION_PROMOS(286),
     FIDO_AUTHENTICATOR_SERVICE(287),
     CONNECTED_HOME(288),
-    DIGITAL_CAR_KEYS(289, "com.google.android.gms.dck.service.START"),
+    DIGITAL_CAR_KEYS(289, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.dck.service.START"),
 
 
     COMMUNAL(292),
@@ -318,28 +320,28 @@
     GEO_TIME_ZONE(297),
     NEARBY_UWB(298),
     GMSCORE_LOGGER(299),
-    APP_SET_ID(300, "com.google.android.gms.appset.service.START"),
+    APP_SET_ID(300, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.appset.service.START"),
     NNAPI_DRIVER_MANAGER(301),
     CRED_SYNC(302),
     CHROME_SYNC_FIRST_PARTY(303),
     USONIA(304),
-    THREADNETWORK(305, "com.google.android.gms.threadnetwork.service.START"),
+    THREADNETWORK(305, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.threadnetwork.service.START"),
     CODELAB_SEPARATE(306),
     TRUSTAGENT_AUTHENTICATORS(307),
-    MODULE_INSTALL(308, "com.google.android.gms.chimera.container.moduleinstall.ModuleInstallService.START"),
+    MODULE_INSTALL(308, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.chimera.container.moduleinstall.ModuleInstallService.START"),
     CHIMERA_BROTLI_STREAM(309),
     PERSONALSAFETY(310),
     GAME_PLATFORM(311),
     DTDI(312),
     GROWTH_UIFLOW(313),
-    SEMANTIC_LOCATION_HISTORY(314, "com.google.android.gms.semanticlocationhistory.service.START", "com.google.android.gms.semanticlocationhistory.zeroparty.service.START"),
-    INAPP_REACH(315, "com.google.android.gms.inappreach.service.START"),
+    SEMANTIC_LOCATION_HISTORY(314, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.semanticlocationhistory.service.START", BuildConfig.BASE_PACKAGE_NAME + ".android.gms.semanticlocationhistory.zeroparty.service.START"),
+    INAPP_REACH(315, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.inappreach.service.START"),
     DEVICE_ACCOUNT(316),
     NEARBY_PRESENCE(317),
     ENTERPRISE_LOST_MODE(318),
     HOMEGRAPH(319),
     AUTH_MANAGED_WORK_PROFILE(320),
-    MDOC_STORE(321, "com.google.android.gms.mdocstore.service.MDOC_STORE"),
+    MDOC_STORE(321, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.mdocstore.service.MDOC_STORE"),
     DEVICE_PERFORMANCE(322),
 
 
@@ -352,7 +354,7 @@
     SEALEDCOMPUTING(331),
     APPSEARCH(332),
     ESIM(333),
-    APP_ERROR(334, "com.google.android.gms.apperrors.service.START_APP_ERROR"),
+    APP_ERROR(334, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.apperrors.service.START_APP_ERROR"),
     ADID(335),
 
     HOME(336),
@@ -361,7 +363,7 @@
     MLBENCHMARK_INSTALLER(340),
     FACTORY_RESET_PROTECTION(341),
     NOTIFICATIONS(342),
-    GOOGLE_AUTH_AANG(343, "com.google.android.gms.auth.aang.events.services.START"),
+    GOOGLE_AUTH_AANG(343, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.auth.aang.events.services.START"),
 
     ANTIFINGERPRINTING(345),
     CALLSTREAMING(346),
@@ -403,9 +405,9 @@
     CONTACTKEYS(382),
     HEALTH_CONNECT_BACKUPS(383),
     SETUP_SERVICES_TOS_ACCEPTANCE(384),
-    LOCATION_NETWORK(385, "com.google.android.gms.location.network.service.START"),
+    LOCATION_NETWORK(385, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.location.network.service.START"),
     SPATULA_SETTINGS(386),
-    NOTIFICATIONS_CAPPING(387, "com.google.android.gms.notifications.capping.api.NotificationsCappingApiService.START"),
+    NOTIFICATIONS_CAPPING(387, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.notifications.capping.api.NotificationsCappingApiService.START"),
     CAMERA_FEATURE_COMBINATION_QUERY(388),
     AUTOMOTIVE_SETUP_SERVICES_INTERNAL(389),
     CRISISALERTS(390),
@@ -432,7 +434,7 @@
     MISSED_CALL_RETRIEVER(411),
     HEALTH_TRACKING(412),
     FAMILY_CONTEXTUAL_CARD(413),
-    CLEARCUT_LOGGER_SAMPLING(414, "com.google.android.gms.clearcut.sampler.service.START"),
+    CLEARCUT_LOGGER_SAMPLING(414, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.clearcut.sampler.service.START"),
     TRACING(415),
     DEPENDENCY_INSTALLER(416),
     ADVANCED_PROTECTION(417),
@@ -466,7 +468,7 @@
     CLEARCUT_LOG_MANAGER(445),
 
     NATIVE_HOTLOADER(447),
-    TELEMETRY_NOTIFICATION(449, "com.google.android.gms.common.telemetry.notification.service.START"),
+    TELEMETRY_NOTIFICATION(449, BuildConfig.BASE_PACKAGE_NAME + ".android.gms.common.telemetry.notification.service.START"),
     ;
 
     public int SERVICE_ID;
@@ -481,7 +483,7 @@
 
     public interface ADVERTISING_ID {
         // Has no service id
-        String ACTION = "com.google.android.gms.ads.identifier.service.START";
+        String ACTION = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.ads.identifier.service.START";
     }
 
     public static GmsService byServiceId(int serviceId) {
diff -Naur inputbak/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java input/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java
--- inputbak/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java	2026-01-01 18:27:34.149989921 +0300
+++ input/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java	2026-01-01 18:28:05.473989909 +0300
@@ -16,18 +16,20 @@
 
 package org.microg.gms.gcm;
 
+import com.google.android.gms.common.BuildConfig;
+
 public final class GcmConstants {
-    public static final String ACTION_C2DM_RECEIVE = "com.google.android.c2dm.intent.RECEIVE";
-    public static final String ACTION_C2DM_REGISTER = "com.google.android.c2dm.intent.REGISTER";
-    public static final String ACTION_C2DM_REGISTRATION = "com.google.android.c2dm.intent.REGISTRATION";
-    public static final String ACTION_C2DM_UNREGISTER = "com.google.android.c2dm.intent.UNREGISTER";
-    public static final String ACTION_GCM_SEND = "com.google.android.gcm.intent.SEND";
-    public static final String ACTION_NOTIFICATION_OPEN = "com.google.android.gms.gcm.NOTIFICATION_OPEN";
-    public static final String ACTION_NOTIFICATION_DISMISS = "com.google.android.gms.gcm.NOTIFICATION_DISMISS";
-    public static final String ACTION_SCHEDULE = "com.google.android.gms.gcm.ACTION_SCHEDULE";
-    public static final String ACTION_TASK_READY = "com.google.android.gms.gcm.ACTION_TASK_READY";
-    public static final String ACTION_TASK_INITIALZE = "com.google.android.gms.gcm.SERVICE_ACTION_INITIALIZE";
-    public static final String ACTION_INSTANCE_ID = "com.google.android.gms.iid.InstanceID";
+    public static final String ACTION_C2DM_RECEIVE = BuildConfig.BASE_PACKAGE_NAME + ".android.c2dm.intent.RECEIVE";
+    public static final String ACTION_C2DM_REGISTER = BuildConfig.BASE_PACKAGE_NAME + ".android.c2dm.intent.REGISTER";
+    public static final String ACTION_C2DM_REGISTRATION = BuildConfig.BASE_PACKAGE_NAME + ".android.c2dm.intent.REGISTRATION";
+    public static final String ACTION_C2DM_UNREGISTER = BuildConfig.BASE_PACKAGE_NAME + ".android.c2dm.intent.UNREGISTER";
+    public static final String ACTION_GCM_SEND = BuildConfig.BASE_PACKAGE_NAME + ".android.gcm.intent.SEND";
+    public static final String ACTION_NOTIFICATION_OPEN = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gcm.NOTIFICATION_OPEN";
+    public static final String ACTION_NOTIFICATION_DISMISS = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gcm.NOTIFICATION_DISMISS";
+    public static final String ACTION_SCHEDULE = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gcm.ACTION_SCHEDULE";
+    public static final String ACTION_TASK_READY = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gcm.ACTION_TASK_READY";
+    public static final String ACTION_TASK_INITIALZE = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gcm.SERVICE_ACTION_INITIALIZE";
+    public static final String ACTION_INSTANCE_ID = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.iid.InstanceID";
 
     public static final String EXTRA_APP = "app";
     public static final String EXTRA_APP_OVERRIDE = "org.microg.gms.gcm.APP_OVERRIDE";
@@ -49,7 +51,7 @@
     public static final String EXTRA_MESSAGE_TYPE = "message_type";
     public static final String EXTRA_MESSAGE_ID = "google.message_id";
     public static final String EXTRA_OS_VERSION = "osv";
-    public static final String EXTRA_PENDING_INTENT = "com.google.android.gms.gcm.PENDING_INTENT";
+    public static final String EXTRA_PENDING_INTENT = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.gcm.PENDING_INTENT";
     public static final String EXTRA_PUBLIC_KEY = "pub2";
     public static final String EXTRA_RAWDATA = "rawData";
     public static final String EXTRA_RAWDATA_BASE64 = "gcm.rawData64";
@@ -85,10 +87,10 @@
     public static final String SCHEDULER_ACTION_CANCEL_ALL = "CANCEL_ALL";
     public static final String SCHEDULER_ACTION_SCHEDULE = "SCHEDULE_TASK";
 
-    public static final String PERMISSION_GTALK = "com.google.android.gtalkservice.permission.GTALK_SERVICE";
-    public static final String PERMISSION_NETWORK_TASK = "com.google.android.gms.permission.BIND_NETWORK_TASK_SERVICE";
-    public static final String PERMISSION_RECEIVE = "com.google.android.c2dm.permission.RECEIVE";
-    public static final String PERMISSION_SEND = "com.google.android.c2dm.permission.SEND";
+    public static final String PERMISSION_GTALK = BuildConfig.BASE_PACKAGE_NAME + ".android.gtalkservice.permission.GTALK_SERVICE";
+    public static final String PERMISSION_NETWORK_TASK = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.permission.BIND_NETWORK_TASK_SERVICE";
+    public static final String PERMISSION_RECEIVE = BuildConfig.BASE_PACKAGE_NAME + ".android.c2dm.permission.RECEIVE";
+    public static final String PERMISSION_SEND = BuildConfig.BASE_PACKAGE_NAME + ".android.c2dm.permission.SEND";
 
     public static final String ERROR_SERVICE_NOT_AVAILABLE = "SERVICE_NOT_AVAILABLE";
 
diff -Naur inputbak/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java.orig input/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java.orig
--- inputbak/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-basement/src/main/java/org/microg/gms/gcm/GcmConstants.java.orig	2026-01-01 18:28:05.473989909 +0300
@@ -0,0 +1,101 @@
+/*
+ * Copyright (C) 2013-2017 microG Project Team
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.microg.gms.gcm;
+
+public final class GcmConstants {
+    public static final String ACTION_C2DM_RECEIVE = "com.google.android.c2dm.intent.RECEIVE";
+    public static final String ACTION_C2DM_REGISTER = "com.google.android.c2dm.intent.REGISTER";
+    public static final String ACTION_C2DM_REGISTRATION = "com.google.android.c2dm.intent.REGISTRATION";
+    public static final String ACTION_C2DM_UNREGISTER = "com.google.android.c2dm.intent.UNREGISTER";
+    public static final String ACTION_GCM_SEND = "com.google.android.gcm.intent.SEND";
+    public static final String ACTION_NOTIFICATION_OPEN = "com.google.android.gms.gcm.NOTIFICATION_OPEN";
+    public static final String ACTION_NOTIFICATION_DISMISS = "com.google.android.gms.gcm.NOTIFICATION_DISMISS";
+    public static final String ACTION_SCHEDULE = "com.google.android.gms.gcm.ACTION_SCHEDULE";
+    public static final String ACTION_TASK_READY = "com.google.android.gms.gcm.ACTION_TASK_READY";
+    public static final String ACTION_TASK_INITIALZE = "com.google.android.gms.gcm.SERVICE_ACTION_INITIALIZE";
+    public static final String ACTION_INSTANCE_ID = "com.google.android.gms.iid.InstanceID";
+
+    public static final String EXTRA_APP = "app";
+    public static final String EXTRA_APP_OVERRIDE = "org.microg.gms.gcm.APP_OVERRIDE";
+    public static final String EXTRA_APP_ID = "appid";
+    public static final String EXTRA_APP_VERSION_CODE = "app_ver";
+    public static final String EXTRA_APP_VERSION_NAME = "app_ver_name";
+    public static final String EXTRA_CLIENT_VERSION = "cliv";
+    public static final String EXTRA_COMPONENT = "component";
+    public static final String EXTRA_COLLAPSE_KEY = "collapse_key";
+    public static final String EXTRA_DELAY = "google.delay";
+    public static final String EXTRA_DELETE = "delete";
+    public static final String EXTRA_ERROR = "error";
+    public static final String EXTRA_FROM = "from";
+    public static final String EXTRA_GSF_INTENT = "GSF";
+    public static final String EXTRA_GMS_VERSION = "gmsv";
+    public static final String EXTRA_IS_MESSENGER2 = "messenger2";
+    public static final String EXTRA_KID = "kid";
+    public static final String EXTRA_MESSENGER = "google.messenger";
+    public static final String EXTRA_MESSAGE_TYPE = "message_type";
+    public static final String EXTRA_MESSAGE_ID = "google.message_id";
+    public static final String EXTRA_OS_VERSION = "osv";
+    public static final String EXTRA_PENDING_INTENT = "com.google.android.gms.gcm.PENDING_INTENT";
+    public static final String EXTRA_PUBLIC_KEY = "pub2";
+    public static final String EXTRA_RAWDATA = "rawData";
+    public static final String EXTRA_RAWDATA_BASE64 = "gcm.rawData64";
+    public static final String EXTRA_REGISTRATION_ID = "registration_id";
+    public static final String EXTRA_RETRY_AFTER = "Retry-After";
+    public static final String EXTRA_SCHEDULER_ACTION = "scheduler_action";
+    public static final String EXTRA_SCOPE = "scope";
+    public static final String EXTRA_SENDER = "sender";
+    public static final String EXTRA_SENDER_LEGACY = "legacy.sender";
+    public static final String EXTRA_SEND_TO = "google.to";
+    public static final String EXTRA_SEND_FROM = "google.from";
+    public static final String EXTRA_SENT_TIME = "google.sent_time";
+    public static final String EXTRA_SIGNATURE = "sig";
+    public static final String EXTRA_SUBSCIPTION = "subscription";
+    public static final String EXTRA_SUBTYPE = "subtype";
+    public static final String EXTRA_USE_GSF = "useGsf";
+    public static final String EXTRA_TAG = "tag";
+    public static final String EXTRA_TOPIC = "gcm.topic";
+    public static final String EXTRA_TTL = "google.ttl";
+    public static final String EXTRA_UNREGISTERED = "unregistered";
+    public static final String EXTRA_ACCOUNT_NAME = "a";
+    public static final String EXTRA_REG_ID = "id";
+    public static final String EXTRA_AUTHS_TOKEN = "t";
+    public static final String EXTRA_GCM_BODY = "gcmb";
+    public static final String EXTRA_GMS_GNOTS_PAYLOAD = "gms.gnots.payload";
+
+    public static final String MESSAGE_TYPE_GCM = "gcm";
+    public static final String MESSAGE_TYPE_DELETED_MESSAGE = "deleted_message";
+    public static final String MESSAGE_TYPE_SEND_ERROR = "send_error";
+    public static final String MESSAGE_TYPE_SEND_EVENT = "send_event";
+
+    public static final String SCHEDULER_ACTION_CANCEL = "CANCEL_TASK";
+    public static final String SCHEDULER_ACTION_CANCEL_ALL = "CANCEL_ALL";
+    public static final String SCHEDULER_ACTION_SCHEDULE = "SCHEDULE_TASK";
+
+    public static final String PERMISSION_GTALK = "com.google.android.gtalkservice.permission.GTALK_SERVICE";
+    public static final String PERMISSION_NETWORK_TASK = "com.google.android.gms.permission.BIND_NETWORK_TASK_SERVICE";
+    public static final String PERMISSION_RECEIVE = "com.google.android.c2dm.permission.RECEIVE";
+    public static final String PERMISSION_SEND = "com.google.android.c2dm.permission.SEND";
+
+    public static final String ERROR_SERVICE_NOT_AVAILABLE = "SERVICE_NOT_AVAILABLE";
+
+    public static final String ERROR_INVALID_FID = "Invalid argument for the given fid";
+
+    public static final String INSTANCE_ID_SCOPE_GCM = "GCM";
+
+    public static final String GCMID_INSTANCE_ID = "google.com/iid";
+    public static final String GCMID_REFRESH = "gcm.googleapis.com/refresh";
+}
diff -Naur inputbak/play-services-cast/core/build.gradle input/play-services-cast/core/build.gradle
--- inputbak/play-services-cast/core/build.gradle	2026-01-01 18:27:34.165989921 +0300
+++ input/play-services-cast/core/build.gradle	2026-01-01 18:28:05.473989909 +0300
@@ -32,6 +32,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     buildFeatures {
diff -Naur inputbak/play-services-cast/core/src/main/AndroidManifest.xml input/play-services-cast/core/src/main/AndroidManifest.xml
--- inputbak/play-services-cast/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.165989921 +0300
+++ input/play-services-cast/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.477989909 +0300
@@ -15,7 +15,7 @@
 
         <service android:name="org.microg.gms.cast.CastDeviceControllerService">
             <intent-filter>
-                <action android:name="com.google.android.gms.cast.service.BIND_CAST_DEVICE_CONTROLLER_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.cast.service.BIND_CAST_DEVICE_CONTROLLER_SERVICE" />
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/play-services-cast-framework/src/main/AndroidManifest.xml input/play-services-cast-framework/src/main/AndroidManifest.xml
--- inputbak/play-services-cast-framework/src/main/AndroidManifest.xml	2026-01-01 18:27:34.153989921 +0300
+++ input/play-services-cast-framework/src/main/AndroidManifest.xml	2026-01-01 18:28:05.477989909 +0300
@@ -9,21 +9,21 @@
     <uses-permission android:name="android.permission.FOREGROUND_SERVICE"/>
 
     <queries>
-        <package android:name="com.google.android.gms.policy_cast_dynamite"/>
+        <package android:name="${basePackageName}.android.gms.policy_cast_dynamite"/>
     </queries>
 
     <application>
         <receiver
-                android:name="com.google.android.gms.cast.framework.media.MediaIntentReceiver"
+                android:name="${basePackageName}.android.gms.cast.framework.media.MediaIntentReceiver"
                 android:exported="false"/>
 
         <service
-                android:name="com.google.android.gms.cast.framework.media.MediaNotificationService"
+                android:name="${basePackageName}.android.gms.cast.framework.media.MediaNotificationService"
                 android:exported="false"
                 android:foregroundServiceType="mediaPlayback"/>
 
         <service
-                android:name="com.google.android.gms.cast.framework.ReconnectionService"
+                android:name="${basePackageName}.android.gms.cast.framework.ReconnectionService"
                 android:exported="false"/>
     </application>
 
diff -Naur inputbak/play-services-core/build.gradle input/play-services-core/build.gradle
--- inputbak/play-services-core/build.gradle	2026-01-01 18:27:34.249989921 +0300
+++ input/play-services-core/build.gradle	2026-01-01 18:28:05.477989909 +0300
@@ -117,6 +117,8 @@
     }
 
     defaultConfig {
+        applicationId "${basePackageName}.android.gms"
+
         versionName version
         versionCode appVersionCode
 
@@ -126,7 +128,6 @@
         multiDexEnabled true
         multiDexKeepProguard file('multidex-keep.pro')
 
-        manifestPlaceholders = [appLabel:"@string/gms_app_name"]
         resValue "string", "package_id", "com.google.android.gms"
 
         buildConfigField "String", "SAFETYNET_KEY", "\"${localProperties.get("safetynet.key", "")}\""
@@ -135,6 +136,19 @@
         buildConfigField "String", "RECAPTCHA_ENTERPRISE_PROJECT_ID", "\"${localProperties.get("recaptchaEnterpreise.projectId", "")}\""
         buildConfigField "String", "RECAPTCHA_ENTERPRISE_SITE_KEY", "\"${localProperties.get("recaptchaEnterpreise.siteKey", "")}\""
         buildConfigField "String", "RECAPTCHA_ENTERPRISE_API_KEY", "\"${localProperties.get("recaptchaEnterpreise.apiKey", "")}\""
+        buildConfigField "String", "BASE_PACKAGE_NAME", "\"$basePackageName\""
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName",
+		appLabel: "@string/gms_app_name"
+        ]
+
+        resValue "string", "base_package_name", "$basePackageName"
+        resValue "string", "application_id", "$applicationId"
+        resValue "string", "var_pref_auth_action_security_settings", "${basePackageName}.android.gms.accountsettings.SECURITY_SETTINGS"
+        resValue "string", "var_pref_auth_action_privacy_settings", "${basePackageName}.android.gms.accountsettings.PRIVACY_SETTINGS"
+        resValue "string", "var_pref_auth_action_preferences_settings", "${basePackageName}.android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS"
+        resValue "string", "var_pref_start_gms_package", "${basePackageName}.android.gms"
 
         ndk {
             abiFilters "armeabi-v7a", "arm64-v8a", "x86", "x86_64"
diff -Naur inputbak/play-services-core/build.gradle.orig input/play-services-core/build.gradle.orig
--- inputbak/play-services-core/build.gradle.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-core/build.gradle.orig	2026-01-01 18:28:05.481989909 +0300
@@ -0,0 +1,224 @@
+/*
+ * SPDX-FileCopyrightText: 2013 microG Project Team
+ * SPDX-License-Identifier: Apache-2.0
+ */
+
+apply plugin: 'com.android.application'
+apply plugin: 'kotlin-android'
+
+configurations {
+    mapboxRuntimeOnly
+    vtmRuntimeOnly
+    if (hasModule("hms", true)) hmsRuntimeOnly
+    defaultRuntimeOnly
+}
+
+dependencies {
+    implementation "com.squareup.wire:wire-runtime:$wireVersion"
+    implementation "de.hdodenhof:circleimageview:1.3.0"
+
+    implementation project(':fake-signature')
+    implementation project(':firebase-dynamic-links')
+    implementation project(':firebase-auth-core')
+    implementation project(':play-services-ads-core')
+    implementation project(':play-services-ads-identifier-core')
+    implementation project(':play-services-ads-lite-core')
+    implementation project(':play-services-appinvite-core')
+    implementation project(':play-services-appset-core')
+    implementation project(':play-services-auth-api-phone-core')
+    implementation project(':play-services-auth-blockstore-core')
+    implementation project(':play-services-auth-workaccount-core')
+    implementation project(':play-services-base-core')
+    implementation project(':play-services-cast-core')
+    implementation project(':play-services-cast-framework-core')
+    implementation project(':play-services-conscrypt-provider-core')
+    implementation project(':play-services-cronet-core')
+    implementation project(':play-services-droidguard-core')
+    implementation project(':play-services-fido-core')
+    implementation project(':play-services-fitness-core')
+    implementation project(':play-services-gmscompliance-core')
+    implementation project(':play-services-location-core')
+    implementation project(':play-services-location-core-base')
+    implementation project(':play-services-oss-licenses-core')
+    implementation project(':play-services-panorama-core')
+    implementation project(':play-services-pay-core')
+    implementation project(':play-services-recaptcha-core')
+    implementation project(':play-services-safetynet-core')
+    implementation project(':play-services-tapandpay-core')
+    implementation project(':play-services-threadnetwork-core')
+    implementation project(':play-services-vision-core')
+    implementation project(':play-services-wearable-core')
+
+    implementation project(':play-services-core-proto')
+
+    implementation project(':play-services-core:microg-ui-tools') // deprecated
+    implementation project(':play-services-base-core-package')
+    implementation project(':play-services-api')
+
+    implementation project(':play-services-appinvite')
+    implementation project(':play-services-auth-base')
+    implementation project(':play-services-auth')
+    implementation project(':play-services-clearcut')
+    implementation project(':play-services-drive')
+    implementation project(':play-services-games')
+    implementation project(':play-services-maps')
+    implementation project(':play-services-measurement-base')
+    implementation project(':play-services-places')
+    implementation project(':play-services-recaptcha')
+    implementation project(':play-services-safetynet')
+    implementation project(':play-services-tasks-ktx')
+    implementation project(':play-services-fitness')
+
+    mapboxRuntimeOnly project(':play-services-maps-core-mapbox')
+    vtmRuntimeOnly project(':play-services-maps-core-vtm')
+    defaultRuntimeOnly project(':play-services-location-core-provider')
+
+    if (hasModule("nearby", true)) runtimeOnly project(':play-services-nearby-core-package')
+    if (hasModule("hms", false)) hmsRuntimeOnly project(':play-services-maps-core-hms')
+
+    // AndroidX UI
+    implementation "androidx.multidex:multidex:$multidexVersion"
+    implementation "androidx.appcompat:appcompat:$appcompatVersion"
+    implementation "androidx.mediarouter:mediarouter:$mediarouterVersion"
+    implementation "androidx.preference:preference-ktx:$preferenceVersion"
+    implementation "androidx.webkit:webkit:$webkitVersion"
+
+    // Material Components
+    implementation "com.google.android.material:material:$materialVersion"
+
+    // Compose
+    def composeBom = platform('androidx.compose:compose-bom:2024.04.00')
+    implementation composeBom
+    implementation 'androidx.compose.material3:material3'
+    implementation 'androidx.compose.ui:ui-tooling-preview'
+    debugImplementation 'androidx.compose.ui:ui-tooling'
+    implementation 'androidx.activity:activity-compose:1.8.2'
+
+    // Navigation
+    implementation "androidx.navigation:navigation-fragment-ktx:$navigationVersion"
+    implementation "androidx.navigation:navigation-ui-ktx:$navigationVersion"
+
+    implementation "com.android.volley:volley:$volleyVersion"
+
+    implementation "androidx.lifecycle:lifecycle-service:$lifecycleVersion"
+    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlinVersion"
+}
+
+android {
+    namespace "com.google.android.gms"
+
+    compileSdkVersion androidCompileSdk
+    buildToolsVersion "$androidBuildVersionTools"
+
+    buildFeatures {
+        buildConfig = true
+        dataBinding = true
+        compose true
+    }
+
+    defaultConfig {
+        versionName version
+        versionCode appVersionCode
+
+        minSdkVersion androidMinSdk
+        targetSdkVersion androidTargetSdk
+
+        multiDexEnabled true
+        multiDexKeepProguard file('multidex-keep.pro')
+
+        manifestPlaceholders = [appLabel:"@string/gms_app_name"]
+        resValue "string", "package_id", "com.google.android.gms"
+
+        buildConfigField "String", "SAFETYNET_KEY", "\"${localProperties.get("safetynet.key", "")}\""
+        buildConfigField "String", "RECAPTCHA_SITE_KEY", "\"${localProperties.get("recaptcha.siteKey", "")}\""
+        buildConfigField "String", "RECAPTCHA_SECRET", "\"${localProperties.get("recaptcha.secret", "")}\""
+        buildConfigField "String", "RECAPTCHA_ENTERPRISE_PROJECT_ID", "\"${localProperties.get("recaptchaEnterpreise.projectId", "")}\""
+        buildConfigField "String", "RECAPTCHA_ENTERPRISE_SITE_KEY", "\"${localProperties.get("recaptchaEnterpreise.siteKey", "")}\""
+        buildConfigField "String", "RECAPTCHA_ENTERPRISE_API_KEY", "\"${localProperties.get("recaptchaEnterpreise.apiKey", "")}\""
+
+        ndk {
+            abiFilters "armeabi-v7a", "arm64-v8a", "x86", "x86_64"
+        }
+    }
+
+    composeOptions {
+        kotlinCompilerExtensionVersion = "1.5.10"
+    }
+
+    sourceSets {
+        main {
+            java.srcDirs += 'src/main/kotlin'
+        }
+    }
+
+    lintOptions {
+        disable 'MissingTranslation', 'GetLocales', 'InvalidPackage', 'BatteryLife', 'ImpliedQuantity', 'MissingQuantity', 'InvalidWakeLockTag', 'UniquePermission'
+    }
+
+    buildTypes {
+        release {
+            minifyEnabled false
+            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
+        }
+    }
+
+    flavorDimensions = ['maps', 'target']
+    productFlavors {
+        "default" {
+            dimension 'target'
+        }
+        "huawei" {
+            dimension 'target'
+            versionNameSuffix "-hw"
+        }
+        "huaweilh" {
+            dimension 'target'
+            versionNameSuffix "-lh"
+            versionCode appVersionCode - 1000
+            matchingFallbacks = ['huawei']
+        }
+        "user" {
+            dimension 'target'
+            applicationId = "org.microg.gms"
+            versionNameSuffix "-user"
+            manifestPlaceholders = [appLabel:"@string/limited_services_app_name"]
+            matchingFallbacks = ['default']
+            resValue "string", "package_id", "org.microg.gms"
+        }
+        "hms" {
+            dimension 'maps'
+        }
+        "mapbox" {
+            dimension 'maps'
+        }
+        "vtm" {
+            dimension 'maps'
+        }
+    }
+
+    compileOptions {
+        sourceCompatibility JavaVersion.VERSION_1_8
+        targetCompatibility JavaVersion.VERSION_1_8
+    }
+
+    kotlinOptions {
+        jvmTarget = 1.8
+    }
+
+    packagingOptions {
+        exclude 'META-INF/ASL2.0'
+        jniLibs {
+            useLegacyPackaging true
+        }
+    }
+}
+
+if (file('user.gradle').exists()) {
+    apply from: 'user.gradle'
+}
+
+android.applicationVariants.all { variant ->
+    variant.outputs.each { output ->
+        output.outputFileName = variant.applicationId + "-" + variant.versionCode + variant.versionName.substring(version.length()) + ".apk"
+    }
+}
diff -Naur inputbak/play-services-core/src/main/AndroidManifest.xml input/play-services-core/src/main/AndroidManifest.xml
--- inputbak/play-services-core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.261989921 +0300
+++ input/play-services-core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.485989909 +0300
@@ -17,124 +17,124 @@
     xmlns:tools="http://schemas.android.com/tools">
 
     <permission
-        android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"
+        android:name="${basePackageName}.android.providers.gsf.permission.READ_GSERVICES"
         android:label="@string/perm_gsf_read_gservices_label"
         android:protectionLevel="normal" />
     <permission
-        android:name="com.google.android.c2dm.permission.RECEIVE"
+        android:name="${basePackageName}.android.c2dm.permission.RECEIVE"
         android:label="@string/perm_c2dm_receive_label"
         android:permissionGroup="android.permission-group.NETWORK"
         android:protectionLevel="normal" />
     <permission
-        android:name="com.google.android.c2dm.permission.SEND"
+        android:name="${basePackageName}.android.c2dm.permission.SEND"
         android:label="@string/perm_c2dm_send_label"
         android:permissionGroup="android.permission-group.NETWORK"
         android:protectionLevel="privileged|signature" />
     <permission
-        android:name="com.google.android.gtalkservice.permission.GTALK_SERVICE"
+        android:name="${basePackageName}.android.gtalkservice.permission.GTALK_SERVICE"
         android:label="@string/perm_gtalk_svc_label"
         android:permissionGroup="android.permission-group.MESSAGES"
         android:protectionLevel="signature" />
 
     <permission-tree
-        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH"
+        android:name="${basePackageName}.android.googleapps.permission.GOOGLE_AUTH"
         android:icon="@drawable/proprietary_auth_ic_scope_icon_default" />
 
     <permission
-        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.cp"
+        android:name="${basePackageName}.android.googleapps.permission.GOOGLE_AUTH.cp"
         android:description="@string/permission_service_cp_description"
         android:label="@string/permission_service_cp_label"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.local"
+        android:name="${basePackageName}.android.googleapps.permission.GOOGLE_AUTH.local"
         android:description="@string/permission_service_local_description"
         android:label="@string/permission_service_local_label"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.mail"
+        android:name="${basePackageName}.android.googleapps.permission.GOOGLE_AUTH.mail"
         android:description="@string/permission_service_mail_description"
         android:label="@string/permission_service_mail_label"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.writely"
+        android:name="${basePackageName}.android.googleapps.permission.GOOGLE_AUTH.writely"
         android:description="@string/permission_service_writely_description"
         android:label="@string/permission_service_writely_label"
         android:protectionLevel="dangerous" />
 
     <permission
-        android:name="com.google.android.gms.permission.ACTIVITY_RECOGNITION"
+        android:name="${basePackageName}.android.gms.permission.ACTIVITY_RECOGNITION"
         android:label="@string/perm_activity_recognition_label"
         android:description="@string/perm_activity_recognition_description"
         android:protectionLevel="normal" />
 
     <permission
-        android:name="com.google.android.gms.permission.AD_ID"
+        android:name="${basePackageName}.android.gms.permission.AD_ID"
         android:label="@string/perm_ad_id_label"
         android:description="@string/perm_ad_id_description"
         android:protectionLevel="normal" />
     <permission
-        android:name="com.google.android.gms.permission.AD_ID_NOTIFICATION"
+        android:name="${basePackageName}.android.gms.permission.AD_ID_NOTIFICATION"
         android:label="@string/perm_ad_id_notification_label"
         android:description="@string/perm_ad_id_notification_description"
         android:protectionLevel="normal" />
 
 
     <permission
-        android:name="com.google.android.gms.auth.api.phone.permission.SEND"
+        android:name="${basePackageName}.android.gms.auth.api.phone.permission.SEND"
         android:protectionLevel="signature" />
 
     <permission
-        android:name="org.microg.gms.STATUS_BROADCAST"
+        android:name="${basePackageName}.microg.gms.STATUS_BROADCAST"
         android:label="@string/perm_status_broadcast_label"
         android:protectionLevel="normal" />
     <permission
-        android:name="org.microg.gms.EXTENDED_ACCESS"
+        android:name="${basePackageName}.microg.gms.EXTENDED_ACCESS"
         android:label="@string/perm_extended_access_label"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="org.microg.gms.PROVISION"
+        android:name="${basePackageName}.microg.gms.PROVISION"
         android:description="@string/perm_provision_description"
         android:label="@string/perm_provision_label"
         android:protectionLevel="privileged|signature" />
 
     <permission
-        android:name="com.google.android.gms.permission.CAR_SPEED"
+        android:name="${basePackageName}.android.gms.permission.CAR_SPEED"
         android:label="@string/perm_car_speed_label"
         android:description="@string/perm_car_speed_description"
         android:permissionGroup="android.permission-group.LOCATION"
         android:protectionLevel="dangerous" />
 
     <permission-group
-        android:name="com.google.android.gms.permission.CAR_INFORMATION"
+        android:name="${basePackageName}.android.gms.permission.CAR_INFORMATION"
         android:label="@string/perm_car_info_label"
         android:description="@string/perm_car_info_description" />
     <permission
-        android:name="com.google.android.gms.permission.CAR_FUEL"
+        android:name="${basePackageName}.android.gms.permission.CAR_FUEL"
         android:label="@string/perm_car_fuel_label"
         android:description="@string/perm_car_fuel_description"
-        android:permissionGroup="com.google.android.gms.permission.CAR_INFORMATION"
+        android:permissionGroup="${basePackageName}.android.gms.permission.CAR_INFORMATION"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="com.google.android.gms.permission.CAR_MILEAGE"
+        android:name="${basePackageName}.android.gms.permission.CAR_MILEAGE"
         android:label="@string/perm_car_mileage_label"
         android:description="@string/perm_car_mileage_description"
-        android:permissionGroup="com.google.android.gms.permission.CAR_INFORMATION"
+        android:permissionGroup="${basePackageName}.android.gms.permission.CAR_INFORMATION"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="com.google.android.gms.permission.CAR_VENDOR_EXTENSION"
+        android:name="${basePackageName}.android.gms.permission.CAR_VENDOR_EXTENSION"
         android:label="@string/perm_car_vendor_extension_label"
         android:description="@string/perm_car_vendor_extension_description"
-        android:permissionGroup="com.google.android.gms.permission.CAR_INFORMATION"
+        android:permissionGroup="${basePackageName}.android.gms.permission.CAR_INFORMATION"
         android:protectionLevel="dangerous" />
     <permission
-        android:name="com.google.android.gms.locationsharingreporter.periodic.STATUS_UPDATE"
+        android:name="${basePackageName}.android.gms.locationsharingreporter.periodic.STATUS_UPDATE"
         android:protectionLevel="signature"/>
-    <uses-permission android:name="com.google.android.gms.locationsharingreporter.periodic.STATUS_UPDATE"/>
+    <uses-permission android:name="${basePackageName}.android.gms.locationsharingreporter.periodic.STATUS_UPDATE"/>
 
     <permission
-        android:name="com.google.android.gms.auth.permission.GOOGLE_ACCOUNT_CHANGE"
+        android:name="${basePackageName}.android.gms.auth.permission.GOOGLE_ACCOUNT_CHANGE"
         android:protectionLevel="signature"/>
-    <uses-permission android:name="com.google.android.gms.auth.permission.GOOGLE_ACCOUNT_CHANGE" />
+    <uses-permission android:name="${basePackageName}.android.gms.auth.permission.GOOGLE_ACCOUNT_CHANGE" />
 
     <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
     <uses-permission android:name="android.permission.INTERNET" />
@@ -157,12 +157,12 @@
     <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
     <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
 
-    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
-    <uses-permission android:name="com.google.android.c2dm.permission.SEND" />
-    <uses-permission android:name="com.google.android.gtalkservice.permission.GTALK_SERVICE" />
-    <uses-permission android:name="com.google.android.gms.auth.api.phone.permission.SEND" />
+    <uses-permission android:name="${basePackageName}.android.c2dm.permission.RECEIVE" />
+    <uses-permission android:name="${basePackageName}.android.c2dm.permission.SEND" />
+    <uses-permission android:name="${basePackageName}.android.gtalkservice.permission.GTALK_SERVICE" />
+    <uses-permission android:name="${basePackageName}.android.gms.auth.api.phone.permission.SEND" />
 
-    <uses-permission android:name="org.microg.gms.STATUS_BROADCAST" />
+    <uses-permission android:name="${basePackageName}.microg.gms.STATUS_BROADCAST" />
 
     <uses-permission android:name="android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS" />
     <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
@@ -211,14 +211,14 @@
         android:networkSecurityConfig="@xml/network_security_config"
         android:theme="@style/Theme.App">
 
-        <library android:name="com.google.android.gms" />
+        <library android:name="${basePackageName}.android.gms" />
 
         <!-- Provision -->
 
         <service
             android:name="org.microg.gms.provision.ProvisionService"
             android:exported="true"
-            android:permission="org.microg.gms.PROVISION" />
+            android:permission="${basePackageName}.microg.gms.PROVISION" />
 
         <!-- Location -->
 
@@ -229,7 +229,7 @@
             android:process=":ui"
             android:theme="@style/Theme.AppCompat.DayNight.NoActionBar">
             <intent-filter>
-                <action android:name="com.google.android.gms.location.places.ui.PICK_PLACE" />
+                <action android:name="${basePackageName}.android.gms.location.places.ui.PICK_PLACE" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -254,20 +254,20 @@
 
         <service android:name="org.microg.gms.places.GeoDataService">
             <intent-filter>
-                <action android:name="com.google.android.gms.location.places.GeoDataApi" />
-                <action android:name="com.google.android.gms.location.places.PlacesApi" />
+                <action android:name="${basePackageName}.android.gms.location.places.GeoDataApi" />
+                <action android:name="${basePackageName}.android.gms.location.places.PlacesApi" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.places.PlaceDetectionService">
             <intent-filter>
-                <action android:name="com.google.android.gms.location.places.PlaceDetectionApi" />
+                <action android:name="${basePackageName}.android.gms.location.places.PlaceDetectionApi" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.wearable.location.WearableLocationService">
             <intent-filter>
-                <action android:name="com.google.android.gms.wearable.MESSAGE_RECEIVED" />
+                <action android:name="${basePackageName}.android.gms.wearable.MESSAGE_RECEIVED" />
                 <data
                     android:host="*"
                     android:pathPrefix="/com/google/android/location/fused/wearable"
@@ -279,21 +279,14 @@
 
         <provider
             android:name="org.microg.gms.gservices.GServicesProvider"
-            android:authorities="com.google.android.gsf.gservices"
+            android:authorities="${basePackageName}.android.gsf.gservices"
             android:exported="true" />
         <provider
             android:name="org.microg.gms.settings.GoogleSettingsProvider"
-            android:authorities="com.google.settings"
+            android:authorities="${basePackageName}.settings"
             android:exported="true" />
         <provider
-            android:name="org.microg.gms.feeds.SubscribedFeedsProvider"
-            android:authorities="subscribedfeeds"
-            android:exported="true"
-            android:multiprocess="false"
-            android:readPermission="android.permission.SUBSCRIBED_FEEDS_READ"
-            android:writePermission="android.permission.SUBSCRIBED_FEEDS_WRITE" />
-        <provider
-            android:authorities="com.google.android.gms.fileprovider"
+            android:authorities="${basePackageName}.android.gms.fileprovider"
             android:name="org.microg.gms.settings.GmsFileProvider"
             android:exported="false"
             android:grantUriPermissions="true">
@@ -306,7 +299,7 @@
 
         <service android:name="org.microg.gms.checkin.CheckinService">
             <intent-filter>
-                <action android:name="com.google.android.gms.checkin.BIND_TO_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.checkin.BIND_TO_SERVICE" />
             </intent-filter>
         </service>
 
@@ -321,7 +314,7 @@
                 <action android:name="android.intent.action.PACKAGE_RESTARTED" />
             </intent-filter>
             <intent-filter>
-                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
+                <action android:name="${basePackageName}.android.c2dm.intent.RECEIVE" />
 
                 <category android:name="android.server.checkin.CHECKIN" />
             </intent-filter>
@@ -339,8 +332,8 @@
             android:name="org.microg.gms.gcm.PushRegisterService"
             android:process=":persistent">
             <intent-filter>
-                <action android:name="com.google.android.c2dm.intent.REGISTER" />
-                <action android:name="com.google.android.c2dm.intent.UNREGISTER" />
+                <action android:name="${basePackageName}.android.c2dm.intent.REGISTER" />
+                <action android:name="${basePackageName}.android.c2dm.intent.UNREGISTER" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -350,7 +343,7 @@
             android:name="org.microg.gms.gcm.PushRegisterReceiver"
             android:process=":persistent">
             <intent-filter>
-                <action android:name="com.google.iid.TOKEN_REQUEST" />
+                <action android:name="${basePackageName}.iid.TOKEN_REQUEST" />
             </intent-filter>
         </receiver>
 
@@ -372,7 +365,7 @@
                 <action android:name="org.microg.gms.gcm.REGISTER_ACCOUNT" />
                 <action android:name="org.microg.gms.gcm.NOTIFY_COMPLETE" />
 
-                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
+                <action android:name="${basePackageName}.android.c2dm.intent.RECEIVE" />
             </intent-filter>
         </receiver>
 
@@ -380,7 +373,7 @@
             android:name="org.microg.gms.gcm.SendReceiver"
             android:process=":persistent">
             <intent-filter>
-                <action android:name="com.google.android.gcm.intent.SEND" />
+                <action android:name="${basePackageName}.android.gcm.intent.SEND" />
             </intent-filter>
         </receiver>
 
@@ -427,7 +420,7 @@
 
         <service android:name="org.microg.gms.car.CarService">
             <intent-filter>
-                <action android:name="com.google.android.gms.car.service.START" />
+                <action android:name="${basePackageName}.android.gms.car.service.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -437,7 +430,7 @@
 
         <service android:name="org.microg.gms.people.PeopleService">
             <intent-filter>
-                <action android:name="com.google.android.gms.people.service.START" />
+                <action android:name="${basePackageName}.android.gms.people.service.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -458,16 +451,16 @@
 
         <service android:name="org.microg.gms.wearable.WearableService">
             <intent-filter>
-                <action android:name="com.google.android.gms.wearable.BIND" />
+                <action android:name="${basePackageName}.android.gms.wearable.BIND" />
             </intent-filter>
         </service>
 
         <activity
-            android:name="com.google.android.gms.wearable.consent.TermsOfServiceActivity"
+            android:name="${basePackageName}.android.gms.wearable.consent.TermsOfServiceActivity"
             android:process=":ui"
             android:configChanges="screenSize|orientation|keyboardHidden">
             <intent-filter>
-                <action android:name="com.google.android.gms.wearable.TOS"/>
+                <action android:name="${basePackageName}.android.gms.wearable.TOS"/>
                 <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
@@ -479,7 +472,7 @@
                 <action android:name="android.accounts.AccountAuthenticator" />
             </intent-filter>
             <intent-filter>
-                <action android:name="com.google.android.gsf.action.GET_GLS" />
+                <action android:name="${basePackageName}.android.gsf.action.GET_GLS" />
             </intent-filter>
 
             <meta-data
@@ -497,8 +490,8 @@
             android:process=":ui"
             android:theme="@style/Theme.App.DayNight.Dialog.Alert.NoActionBar">
             <intent-filter>
-                <action android:name="com.google.android.gms.common.account.CHOOSE_ACCOUNT" />
-                <action android:name="com.google.android.gms.common.account.CHOOSE_ACCOUNT_USERTILE"/>
+                <action android:name="${basePackageName}.android.gms.common.account.CHOOSE_ACCOUNT" />
+                <action android:name="${basePackageName}.android.gms.common.account.CHOOSE_ACCOUNT_USERTILE"/>
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -512,7 +505,7 @@
             android:launchMode="singleTask"
             android:theme="@style/Theme.LoginBlue">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.login.LOGIN" />
+                <action android:name="${basePackageName}.android.gms.auth.login.LOGIN" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -543,39 +536,39 @@
 
         <provider
             android:name="org.microg.gms.auth.AccountContentProvider"
-            android:authorities="com.google.android.gms.auth.accounts"
+            android:authorities="${basePackageName}.android.gms.auth.accounts"
             android:exported="true" />
 
         <activity
             android:name="org.microg.gms.auth.credentials.CredentialPickerActivity"
             android:process=":ui">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.credentials.PICKER" />
+                <action android:name="${basePackageName}.android.gms.auth.api.credentials.PICKER" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
 
         <service android:name="org.microg.gms.auth.credentials.CredentialsService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.credentials.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.credentials.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.auth.proxy.AuthProxyService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.auth.appcert.AppCertService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.be.appcert.AppCertService" />
+                <action android:name="${basePackageName}.android.gms.auth.be.appcert.AppCertService" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.credential.CredentialManagerService">
             <intent-filter>
-                <action android:name="com.google.android.gms.credential.manager.service.firstparty.START" />
+                <action android:name="${basePackageName}.android.gms.credential.manager.service.firstparty.START" />
             </intent-filter>
         </service>
 
@@ -586,28 +579,28 @@
             android:configChanges="keyboardHidden|keyboard|orientation|screenSize"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.GOOGLE_SIGN_IN" />
+                <action android:name="${basePackageName}.android.gms.auth.GOOGLE_SIGN_IN" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
 
         <service android:name=".locationsharingreporter.service.LocationSharingReporterApiService">
             <intent-filter>
-                <action android:name="com.google.android.gms.locationsharingreporter.service.START" />
+                <action android:name="${basePackageName}.android.gms.locationsharingreporter.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.signin.SignInService">
             <intent-filter>
-                <action android:name="com.google.android.gms.signin.service.START" />
+                <action android:name="${basePackageName}.android.gms.signin.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.auth.signin.AuthSignInService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.signin.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.signin.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
@@ -618,19 +611,19 @@
 
         <service android:name="org.microg.gms.auth.credentials.identity.AuthorizationService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.identity.service.authorization.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.identity.service.authorization.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.auth.credentials.identity.IdentitySignInService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.identity.service.signin.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.identity.service.signin.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.auth.folsom.KeyRetrievalService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.key.retrieval.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.key.retrieval.service.START" />
             </intent-filter>
         </service>
 
@@ -655,7 +648,7 @@
             android:launchMode="singleTask"
             android:excludeFromRecents="false">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.api.credentials.ASSISTED_SIGNIN"/>
+                <action android:name="${basePackageName}.android.gms.auth.api.credentials.ASSISTED_SIGNIN"/>
                 <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
@@ -690,10 +683,10 @@
             android:launchMode="singleTask"
             android:theme="@style/Theme.AppCompat.Dialog.Alert">
             <intent-filter>
-                <action android:name="com.google.android.gms.games.SHOW_SELECT_SNAPSHOT"/>
-                <action android:name="com.google.android.gms.games.VIEW_ACHIEVEMENTS" />
-                <action android:name="com.google.android.gms.games.VIEW_LEADERBOARDS" />
-                <action android:name="com.google.android.gms.games.VIEW_LEADERBOARD_SCORES" />
+                <action android:name="${basePackageName}.android.gms.games.SHOW_SELECT_SNAPSHOT"/>
+                <action android:name="${basePackageName}.android.gms.games.VIEW_ACHIEVEMENTS" />
+                <action android:name="${basePackageName}.android.gms.games.VIEW_LEADERBOARDS" />
+                <action android:name="${basePackageName}.android.gms.games.VIEW_LEADERBOARD_SCORES" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
@@ -711,7 +704,7 @@
             android:process=":ui"
             android:theme="@style/Theme.AppCompat.DayNight.Dialog">
             <intent-filter>
-                <action android:name="com.google.android.gms.games.PLAY_GAMES_UPGRADE" />
+                <action android:name="${basePackageName}.android.gms.games.PLAY_GAMES_UPGRADE" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
@@ -720,7 +713,7 @@
             android:name="org.microg.gms.games.GamesService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.games.service.START" />
+                <action android:name="${basePackageName}.android.gms.games.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
@@ -729,7 +722,7 @@
             android:name="org.microg.gms.games.GamesConnectService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.games.internal.connect.service.START" />
+                <action android:name="${basePackageName}.android.gms.games.internal.connect.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
@@ -741,13 +734,13 @@
         <!-- Chimera -->
         <provider
             android:name="org.microg.gms.chimera.ServiceProvider"
-            android:authorities="com.google.android.gms.chimera"
+            android:authorities="${basePackageName}.android.gms.chimera"
             android:exported="true" />
 
         <!-- Fonts -->
         <provider
             android:name="org.microg.gms.fonts.FontsProvider"
-            android:authorities="com.google.android.gms.fonts"
+            android:authorities="${basePackageName}.android.gms.fonts"
             android:exported="true" />
 
         <!-- microG Settings activity -->
@@ -771,7 +764,7 @@
             </intent-filter>
             <intent-filter>
                 <action android:name="android.intent.action.APPLICATION_PREFERENCES" />
-                <action android:name="com.google.android.gms.settings.EXPOSURE_NOTIFICATION_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.settings.EXPOSURE_NOTIFICATION_SETTINGS" />
                 <action android:name="org.microg.gms.settings.CHECKIN_SETTINGS" />
                 <action android:name="org.microg.gms.settings.GCM_SETTINGS" />
                 <action android:name="org.microg.gms.settings.MICROG_APP_GCM_SETTINGS" />
@@ -829,7 +822,7 @@
 
         <!-- microG Settings activity-alias for Google settings compatibility -->
         <activity-alias
-            android:name="com.google.android.gms.app.settings.GoogleSettingsLink"
+            android:name="${basePackageName}.android.gms.app.settings.GoogleSettingsLink"
             android:process=":ui"
             android:exported="true"
             android:targetActivity="org.microg.gms.ui.MainSettingsActivity"
@@ -861,10 +854,10 @@
             android:taskAffinity="org.microg.gms.settings"
             android:theme="@style/Theme.AppCompat.Light.NoActionBar">
             <intent-filter>
-                <action android:name="com.google.android.gms.accountsettings.MY_ACCOUNT" />
-                <action android:name="com.google.android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS" />
-                <action android:name="com.google.android.gms.accountsettings.PRIVACY_SETTINGS" />
-                <action android:name="com.google.android.gms.accountsettings.SECURITY_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.accountsettings.MY_ACCOUNT" />
+                <action android:name="${basePackageName}.android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.accountsettings.PRIVACY_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.accountsettings.SECURITY_SETTINGS" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -877,17 +870,17 @@
             android:excludeFromRecents="true"
             android:theme="@style/Theme.App.DayNight.Dialog.Alert.NoActionBar">
             <intent-filter>
-                <action android:name="com.google.android.gms.accountsettings.action.VIEW_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.accountsettings.action.VIEW_SETTINGS" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
             <intent-filter>
-                <action android:name="com.google.android.gms.accountsettings.action.BROWSE_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.accountsettings.action.BROWSE_SETTINGS" />
 
                 <category android:name="android.intent.category.DEFAULT" />
                 <category android:name="android.intent.category.BROWSABLE" />
             </intent-filter>
             <intent-filter>
-                <action android:name="com.google.android.gms.location.settings.LOCATION_SHARING"/>
+                <action android:name="${basePackageName}.android.gms.location.settings.LOCATION_SHARING"/>
                 <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
@@ -897,8 +890,8 @@
             android:process=":ui"
             android:taskAffinity="org.microg.gms.settings">
             <intent-filter>
-                <action android:name="com.google.android.location.settings.LOCATION_REPORTING_SETTINGS" />
-                <action android:name="com.google.android.gms.location.settings.LOCATION_REPORTING_SETTINGS" />
+                <action android:name="${basePackageName}.android.location.settings.LOCATION_REPORTING_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.location.settings.LOCATION_REPORTING_SETTINGS" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -908,12 +901,12 @@
 
         <provider
             android:name="org.microg.gms.phenotype.ConfigurationProvider"
-            android:authorities="com.google.android.gms.phenotype"
+            android:authorities="${basePackageName}.android.gms.phenotype"
             android:exported="true" />
 
         <service android:name="org.microg.gms.phenotype.PhenotypeService">
             <intent-filter>
-                <action android:name="com.google.android.gms.phenotype.service.START" />
+                <action android:name="${basePackageName}.android.gms.phenotype.service.START" />
             </intent-filter>
         </service>
 
@@ -923,7 +916,7 @@
             android:name="org.microg.gms.googlehelp.GoogleHelpService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.googlehelp.service.GoogleHelpService.START" />
+                <action android:name="${basePackageName}.android.gms.googlehelp.service.GoogleHelpService.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
@@ -933,7 +926,7 @@
             android:theme="@style/Theme.App.Translucent"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.googlehelp.HELP" />
+                <action android:name="${basePackageName}.android.gms.googlehelp.HELP" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
 
@@ -946,7 +939,7 @@
 
         <service android:name="org.microg.gms.potokens.PoTokensService">
             <intent-filter>
-                <action android:name="com.google.android.gms.potokens.service.START" />
+                <action android:name="${basePackageName}.android.gms.potokens.service.START" />
             </intent-filter>
         </service>
 
@@ -957,7 +950,7 @@
             android:theme="@android:style/Theme.Translucent.NoTitleBar"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.backup.ACTION_BACKUP_SETTINGS"/>
+                <action android:name="${basePackageName}.android.gms.backup.ACTION_BACKUP_SETTINGS"/>
                 <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
@@ -968,7 +961,7 @@
             android:name="org.microg.gms.measurement.MeasurementService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.measurement.START" />
+                <action android:name="${basePackageName}.android.gms.measurement.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -977,38 +970,38 @@
             android:name="org.microg.gms.languageprofile.LanguageProfileService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.languageprofile.service.START" />
+                <action android:name="${basePackageName}.android.gms.languageprofile.service.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
         <service android:name="org.microg.gms.mdm.NetworkQualityService">
             <intent-filter>
-                <action android:name="com.google.android.gms.mdm.services.START" />
+                <action android:name="${basePackageName}.android.gms.mdm.services.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
         <service android:name="org.microg.gms.icing.LightweightIndexService">
             <intent-filter>
-                <action android:name="com.google.android.gms.icing.LIGHTWEIGHT_INDEX_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.icing.LIGHTWEIGHT_INDEX_SERVICE" />
             </intent-filter>
         </service>
         <service android:name="org.microg.gms.icing.IndexService">
             <intent-filter>
-                <action android:name="com.google.android.gms.icing.INDEX_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.icing.INDEX_SERVICE" />
             </intent-filter>
         </service>
         <service
             android:name=".analytics.service.AnalyticsService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.analytics.service.START" />
+                <action android:name="${basePackageName}.android.gms.analytics.service.START" />
             </intent-filter>
         </service>
         <service android:name="org.microg.gms.playlog.PlayLogService">
             <intent-filter>
-                <action android:name="com.google.android.gms.playlog.service.START" />
+                <action android:name="${basePackageName}.android.gms.playlog.service.START" />
             </intent-filter>
         </service>
         <service
@@ -1017,7 +1010,7 @@
 
         <service android:name="org.microg.gms.ads.GService">
             <intent-filter>
-                <action android:name="com.google.android.gms.ads.gservice.START" />
+                <action android:name="${basePackageName}.android.gms.ads.gservice.START" />
             </intent-filter>
         </service>
 
@@ -1049,18 +1042,18 @@
 
         <service android:name="org.microg.gms.feedback.FeedbackService">
             <intent-filter>
-                <action android:name="com.google.android.gms.feedback.internal.IFeedbackService" />
+                <action android:name="${basePackageName}.android.gms.feedback.internal.IFeedbackService" />
             </intent-filter>
         </service>
 
         <activity
-            android:name="com.google.android.gms.feedback.FeedbackActivity"
+            android:name="${basePackageName}.android.gms.feedback.FeedbackActivity"
             android:exported="true"
             android:excludeFromRecents="true"
             android:theme="@style/Theme.App.Translucent"/>
 
         <activity
-            android:name="com.google.android.gms.credential.manager.PasswordManagerActivity"
+            android:name="${basePackageName}.android.gms.credential.manager.PasswordManagerActivity"
             android:exported="true"
             android:process=":ui"
             android:excludeFromRecents="true"
@@ -1068,99 +1061,99 @@
 
         <service android:name="org.microg.gms.clearcut.ClearcutLoggerService">
             <intent-filter>
-                <action android:name="com.google.android.gms.clearcut.service.START" />
+                <action android:name="${basePackageName}.android.gms.clearcut.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
         <service android:name="org.microg.gms.drive.api.DriveApiService">
             <intent-filter>
-                <action android:name="com.google.android.gms.drive.ApiService.START" />
-                <action android:name="com.google.android.gms.drive.ApiService.STOP" />
-                <action android:name="com.google.android.gms.drive.ApiService.RESET_AFTER_BOOT" />
+                <action android:name="${basePackageName}.android.gms.drive.ApiService.START" />
+                <action android:name="${basePackageName}.android.gms.drive.ApiService.STOP" />
+                <action android:name="${basePackageName}.android.gms.drive.ApiService.RESET_AFTER_BOOT" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
         <service android:name="org.microg.gms.reminders.RemindersService">
             <intent-filter>
-                <action android:name="com.google.android.gms.reminders.service.START" />
+                <action android:name="${basePackageName}.android.gms.reminders.service.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.wallet.PaymentService">
             <intent-filter>
-                <action android:name="com.google.android.gms.wallet.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.wallet.service.BIND" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.firebase.dynamiclinks.DynamicLinksService">
             <intent-filter>
-                <action android:name="com.google.firebase.dynamiclinks.service.START" />
+                <action android:name="${basePackageName}.firebase.dynamiclinks.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.udc.FacsCacheService">
             <intent-filter>
-                <action android:name="com.google.android.gms.facs.cache.service.START" />
+                <action android:name="${basePackageName}.android.gms.facs.cache.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.usagereporting.UsageReportingService">
             <intent-filter>
-                <action android:name="com.google.android.gms.usagereporting.service.START" />
+                <action android:name="${basePackageName}.android.gms.usagereporting.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.pseudonymous.PseudonymousIdService" >
             <intent-filter>
-                <action android:name="com.google.android.gms.pseudonymous.service.START" />
+                <action android:name="${basePackageName}.android.gms.pseudonymous.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.gass.GassService">
             <intent-filter>
-                <action android:name="com.google.android.gms.gass.START" />
+                <action android:name="${basePackageName}.android.gms.gass.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.auth.account.data.AccountDataService">
             <intent-filter>
-                <action android:name="com.google.android.gms.auth.account.data.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.account.data.service.START" />
             </intent-filter>
         </service>
 
         <service android:name=".semanticlocation.SemanticLocationService" android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.semanticlocation.service.START_ODLH" />
+                <action android:name="${basePackageName}.android.gms.semanticlocation.service.START_ODLH" />
             </intent-filter>
         </service>
 
         <service android:name=".semanticlocationhistory.SemanticLocationHistoryService" android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.semanticlocationhistory.service.START" />
+                <action android:name="${basePackageName}.android.gms.semanticlocationhistory.service.START" />
             </intent-filter>
         </service>
 
         <activity
-            android:name="com.google.android.location.settings.LocationHistorySettingsActivity"
+            android:name="${basePackageName}.android.location.settings.LocationHistorySettingsActivity"
             android:theme="@android:style/Theme.Translucent.NoTitleBar"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.location.settings.LOCATION_HISTORY"/>
+                <action android:name="${basePackageName}.android.gms.location.settings.LOCATION_HISTORY"/>
                 <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
 
         <service android:name="org.microg.gms.audit.AuditService">
             <intent-filter>
-                <action android:name="com.google.android.gms.audit.service.START" />
+                <action android:name="${basePackageName}.android.gms.audit.service.START" />
             </intent-filter>
         </service>
 
         <service android:name="org.microg.gms.common.ClientTelemetryService">
             <intent-filter>
-                <action android:name="com.google.android.gms.common.telemetry.service.START" />
+                <action android:name="${basePackageName}.android.gms.common.telemetry.service.START" />
             </intent-filter>
         </service>
 
@@ -1171,158 +1164,158 @@
             android:excludeFromRecents="true"
             android:theme="@style/Theme.AppCompat.DayNight.NoActionBar">
             <intent-filter>
-                <action android:name="com.google.android.gms.mlkit.ACTION_SCAN_BARCODE" />
+                <action android:name="${basePackageName}.android.gms.mlkit.ACTION_SCAN_BARCODE" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
 
         <service
-            android:name="com.google.android.gms.maps.auth.ApiTokenService"
+            android:name="${basePackageName}.android.gms.maps.auth.ApiTokenService"
             android:exported="true"/>
 
         <service android:name="org.microg.gms.DummyService">
             <intent-filter>
-                <action android:name="com.google.android.contextmanager.service.ContextManagerService.START" />
-                <action android:name="com.google.android.gms.accounts.ACCOUNT_SERVICE" />
-                <action android:name="com.google.android.gms.ads.identifier.service.EVENT_ATTESTATION" />
-                <action android:name="com.google.android.gms.ads.service.CACHE" />
-                <action android:name="com.google.android.gms.ads.service.CONSENT_LOOKUP" />
-                <action android:name="com.google.android.gms.ads.service.HTTP" />
-                <action android:name="com.google.android.gms.appstate.service.START" />
-                <action android:name="com.google.android.gms.appusage.service.START" />
-                <action android:name="com.google.android.gms.asterism.service.START" />
-                <action android:name="com.google.android.gms.audiomodem.service.AudioModemService.START" />
-                <action android:name="com.google.android.gms.auth.account.authapi.START" />
-                <action android:name="com.google.android.gms.auth.account.authenticator.auto.service.START" />
-                <action android:name="com.google.android.gms.auth.account.authenticator.chromeos.START" />
-                <action android:name="com.google.android.gms.auth.account.authenticator.tv.service.START" />
-                <action android:name="com.google.android.gms.auth.api.identity.service.credentialsaving.START" />
-                <action android:name="com.google.android.gms.auth.api.phone.service.InternalService.START" />
-                <action android:name="com.google.android.gms.auth.api.signin.service.START" />
-                <action android:name="com.google.android.gms.auth.config.service.START" />
-                <action android:name="com.google.android.gms.auth.cryptauth.cryptauthservice.START" />
-                <action android:name="com.google.android.gms.auth.proximity.devicesyncservice.START" />
-                <action android:name="com.google.android.gms.auth.proximity.securechannelservice.START" />
-                <action android:name="com.google.android.gms.auth.proximity.START" />
-                <action android:name="com.google.android.gms.auth.service.START" />
-                <action android:name="com.google.android.gms.backup.G1_BACKUP" />
-                <action android:name="com.google.android.gms.backup.G1_RESTORE" />
-                <action android:name="com.google.android.gms.backup.GMS_MODULE_RESTORE" />
-                <action android:name="com.google.android.gms.beacon.internal.IBleService.START" />
-                <action android:name="com.google.android.gms.carrierauth.service.START" />
-                <action android:name="com.google.android.gms.cast.firstparty.START" />
-                <action android:name="com.google.android.gms.cast_mirroring.service.START" />
-                <action android:name="com.google.android.gms.cast.remote_display.service.START" />
-                <action android:name="com.google.android.gms.chromesync.service.START" />
-                <action android:name="com.google.android.gms.common.download.START" />
-                <action android:name="com.google.android.gms.common.service.START" />
-                <action android:name="com.google.android.gms.config.START" />
-                <action android:name="com.google.android.gms.constellation.service.START" />
-                <action android:name="com.google.android.gms.deviceconnection.service.START" />
-                <action android:name="com.google.android.gms.enterprise.loader.service.START" />
-                <action android:name="com.google.android.gms.facs.internal.service.START" />
-                <action android:name="com.google.android.gms.fido.credentialstore.internal_service.START" />
-                <action android:name="com.google.android.gms.fido.fido2.regular.START" />
-                <action android:name="com.google.android.gms.fido.fido2.zeroparty.START" />
-                <action android:name="com.google.android.gms.fido.sourcedevice.service.START" />
-                <action android:name="com.google.android.gms.fido.targetdevice.internal_service.START" />
-                <action android:name="com.google.android.gms.fido.u2f.privileged.START" />
-                <action android:name="com.google.android.gms.fido.u2f.thirdparty.START" />
-                <action android:name="com.google.android.gms.fido.u2f.zeroparty.START" />
-                <action android:name="com.google.android.gms.fitness.BleApi" />
-                <action android:name="com.google.android.gms.fitness.GoalsApi" />
-                <action android:name="com.google.android.gms.fitness.GoogleFitnessService.START" />
-                <action android:name="com.google.android.gms.fitness.InternalApi" />
-                <action android:name="com.google.android.gms.fitness.SensorsApi" />
-                <action android:name="com.google.android.gms.fonts.service.START" />
-                <action android:name="com.google.android.gms.freighter.service.START" />
-                <action android:name="com.google.android.gms.growth.service.START" />
-                <action android:name="com.google.android.gms.googlehelp.service.GoogleHelpService.START" />
-                <action android:name="com.google.android.gms.herrevad.services.LightweightNetworkQualityAndroidService.START" />
-                <action android:name="com.google.android.gms.identity.service.BIND" />
-                <action android:name="com.google.android.gms.inappreach.service.START"/>
-                <action android:name="com.google.android.gms.instantapps.START" />
-                <action android:name="com.google.android.gms.kids.service.START" />
-                <action android:name="com.google.android.gms.learning.internal.dynamitesupport.START" />
-                <action android:name="com.google.android.gms.learning.intservice.START" />
-                <action android:name="com.google.android.gms.learning.predictor.START" />
-                <action android:name="com.google.android.gms.learning.trainer.START" />
-                <action android:name="com.google.android.gms.learning.training.background.START" />
-                <action android:name="com.google.android.gms.locationsharing.api.START" />
-                <action android:name="com.google.android.gms.locationsharingreporter.service.START" />
-                <action android:name="com.google.android.gms.lockbox.service.START" />
-                <action android:name="com.google.android.gms.matchstick.lighter.service.START" />
-                <action android:name="com.google.android.gms.mdm.services.DeviceManagerApiService.START" />
-                <action android:name="com.google.android.gms.mdns.service.START" />
-                <action android:name="com.google.android.gms.nearby.bootstrap.service.NearbyBootstrapService.START" />
-                <action android:name="com.google.android.gms.nearby.connection.service.START" />
-                <action android:name="com.google.android.gms.nearby.fastpair.START" />
-                <action android:name="com.google.android.gms.nearby.messages.service.NearbyMessagesService.START" />
-                <action android:name="com.google.android.gms.nearby.sharing.service.NearbySharingService.START" />
-                <action android:name="com.google.android.gms.nearby.sharing.START_SERVICE" />
-                <action android:name="com.google.android.gms.notifications.service.START" />
-                <action android:name="com.google.android.gms.ocr.service.internal.START" />
-                <action android:name="com.google.android.gms.ocr.service.START" />
-                <action android:name="com.google.android.gms.payse.service.BIND" />
-                <action android:name="com.google.android.gms.people.contactssync.service.START" />
-                <action android:name="com.google.android.gms.photos.autobackup.service.START" />
-                <action android:name="com.google.android.gms.plus.service.default.INTENT" />
-                <action android:name="com.google.android.gms.plus.service.image.INTENT" />
-                <action android:name="com.google.android.gms.plus.service.internal.START" />
-                <action android:name="com.google.android.gms.plus.service.START" />
-                <action android:name="com.google.android.gms.rcs.START" />
-                <action android:name="com.google.android.gms.romanesco.MODULE_BACKUP_AGENT" />
-                <action android:name="com.google.android.gms.romanesco.service.START" />
-                <action android:name="com.google.android.gms.search.service.SEARCH_AUTH_START" />
-                <action android:name="com.google.android.gms.sesame.service.BIND" />
-                <action android:name="com.google.android.gms.telephonyspam.service.START" />
-                <action android:name="com.google.android.gms.testsupport.service.START" />
-                <action android:name="com.google.android.gms.scheduler.ACTION_PROXY_SCHEDULE" />
-                <action android:name="com.google.android.gms.setup.auth.SecondDeviceAuth.START" />
-                <action android:name="com.google.android.gms.smartdevice.d2d.SourceDeviceService.START" />
-                <action android:name="com.google.android.gms.smartdevice.d2d.TargetDeviceService.START" />
-                <action android:name="com.google.android.gms.smartdevice.directtransfer.SourceDirectTransferService.START" />
-                <action android:name="com.google.android.gms.smartdevice.directtransfer.TargetDirectTransferService.START" />
-                <action android:name="com.google.android.gms.smartdevice.postsetup.PostSetupService.START" />
-                <action android:name="com.google.android.gms.smartdevice.setup.accounts.AccountsService.START" />
-                <action android:name="com.google.android.gms.smartdevice.wifi.START_WIFI_HELPER_SERVICE" />
-                <action android:name="com.google.android.gms.social.location.activity.service.START" />
-                <action android:name="com.google.android.gms.statementservice.EXECUTE" />
-                <action android:name="com.google.android.gms.stats.ACTION_UPLOAD_DROPBOX_ENTRIES" />
-                <action android:name="com.google.android.gms.speech.service.START" />
-                <action android:name="com.google.android.gms.thunderbird.service.START" />
-                <action android:name="com.google.android.gms.trustagent.BridgeApi.START" />
-                <action android:name="com.google.android.gms.trustagent.StateApi.START" />
-                <action android:name="com.google.android.gms.trustagent.trustlet.trustletmanagerservice.BIND" />
-                <action android:name="com.google.android.gms.trustlet.bluetooth.service.BIND" />
-                <action android:name="com.google.android.gms.trustlet.connectionlessble.service.BIND" />
-                <action android:name="com.google.android.gms.trustlet.face.service.BIND" />
-                <action android:name="com.google.android.gms.trustlet.nfc.service.BIND" />
-                <action android:name="com.google.android.gms.trustlet.onbody.service.BIND" />
-                <action android:name="com.google.android.gms.trustlet.place.service.BIND" />
-                <action android:name="com.google.android.gms.trustlet.voiceunlock.service.BIND" />
-                <action android:name="com.google.android.gms.udc.service.START" />
-                <action android:name="com.google.android.gms.update.START_API_SERVICE" />
-                <action android:name="com.google.android.gms.update.START_SERVICE" />
-                <action android:name="com.google.android.gms.update.START_SINGLE_USER_API_SERVICE" />
-                <action android:name="com.google.android.gms.update.START_TV_API_SERVICE" />
-                <action android:name="com.google.android.gms.userlocation.service.START" />
-                <action android:name="com.google.android.gms.vehicle.cabin.service.START" />
-                <action android:name="com.google.android.gms.vehicle.climate.service.START" />
-                <action android:name="com.google.android.gms.vehicle.info.service.START" />
-                <action android:name="com.google.android.gms.walletp2p.service.firstparty.BIND" />
-                <action android:name="com.google.android.gms.walletp2p.service.zeroparty.BIND" />
-                <action android:name="com.google.android.gms.wearable.BIND" />
-                <action android:name="com.google.android.gms.wearable.DATA_CHANGED" />
-                <action android:name="com.google.android.gms.wearable.NODE_CHANGED" />
-                <action android:name="com.google.android.mdd.service.START" />
-                <action android:name="com.google.android.mdh.service.START" />
-                <action android:name="com.google.android.mdh.service.listener.START" />
-                <action android:name="com.google.android.mobstore.service.START" />
+                <action android:name="${basePackageName}.android.contextmanager.service.ContextManagerService.START" />
+                <action android:name="${basePackageName}.android.gms.accounts.ACCOUNT_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.ads.identifier.service.EVENT_ATTESTATION" />
+                <action android:name="${basePackageName}.android.gms.ads.service.CACHE" />
+                <action android:name="${basePackageName}.android.gms.ads.service.CONSENT_LOOKUP" />
+                <action android:name="${basePackageName}.android.gms.ads.service.HTTP" />
+                <action android:name="${basePackageName}.android.gms.appstate.service.START" />
+                <action android:name="${basePackageName}.android.gms.appusage.service.START" />
+                <action android:name="${basePackageName}.android.gms.asterism.service.START" />
+                <action android:name="${basePackageName}.android.gms.audiomodem.service.AudioModemService.START" />
+                <action android:name="${basePackageName}.android.gms.auth.account.authapi.START" />
+                <action android:name="${basePackageName}.android.gms.auth.account.authenticator.auto.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.account.authenticator.chromeos.START" />
+                <action android:name="${basePackageName}.android.gms.auth.account.authenticator.tv.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.identity.service.credentialsaving.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.phone.service.InternalService.START" />
+                <action android:name="${basePackageName}.android.gms.auth.api.signin.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.config.service.START" />
+                <action android:name="${basePackageName}.android.gms.auth.cryptauth.cryptauthservice.START" />
+                <action android:name="${basePackageName}.android.gms.auth.proximity.devicesyncservice.START" />
+                <action android:name="${basePackageName}.android.gms.auth.proximity.securechannelservice.START" />
+                <action android:name="${basePackageName}.android.gms.auth.proximity.START" />
+                <action android:name="${basePackageName}.android.gms.auth.service.START" />
+                <action android:name="${basePackageName}.android.gms.backup.G1_BACKUP" />
+                <action android:name="${basePackageName}.android.gms.backup.G1_RESTORE" />
+                <action android:name="${basePackageName}.android.gms.backup.GMS_MODULE_RESTORE" />
+                <action android:name="${basePackageName}.android.gms.beacon.internal.IBleService.START" />
+                <action android:name="${basePackageName}.android.gms.carrierauth.service.START" />
+                <action android:name="${basePackageName}.android.gms.cast.firstparty.START" />
+                <action android:name="${basePackageName}.android.gms.cast_mirroring.service.START" />
+                <action android:name="${basePackageName}.android.gms.cast.remote_display.service.START" />
+                <action android:name="${basePackageName}.android.gms.chromesync.service.START" />
+                <action android:name="${basePackageName}.android.gms.common.download.START" />
+                <action android:name="${basePackageName}.android.gms.common.service.START" />
+                <action android:name="${basePackageName}.android.gms.config.START" />
+                <action android:name="${basePackageName}.android.gms.constellation.service.START" />
+                <action android:name="${basePackageName}.android.gms.deviceconnection.service.START" />
+                <action android:name="${basePackageName}.android.gms.enterprise.loader.service.START" />
+                <action android:name="${basePackageName}.android.gms.facs.internal.service.START" />
+                <action android:name="${basePackageName}.android.gms.fido.credentialstore.internal_service.START" />
+                <action android:name="${basePackageName}.android.gms.fido.fido2.regular.START" />
+                <action android:name="${basePackageName}.android.gms.fido.fido2.zeroparty.START" />
+                <action android:name="${basePackageName}.android.gms.fido.sourcedevice.service.START" />
+                <action android:name="${basePackageName}.android.gms.fido.targetdevice.internal_service.START" />
+                <action android:name="${basePackageName}.android.gms.fido.u2f.privileged.START" />
+                <action android:name="${basePackageName}.android.gms.fido.u2f.thirdparty.START" />
+                <action android:name="${basePackageName}.android.gms.fido.u2f.zeroparty.START" />
+                <action android:name="${basePackageName}.android.gms.fitness.BleApi" />
+                <action android:name="${basePackageName}.android.gms.fitness.GoalsApi" />
+                <action android:name="${basePackageName}.android.gms.fitness.GoogleFitnessService.START" />
+                <action android:name="${basePackageName}.android.gms.fitness.InternalApi" />
+                <action android:name="${basePackageName}.android.gms.fitness.SensorsApi" />
+                <action android:name="${basePackageName}.android.gms.fonts.service.START" />
+                <action android:name="${basePackageName}.android.gms.freighter.service.START" />
+                <action android:name="${basePackageName}.android.gms.growth.service.START" />
+                <action android:name="${basePackageName}.android.gms.googlehelp.service.GoogleHelpService.START" />
+                <action android:name="${basePackageName}.android.gms.herrevad.services.LightweightNetworkQualityAndroidService.START" />
+                <action android:name="${basePackageName}.android.gms.identity.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.inappreach.service.START"/>
+                <action android:name="${basePackageName}.android.gms.instantapps.START" />
+                <action android:name="${basePackageName}.android.gms.kids.service.START" />
+                <action android:name="${basePackageName}.android.gms.learning.internal.dynamitesupport.START" />
+                <action android:name="${basePackageName}.android.gms.learning.intservice.START" />
+                <action android:name="${basePackageName}.android.gms.learning.predictor.START" />
+                <action android:name="${basePackageName}.android.gms.learning.trainer.START" />
+                <action android:name="${basePackageName}.android.gms.learning.training.background.START" />
+                <action android:name="${basePackageName}.android.gms.locationsharing.api.START" />
+                <action android:name="${basePackageName}.android.gms.locationsharingreporter.service.START" />
+                <action android:name="${basePackageName}.android.gms.lockbox.service.START" />
+                <action android:name="${basePackageName}.android.gms.matchstick.lighter.service.START" />
+                <action android:name="${basePackageName}.android.gms.mdm.services.DeviceManagerApiService.START" />
+                <action android:name="${basePackageName}.android.gms.mdns.service.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.bootstrap.service.NearbyBootstrapService.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.connection.service.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.fastpair.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.messages.service.NearbyMessagesService.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.sharing.service.NearbySharingService.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.sharing.START_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.notifications.service.START" />
+                <action android:name="${basePackageName}.android.gms.ocr.service.internal.START" />
+                <action android:name="${basePackageName}.android.gms.ocr.service.START" />
+                <action android:name="${basePackageName}.android.gms.payse.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.people.contactssync.service.START" />
+                <action android:name="${basePackageName}.android.gms.photos.autobackup.service.START" />
+                <action android:name="${basePackageName}.android.gms.plus.service.default.INTENT" />
+                <action android:name="${basePackageName}.android.gms.plus.service.image.INTENT" />
+                <action android:name="${basePackageName}.android.gms.plus.service.internal.START" />
+                <action android:name="${basePackageName}.android.gms.plus.service.START" />
+                <action android:name="${basePackageName}.android.gms.rcs.START" />
+                <action android:name="${basePackageName}.android.gms.romanesco.MODULE_BACKUP_AGENT" />
+                <action android:name="${basePackageName}.android.gms.romanesco.service.START" />
+                <action android:name="${basePackageName}.android.gms.search.service.SEARCH_AUTH_START" />
+                <action android:name="${basePackageName}.android.gms.sesame.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.telephonyspam.service.START" />
+                <action android:name="${basePackageName}.android.gms.testsupport.service.START" />
+                <action android:name="${basePackageName}.android.gms.scheduler.ACTION_PROXY_SCHEDULE" />
+                <action android:name="${basePackageName}.android.gms.setup.auth.SecondDeviceAuth.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.d2d.SourceDeviceService.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.d2d.TargetDeviceService.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.directtransfer.SourceDirectTransferService.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.directtransfer.TargetDirectTransferService.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.postsetup.PostSetupService.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.setup.accounts.AccountsService.START" />
+                <action android:name="${basePackageName}.android.gms.smartdevice.wifi.START_WIFI_HELPER_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.social.location.activity.service.START" />
+                <action android:name="${basePackageName}.android.gms.statementservice.EXECUTE" />
+                <action android:name="${basePackageName}.android.gms.stats.ACTION_UPLOAD_DROPBOX_ENTRIES" />
+                <action android:name="${basePackageName}.android.gms.speech.service.START" />
+                <action android:name="${basePackageName}.android.gms.thunderbird.service.START" />
+                <action android:name="${basePackageName}.android.gms.trustagent.BridgeApi.START" />
+                <action android:name="${basePackageName}.android.gms.trustagent.StateApi.START" />
+                <action android:name="${basePackageName}.android.gms.trustagent.trustlet.trustletmanagerservice.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.bluetooth.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.connectionlessble.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.face.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.nfc.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.onbody.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.place.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.trustlet.voiceunlock.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.udc.service.START" />
+                <action android:name="${basePackageName}.android.gms.update.START_API_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.update.START_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.update.START_SINGLE_USER_API_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.update.START_TV_API_SERVICE" />
+                <action android:name="${basePackageName}.android.gms.userlocation.service.START" />
+                <action android:name="${basePackageName}.android.gms.vehicle.cabin.service.START" />
+                <action android:name="${basePackageName}.android.gms.vehicle.climate.service.START" />
+                <action android:name="${basePackageName}.android.gms.vehicle.info.service.START" />
+                <action android:name="${basePackageName}.android.gms.walletp2p.service.firstparty.BIND" />
+                <action android:name="${basePackageName}.android.gms.walletp2p.service.zeroparty.BIND" />
+                <action android:name="${basePackageName}.android.gms.wearable.BIND" />
+                <action android:name="${basePackageName}.android.gms.wearable.DATA_CHANGED" />
+                <action android:name="${basePackageName}.android.gms.wearable.NODE_CHANGED" />
+                <action android:name="${basePackageName}.android.mdd.service.START" />
+                <action android:name="${basePackageName}.android.mdh.service.START" />
+                <action android:name="${basePackageName}.android.mdh.service.listener.START" />
+                <action android:name="${basePackageName}.android.mobstore.service.START" />
 
                 <action
-                    android:name="com.google.android.gms.wearable.BIND_LISTENER"
+                    android:name="${basePackageName}.android.gms.wearable.BIND_LISTENER"
                     tools:ignore="WearableBindListener" />
             </intent-filter>
         </service>
diff -Naur inputbak/play-services-core/src/main/AndroidManifest.xml.orig input/play-services-core/src/main/AndroidManifest.xml.orig
--- inputbak/play-services-core/src/main/AndroidManifest.xml.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-core/src/main/AndroidManifest.xml.orig	2026-01-01 18:27:15.701989928 +0300
@@ -0,0 +1,1331 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  ~ Copyright (C) 2013-2019 microG Project Team
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~     http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools">
+
+    <permission
+        android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"
+        android:label="@string/perm_gsf_read_gservices_label"
+        android:protectionLevel="normal" />
+    <permission
+        android:name="com.google.android.c2dm.permission.RECEIVE"
+        android:label="@string/perm_c2dm_receive_label"
+        android:permissionGroup="android.permission-group.NETWORK"
+        android:protectionLevel="normal" />
+    <permission
+        android:name="com.google.android.c2dm.permission.SEND"
+        android:label="@string/perm_c2dm_send_label"
+        android:permissionGroup="android.permission-group.NETWORK"
+        android:protectionLevel="privileged|signature" />
+    <permission
+        android:name="com.google.android.gtalkservice.permission.GTALK_SERVICE"
+        android:label="@string/perm_gtalk_svc_label"
+        android:permissionGroup="android.permission-group.MESSAGES"
+        android:protectionLevel="signature" />
+
+    <permission-tree
+        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH"
+        android:icon="@drawable/proprietary_auth_ic_scope_icon_default" />
+
+    <permission
+        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.cp"
+        android:description="@string/permission_service_cp_description"
+        android:label="@string/permission_service_cp_label"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.local"
+        android:description="@string/permission_service_local_description"
+        android:label="@string/permission_service_local_label"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.mail"
+        android:description="@string/permission_service_mail_description"
+        android:label="@string/permission_service_mail_label"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="com.google.android.googleapps.permission.GOOGLE_AUTH.writely"
+        android:description="@string/permission_service_writely_description"
+        android:label="@string/permission_service_writely_label"
+        android:protectionLevel="dangerous" />
+
+    <permission
+        android:name="com.google.android.gms.permission.ACTIVITY_RECOGNITION"
+        android:label="@string/perm_activity_recognition_label"
+        android:description="@string/perm_activity_recognition_description"
+        android:protectionLevel="normal" />
+
+    <permission
+        android:name="com.google.android.gms.permission.AD_ID"
+        android:label="@string/perm_ad_id_label"
+        android:description="@string/perm_ad_id_description"
+        android:protectionLevel="normal" />
+    <permission
+        android:name="com.google.android.gms.permission.AD_ID_NOTIFICATION"
+        android:label="@string/perm_ad_id_notification_label"
+        android:description="@string/perm_ad_id_notification_description"
+        android:protectionLevel="normal" />
+
+
+    <permission
+        android:name="com.google.android.gms.auth.api.phone.permission.SEND"
+        android:protectionLevel="signature" />
+
+    <permission
+        android:name="org.microg.gms.STATUS_BROADCAST"
+        android:label="@string/perm_status_broadcast_label"
+        android:protectionLevel="normal" />
+    <permission
+        android:name="org.microg.gms.EXTENDED_ACCESS"
+        android:label="@string/perm_extended_access_label"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="org.microg.gms.PROVISION"
+        android:description="@string/perm_provision_description"
+        android:label="@string/perm_provision_label"
+        android:protectionLevel="privileged|signature" />
+
+    <permission
+        android:name="com.google.android.gms.permission.CAR_SPEED"
+        android:label="@string/perm_car_speed_label"
+        android:description="@string/perm_car_speed_description"
+        android:permissionGroup="android.permission-group.LOCATION"
+        android:protectionLevel="dangerous" />
+
+    <permission-group
+        android:name="com.google.android.gms.permission.CAR_INFORMATION"
+        android:label="@string/perm_car_info_label"
+        android:description="@string/perm_car_info_description" />
+    <permission
+        android:name="com.google.android.gms.permission.CAR_FUEL"
+        android:label="@string/perm_car_fuel_label"
+        android:description="@string/perm_car_fuel_description"
+        android:permissionGroup="com.google.android.gms.permission.CAR_INFORMATION"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="com.google.android.gms.permission.CAR_MILEAGE"
+        android:label="@string/perm_car_mileage_label"
+        android:description="@string/perm_car_mileage_description"
+        android:permissionGroup="com.google.android.gms.permission.CAR_INFORMATION"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="com.google.android.gms.permission.CAR_VENDOR_EXTENSION"
+        android:label="@string/perm_car_vendor_extension_label"
+        android:description="@string/perm_car_vendor_extension_description"
+        android:permissionGroup="com.google.android.gms.permission.CAR_INFORMATION"
+        android:protectionLevel="dangerous" />
+    <permission
+        android:name="com.google.android.gms.locationsharingreporter.periodic.STATUS_UPDATE"
+        android:protectionLevel="signature"/>
+    <uses-permission android:name="com.google.android.gms.locationsharingreporter.periodic.STATUS_UPDATE"/>
+
+    <permission
+        android:name="com.google.android.gms.auth.permission.GOOGLE_ACCOUNT_CHANGE"
+        android:protectionLevel="signature"/>
+    <uses-permission android:name="com.google.android.gms.auth.permission.GOOGLE_ACCOUNT_CHANGE" />
+
+    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
+    <uses-permission android:name="android.permission.INTERNET" />
+    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
+    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
+    <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />
+    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
+
+    <uses-permission android:name="android.permission.AUTHENTICATE_ACCOUNTS" />
+    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
+    <uses-permission android:name="android.permission.MANAGE_ACCOUNTS" />
+    <uses-permission android:name="android.permission.USE_CREDENTIALS" />
+    <uses-permission android:name="android.permission.WAKE_LOCK" />
+    <uses-permission android:name="android.permission.READ_SYNC_SETTINGS" />
+    <uses-permission android:name="android.permission.WRITE_SYNC_SETTINGS" />
+    <uses-permission android:name="android.permission.READ_SYNC_STATS" />
+    <uses-permission android:name="android.permission.READ_CONTACTS" />
+    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
+
+    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
+    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
+
+    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
+    <uses-permission android:name="com.google.android.c2dm.permission.SEND" />
+    <uses-permission android:name="com.google.android.gtalkservice.permission.GTALK_SERVICE" />
+    <uses-permission android:name="com.google.android.gms.auth.api.phone.permission.SEND" />
+
+    <uses-permission android:name="org.microg.gms.STATUS_BROADCAST" />
+
+    <uses-permission android:name="android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS" />
+    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
+    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
+    <uses-permission
+        android:name="android.permission.CHANGE_DEVICE_IDLE_TEMP_WHITELIST"
+        tools:ignore="ProtectedPermissions" />
+    <uses-permission
+        android:name="android.permission.UPDATE_APP_OPS_STATS"
+        tools:ignore="ProtectedPermissions" />
+
+    <uses-permission android:name="android.permission.CAMERA"/>
+    <uses-feature
+        android:name="android.hardware.camera"
+        android:required="false" />
+
+    <uses-sdk
+        tools:overrideLibrary="androidx.compose.ui.tooling,
+        androidx.compose.material3,
+        androidx.activity.compose,
+        androidx.compose.material.icons,
+        androidx.compose.material.ripple,
+        androidx.compose.foundation,
+        androidx.compose.animation,
+        androidx.compose.foundation.layout,
+        androidx.compose.animation.core,
+        androidx.compose.ui.unit,
+        androidx.compose.ui.geometry,
+        androidx.compose.ui.tooling.data,
+        androidx.compose.ui.util,
+        androidx.compose.ui.text,
+        androidx.compose.ui.graphics,
+        androidx.compose.ui.geometry,
+        androidx.compose.ui.tooling.preview,
+        androidx.compose.runtime.saveable,
+        org.opencv"
+        />
+    <application
+        android:allowBackup="true"
+        android:forceQueryable="true"
+        android:fullBackupOnly="true"
+        android:icon="@mipmap/ic_app"
+        android:roundIcon="@mipmap/ic_app"
+        android:label="${appLabel}"
+        android:multiArch="true"
+        android:networkSecurityConfig="@xml/network_security_config"
+        android:theme="@style/Theme.App">
+
+        <library android:name="com.google.android.gms" />
+
+        <!-- Provision -->
+
+        <service
+            android:name="org.microg.gms.provision.ProvisionService"
+            android:exported="true"
+            android:permission="org.microg.gms.PROVISION" />
+
+        <!-- Location -->
+
+        <activity
+            android:name="org.microg.gms.ui.PlacePickerActivity"
+            android:exported="true"
+            android:label="@string/pick_place_title"
+            android:process=":ui"
+            android:theme="@style/Theme.AppCompat.DayNight.NoActionBar">
+            <intent-filter>
+                <action android:name="com.google.android.gms.location.places.ui.PICK_PLACE" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name=".locationsharingreporter.service.settings.LocationSharingSettingsActivity"
+            android:enabled="true"
+            android:process=":ui"
+            android:excludeFromRecents="true"
+            android:taskAffinity="org.microg.gms.settings"
+            android:exported="false" />
+
+        <activity
+            android:name=".locationsharingreporter.service.settings.LocationShareConfirmActivity"
+            android:enabled="true"
+            android:process=":ui"
+            android:theme="@style/ThemeTranslucentCommon"
+            android:launchMode="singleInstance"
+            android:excludeFromRecents="true"
+            android:exported="false" />
+
+        <service android:name="org.microg.gms.places.GeoDataService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.location.places.GeoDataApi" />
+                <action android:name="com.google.android.gms.location.places.PlacesApi" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.places.PlaceDetectionService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.location.places.PlaceDetectionApi" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.wearable.location.WearableLocationService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.wearable.MESSAGE_RECEIVED" />
+                <data
+                    android:host="*"
+                    android:pathPrefix="/com/google/android/location/fused/wearable"
+                    android:scheme="wear" />
+            </intent-filter>
+        </service>
+
+        <!-- Services Framework -->
+
+        <provider
+            android:name="org.microg.gms.gservices.GServicesProvider"
+            android:authorities="com.google.android.gsf.gservices"
+            android:exported="true" />
+        <provider
+            android:name="org.microg.gms.settings.GoogleSettingsProvider"
+            android:authorities="com.google.settings"
+            android:exported="true" />
+        <provider
+            android:name="org.microg.gms.feeds.SubscribedFeedsProvider"
+            android:authorities="subscribedfeeds"
+            android:exported="true"
+            android:multiprocess="false"
+            android:readPermission="android.permission.SUBSCRIBED_FEEDS_READ"
+            android:writePermission="android.permission.SUBSCRIBED_FEEDS_WRITE" />
+        <provider
+            android:authorities="com.google.android.gms.fileprovider"
+            android:name="org.microg.gms.settings.GmsFileProvider"
+            android:exported="false"
+            android:grantUriPermissions="true">
+            <meta-data
+                android:name="android.support.FILE_PROVIDER_PATHS"
+                android:resource="@xml/file_provider_paths"/>
+        </provider>
+
+        <!-- Device Checkin -->
+
+        <service android:name="org.microg.gms.checkin.CheckinService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.checkin.BIND_TO_SERVICE" />
+            </intent-filter>
+        </service>
+
+        <receiver android:name="org.microg.gms.checkin.TriggerReceiver">
+            <intent-filter>
+                <action android:name="android.intent.action.BOOT_COMPLETED" />
+                <action android:name="android.intent.action.AIRPLANE_MODE" />
+
+                <action android:name="android.server.checkin.CHECKIN" />
+
+                <action android:name="android.intent.action.MY_PACKAGE_REPLACED" />
+                <action android:name="android.intent.action.PACKAGE_RESTARTED" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
+
+                <category android:name="android.server.checkin.CHECKIN" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.provider.Telephony.SECRET_CODE" />
+
+                <data
+                    android:host="2432546"
+                    android:scheme="android_secret_code" />
+            </intent-filter>
+        </receiver>
+
+        <!-- Cloud Messaging -->
+        <service
+            android:name="org.microg.gms.gcm.PushRegisterService"
+            android:process=":persistent">
+            <intent-filter>
+                <action android:name="com.google.android.c2dm.intent.REGISTER" />
+                <action android:name="com.google.android.c2dm.intent.UNREGISTER" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <receiver
+            android:name="org.microg.gms.gcm.PushRegisterReceiver"
+            android:process=":persistent">
+            <intent-filter>
+                <action android:name="com.google.iid.TOKEN_REQUEST" />
+            </intent-filter>
+        </receiver>
+
+        <service
+            android:name="org.microg.gms.gcm.McsService"
+            android:process=":persistent" />
+
+        <service
+            android:name="org.microg.gms.gcm.GcmInGmsService"
+            android:exported="false"
+            android:process=":persistent"/>
+
+        <receiver
+            android:name="org.microg.gms.gcm.GcmRegistrationReceiver"
+            android:exported="false"
+            android:process=":persistent">
+            <intent-filter>
+                <action android:name="org.microg.gms.gcm.REGISTERED" />
+                <action android:name="org.microg.gms.gcm.REGISTER_ACCOUNT" />
+                <action android:name="org.microg.gms.gcm.NOTIFY_COMPLETE" />
+
+                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
+            </intent-filter>
+        </receiver>
+
+        <receiver
+            android:name="org.microg.gms.gcm.SendReceiver"
+            android:process=":persistent">
+            <intent-filter>
+                <action android:name="com.google.android.gcm.intent.SEND" />
+            </intent-filter>
+        </receiver>
+
+        <receiver
+            android:name="org.microg.gms.gcm.ServiceInfoReceiver"
+            android:process=":persistent" />
+
+        <receiver
+            android:name="org.microg.gms.gcm.TriggerReceiver"
+            android:process=":persistent">
+            <intent-filter>
+                <action android:name="android.intent.action.BOOT_COMPLETED" />
+                <action android:name="android.intent.action.AIRPLANE_MODE" />
+                <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
+                <action android:name="android.net.conn.BACKGROUND_DATA_SETTING_CHANGED" />
+
+                <action android:name="org.microg.gms.gcm.RECONNECT" />
+
+                <action android:name="android.intent.action.MY_PACKAGE_REPLACED" />
+                <action android:name="android.intent.action.PACKAGE_RESTARTED" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.provider.Telephony.SECRET_CODE" />
+
+                <data
+                    android:host="42678278"
+                    android:scheme="android_secret_code" />
+            </intent-filter>
+        </receiver>
+
+        <receiver
+            android:name="org.microg.gms.gcm.UnregisterReceiver"
+            android:process=":persistent">
+            <intent-filter>
+                <action android:name="android.intent.action.PACKAGE_DATA_CLEARED" />
+                <action android:name="android.intent.action.PACKAGE_FULLY_REMOVED" />
+                <action android:name="android.intent.action.PACKAGE_REMOVED" />
+
+                <data android:scheme="package" />
+            </intent-filter>
+        </receiver>
+
+        <!-- Car -->
+
+        <service android:name="org.microg.gms.car.CarService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.car.service.START" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <!-- People -->
+
+        <service android:name="org.microg.gms.people.PeopleService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.people.service.START" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service
+            android:name="org.microg.gms.people.ContactSyncService"
+            android:exported="false">
+            <intent-filter>
+                <action android:name="android.content.SyncAdapter" />
+            </intent-filter>
+            <meta-data
+                android:name="android.content.SyncAdapter"
+                android:resource="@xml/contact_syncadapter" />
+        </service>
+
+        <!-- Wearable -->
+
+        <service android:name="org.microg.gms.wearable.WearableService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.wearable.BIND" />
+            </intent-filter>
+        </service>
+
+        <activity
+            android:name="com.google.android.gms.wearable.consent.TermsOfServiceActivity"
+            android:process=":ui"
+            android:configChanges="screenSize|orientation|keyboardHidden">
+            <intent-filter>
+                <action android:name="com.google.android.gms.wearable.TOS"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <!-- Auth -->
+
+        <service android:name="org.microg.gms.auth.loginservice.GoogleLoginService">
+            <intent-filter>
+                <action android:name="android.accounts.AccountAuthenticator" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="com.google.android.gsf.action.GET_GLS" />
+            </intent-filter>
+
+            <meta-data
+                android:name="android.accounts.AccountAuthenticator"
+                android:resource="@xml/authenticator" />
+            <meta-data
+                android:name="android.accounts.AccountAuthenticator.customTokens"
+                android:value="1" />
+        </service>
+
+        <activity
+            android:name="org.microg.tools.AccountPickerActivity"
+            android:excludeFromRecents="true"
+            android:exported="true"
+            android:process=":ui"
+            android:theme="@style/Theme.App.DayNight.Dialog.Alert.NoActionBar">
+            <intent-filter>
+                <action android:name="com.google.android.gms.common.account.CHOOSE_ACCOUNT" />
+                <action android:name="com.google.android.gms.common.account.CHOOSE_ACCOUNT_USERTILE"/>
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="org.microg.gms.auth.login.LoginActivity"
+            android:configChanges="keyboardHidden|keyboard|orientation|screenSize"
+            android:exported="true"
+            android:process=":ui"
+            android:launchMode="singleTask"
+            android:theme="@style/Theme.LoginBlue">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.login.LOGIN" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="org.microg.gms.auth.AskPermissionActivity"
+            android:excludeFromRecents="true"
+            android:exported="true"
+            android:process=":ui"
+            android:theme="@style/Theme.AppCompat.DayNight.Dialog" />
+
+        <activity
+            android:name="org.microg.gms.auth.AskPackageOverrideActivity"
+            android:excludeFromRecents="true"
+            android:exported="true"
+            android:process=":ui"
+            android:theme="@style/Theme.App.Translucent" />
+
+        <service
+            android:name=".auth.GetToken"
+            android:exported="true" />
+
+        <activity
+            android:name=".auth.TokenActivity"
+            android:exported="true"
+            android:process=":ui" />
+
+        <provider
+            android:name="org.microg.gms.auth.AccountContentProvider"
+            android:authorities="com.google.android.gms.auth.accounts"
+            android:exported="true" />
+
+        <activity
+            android:name="org.microg.gms.auth.credentials.CredentialPickerActivity"
+            android:process=":ui">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.api.credentials.PICKER" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <service android:name="org.microg.gms.auth.credentials.CredentialsService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.api.credentials.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.auth.proxy.AuthProxyService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.auth.appcert.AppCertService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.be.appcert.AppCertService" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.credential.CredentialManagerService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.credential.manager.service.firstparty.START" />
+            </intent-filter>
+        </service>
+
+        <activity
+            android:name="org.microg.gms.auth.signin.AuthSignInActivity"
+            android:theme="@style/Theme.App.DayNight.Dialog.Alert.NoActionBar"
+            android:process=":ui"
+            android:configChanges="keyboardHidden|keyboard|orientation|screenSize"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.GOOGLE_SIGN_IN" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <service android:name=".locationsharingreporter.service.LocationSharingReporterApiService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.locationsharingreporter.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.signin.SignInService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.signin.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.auth.signin.AuthSignInService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.api.signin.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service
+            android:name="org.microg.gms.auth.signin.SignInConfigurationService"
+            android:exported="false" />
+
+        <service android:name="org.microg.gms.auth.credentials.identity.AuthorizationService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.api.identity.service.authorization.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.auth.credentials.identity.IdentitySignInService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.api.identity.service.signin.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.auth.folsom.KeyRetrievalService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.key.retrieval.service.START" />
+            </intent-filter>
+        </service>
+
+        <activity android:name="org.microg.gms.auth.folsom.ui.GenericActivity"
+            android:exported="false"
+            android:process=":ui"/>
+
+        <activity
+            android:name="org.microg.gms.auth.credentials.identity.IdentityFidoProxyActivity"
+            android:exported="false"
+            android:process=":ui"
+            android:theme="@style/Theme.App.Translucent"
+            android:excludeFromRecents="true"/>
+
+        <activity
+            android:theme="@style/Theme.AppCompat.Dialog.Alert"
+            android:name="org.microg.gms.auth.signin.AssistedSignInActivity"
+            android:enabled="true"
+            android:exported="true"
+            android:process=":ui"
+            android:configChanges="keyboardHidden|keyboard|orientation|screenSize|smallestScreenSize|layoutDirection"
+            android:launchMode="singleTask"
+            android:excludeFromRecents="false">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.api.credentials.ASSISTED_SIGNIN"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="org.microg.gms.auth.consent.ConsentSignInActivity"
+            android:process=":ui"
+            android:exported="false"
+            android:excludeFromRecents="true"
+            android:configChanges="keyboardHidden|keyboard|orientation|screenSize"
+            android:theme="@style/Theme.AppCompat.DayNight.Dialog"/>
+
+        <activity
+            android:name="org.microg.gms.accountaction.AccountActionActivity"
+            android:exported="true"
+            android:theme="@style/Theme.LoginBlue"/>
+
+        <!-- Games -->
+
+        <activity
+            android:name="org.microg.gms.games.ui.GamePlayDataActivity"
+            android:process=":ui"
+            android:exported="false"
+            android:theme="@style/Theme.AppCompat.Light.NoActionBar"/>
+
+        <activity
+            android:name="org.microg.gms.games.ui.InGameUiActivity"
+            android:process=":ui"
+            android:configChanges="keyboardHidden|keyboard|orientation|screenSize|smallestScreenSize|layoutDirection"
+            android:excludeFromRecents="false"
+            android:exported="true"
+            android:launchMode="singleTask"
+            android:theme="@style/Theme.AppCompat.Dialog.Alert">
+            <intent-filter>
+                <action android:name="com.google.android.gms.games.SHOW_SELECT_SNAPSHOT"/>
+                <action android:name="com.google.android.gms.games.VIEW_ACHIEVEMENTS" />
+                <action android:name="com.google.android.gms.games.VIEW_LEADERBOARDS" />
+                <action android:name="com.google.android.gms.games.VIEW_LEADERBOARD_SCORES" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="org.microg.gms.games.GamesSignInActivity"
+            android:enabled="true"
+            android:exported="false"
+            android:process=":ui"
+            android:configChanges="keyboardHidden|keyboard|orientation|screenSize"
+            android:theme="@style/Theme.App.Translucent"/>
+
+        <activity
+            android:name="org.microg.gms.games.UpgradeActivity"
+            android:process=":ui"
+            android:theme="@style/Theme.AppCompat.DayNight.Dialog">
+            <intent-filter>
+                <action android:name="com.google.android.gms.games.PLAY_GAMES_UPGRADE" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <service
+            android:name="org.microg.gms.games.GamesService"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.games.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service
+            android:name="org.microg.gms.games.GamesConnectService"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.games.internal.connect.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service
+            android:name="org.microg.gms.games.GamesConfigurationService"
+            android:exported="false" />
+
+        <!-- Chimera -->
+        <provider
+            android:name="org.microg.gms.chimera.ServiceProvider"
+            android:authorities="com.google.android.gms.chimera"
+            android:exported="true" />
+
+        <!-- Fonts -->
+        <provider
+            android:name="org.microg.gms.fonts.FontsProvider"
+            android:authorities="com.google.android.gms.fonts"
+            android:exported="true" />
+
+        <!-- microG Settings activity -->
+        <activity
+            android:name="org.microg.gms.ui.MainSettingsActivity"
+            android:exported="true"
+            android:icon="@mipmap/ic_app_settings"
+            android:label="@string/gms_settings_name"
+            android:process=":ui"
+            android:roundIcon="@mipmap/ic_app_settings"
+            android:taskAffinity="org.microg.gms.settings">
+            <intent-filter>
+                <action android:name="android.intent.action.VIEW" />
+                <data android:scheme="x-gms-settings" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.intent.action.APPLICATION_PREFERENCES" />
+                <action android:name="com.google.android.gms.settings.EXPOSURE_NOTIFICATION_SETTINGS" />
+                <action android:name="org.microg.gms.settings.CHECKIN_SETTINGS" />
+                <action android:name="org.microg.gms.settings.GCM_SETTINGS" />
+                <action android:name="org.microg.gms.settings.MICROG_APP_GCM_SETTINGS" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <!-- microG Settings activity-alias shown in Launcher -->
+        <activity-alias
+            android:name="org.microg.gms.ui.SettingsActivity"
+            android:icon="@mipmap/ic_app_settings"
+            android:label="@string/gms_settings_name"
+            android:roundIcon="@mipmap/ic_app_settings"
+            android:process=":ui"
+            android:targetActivity="org.microg.gms.ui.MainSettingsActivity"
+            android:taskAffinity="org.microg.gms.settings">
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+
+                <category android:name="android.intent.category.LAUNCHER" />
+            </intent-filter>
+        </activity-alias>
+
+        <activity
+            android:name="org.microg.gms.ui.SettingsDashboardActivity"
+            android:icon="@mipmap/ic_app_settings"
+            android:label="Legacy microG Settings"
+            android:process=":ui"
+            android:roundIcon="@mipmap/ic_app_settings"
+            android:taskAffinity="org.microg.gms.settings" />
+
+        <!-- microG Settings embedded in System Settings on SDK 23 and newer -->
+        <activity-alias
+            android:name="org.microg.gms.ui.SettingsActivityLink"
+            android:icon="@mipmap/ic_app_settings"
+            android:label="@string/gms_settings_name"
+            android:process=":ui"
+            android:targetActivity="org.microg.gms.ui.MainSettingsActivity"
+            android:taskAffinity="org.microg.gms.settings">
+            <intent-filter>
+                <action android:name="com.android.settings.action.EXTRA_SETTINGS" />
+            </intent-filter>
+
+            <meta-data
+                android:name="com.android.settings.category"
+                android:value="com.android.settings.category.device" />
+            <meta-data
+                android:name="com.android.settings.icon"
+                android:resource="@drawable/ic_app_settings_system" />
+            <meta-data
+                android:name="com.android.settings.summary"
+                android:resource="@string/gms_settings_summary" />
+        </activity-alias>
+
+        <!-- microG Settings activity-alias for Google settings compatibility -->
+        <activity-alias
+            android:name="com.google.android.gms.app.settings.GoogleSettingsLink"
+            android:process=":ui"
+            android:exported="true"
+            android:targetActivity="org.microg.gms.ui.MainSettingsActivity"
+            android:taskAffinity="org.microg.gms.settings">
+        </activity-alias>
+
+        <activity
+            android:name="org.microg.gms.ui.AskPushPermission"
+            android:excludeFromRecents="true"
+            android:process=":ui"
+            android:theme="@style/Theme.App.Translucent" />
+
+        <activity
+            android:name="org.microg.gms.ui.GoogleMoreFragment$AsActivity"
+            android:label="@string/gms_settings_name"
+            android:process=":ui"
+            android:taskAffinity="org.microg.gms.settings" />
+
+        <activity
+            android:name="org.microg.gms.ui.SelfCheckFragment$AsActivity"
+            android:label="@string/self_check_title"
+            android:process=":ui"
+            android:taskAffinity="org.microg.gms.settings" />
+
+        <activity
+            android:name="org.microg.gms.accountsettings.ui.MainActivity"
+            android:process=":ui"
+            android:exported="false"
+            android:taskAffinity="org.microg.gms.settings"
+            android:theme="@style/Theme.AppCompat.Light.NoActionBar">
+            <intent-filter>
+                <action android:name="com.google.android.gms.accountsettings.MY_ACCOUNT" />
+                <action android:name="com.google.android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS" />
+                <action android:name="com.google.android.gms.accountsettings.PRIVACY_SETTINGS" />
+                <action android:name="com.google.android.gms.accountsettings.SECURITY_SETTINGS" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="org.microg.gms.accountsettings.ui.LoaderActivity"
+            android:process=":ui"
+            android:exported="true"
+            android:excludeFromRecents="true"
+            android:theme="@style/Theme.App.DayNight.Dialog.Alert.NoActionBar">
+            <intent-filter>
+                <action android:name="com.google.android.gms.accountsettings.action.VIEW_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="com.google.android.gms.accountsettings.action.BROWSE_SETTINGS" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.BROWSABLE" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="com.google.android.gms.location.settings.LOCATION_SHARING"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="org.microg.gms.ui.LocationSettingsActivity"
+            android:process=":ui"
+            android:taskAffinity="org.microg.gms.settings">
+            <intent-filter>
+                <action android:name="com.google.android.location.settings.LOCATION_REPORTING_SETTINGS" />
+                <action android:name="com.google.android.gms.location.settings.LOCATION_REPORTING_SETTINGS" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <!-- Phenotype -->
+
+        <provider
+            android:name="org.microg.gms.phenotype.ConfigurationProvider"
+            android:authorities="com.google.android.gms.phenotype"
+            android:exported="true" />
+
+        <service android:name="org.microg.gms.phenotype.PhenotypeService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.phenotype.service.START" />
+            </intent-filter>
+        </service>
+
+        <!-- Help -->
+
+        <service
+            android:name="org.microg.gms.googlehelp.GoogleHelpService"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.googlehelp.service.GoogleHelpService.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <activity
+            android:name="org.microg.gms.googlehelp.ui.GoogleHelpRedirectActivity"
+            android:theme="@style/Theme.App.Translucent"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.googlehelp.HELP" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+
+            <intent-filter>
+                <action android:name="android.intent.action.SEARCH" />
+            </intent-filter>
+        </activity>
+
+        <!-- PoToken -->
+
+        <service android:name="org.microg.gms.potokens.PoTokensService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.potokens.service.START" />
+            </intent-filter>
+        </service>
+
+        <!-- backup -->
+
+        <activity
+            android:name="org.microg.gms.backup.BackupSettingsActivity"
+            android:theme="@android:style/Theme.Translucent.NoTitleBar"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.backup.ACTION_BACKUP_SETTINGS"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <!-- Other -->
+
+        <service
+            android:name="org.microg.gms.measurement.MeasurementService"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.measurement.START" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+        <service
+            android:name="org.microg.gms.languageprofile.LanguageProfileService"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.languageprofile.service.START" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+        <service android:name="org.microg.gms.mdm.NetworkQualityService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.mdm.services.START" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+        <service android:name="org.microg.gms.icing.LightweightIndexService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.icing.LIGHTWEIGHT_INDEX_SERVICE" />
+            </intent-filter>
+        </service>
+        <service android:name="org.microg.gms.icing.IndexService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.icing.INDEX_SERVICE" />
+            </intent-filter>
+        </service>
+        <service
+            android:name=".analytics.service.AnalyticsService"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.analytics.service.START" />
+            </intent-filter>
+        </service>
+        <service android:name="org.microg.gms.playlog.PlayLogService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.playlog.service.START" />
+            </intent-filter>
+        </service>
+        <service
+            android:name=".gcm.http.GoogleHttpService"
+            android:exported="true" />
+
+        <service android:name="org.microg.gms.ads.GService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.ads.gservice.START" />
+            </intent-filter>
+        </service>
+
+        <!-- family -->
+
+        <activity
+            android:name="com.google.android.gms.family.v2.manage.FamilyManagementActivity"
+            android:exported="true"
+            android:configChanges="screenSize|screenLayout|orientation"
+            android:process=":ui">
+            <intent-filter>
+                <action android:name="com.google.android.gms.family.v2.MANAGE"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <activity
+            android:name="com.google.android.gms.family.v2.manage.DeleteMemberActivity"
+            android:exported="true"
+            android:configChanges="screenSize|screenLayout|orientation"
+            android:process=":ui">
+            <intent-filter>
+                <action android:name="com.google.android.gms.family.v2.DELETE_MEMBER"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <!-- feedback -->
+
+        <service android:name="org.microg.gms.feedback.FeedbackService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.feedback.internal.IFeedbackService" />
+            </intent-filter>
+        </service>
+
+        <activity
+            android:name="com.google.android.gms.feedback.FeedbackActivity"
+            android:exported="true"
+            android:excludeFromRecents="true"
+            android:theme="@style/Theme.App.Translucent"/>
+
+        <activity
+            android:name="com.google.android.gms.credential.manager.PasswordManagerActivity"
+            android:exported="true"
+            android:process=":ui"
+            android:excludeFromRecents="true"
+            android:theme="@style/Theme.Translucent"/>
+
+        <service android:name="org.microg.gms.clearcut.ClearcutLoggerService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.clearcut.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+        <service android:name="org.microg.gms.drive.api.DriveApiService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.drive.ApiService.START" />
+                <action android:name="com.google.android.gms.drive.ApiService.STOP" />
+                <action android:name="com.google.android.gms.drive.ApiService.RESET_AFTER_BOOT" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+        <service android:name="org.microg.gms.reminders.RemindersService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.reminders.service.START" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.wallet.PaymentService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.wallet.service.BIND" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.firebase.dynamiclinks.DynamicLinksService">
+            <intent-filter>
+                <action android:name="com.google.firebase.dynamiclinks.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.udc.FacsCacheService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.facs.cache.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.usagereporting.UsageReportingService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.usagereporting.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.pseudonymous.PseudonymousIdService" >
+            <intent-filter>
+                <action android:name="com.google.android.gms.pseudonymous.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.gass.GassService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.gass.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.auth.account.data.AccountDataService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.auth.account.data.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name=".semanticlocation.SemanticLocationService" android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.semanticlocation.service.START_ODLH" />
+            </intent-filter>
+        </service>
+
+        <service android:name=".semanticlocationhistory.SemanticLocationHistoryService" android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.semanticlocationhistory.service.START" />
+            </intent-filter>
+        </service>
+
+        <activity
+            android:name="com.google.android.location.settings.LocationHistorySettingsActivity"
+            android:theme="@android:style/Theme.Translucent.NoTitleBar"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="com.google.android.gms.location.settings.LOCATION_HISTORY"/>
+                <category android:name="android.intent.category.DEFAULT"/>
+            </intent-filter>
+        </activity>
+
+        <service android:name="org.microg.gms.audit.AuditService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.audit.service.START" />
+            </intent-filter>
+        </service>
+
+        <service android:name="org.microg.gms.common.ClientTelemetryService">
+            <intent-filter>
+                <action android:name="com.google.android.gms.common.telemetry.service.START" />
+            </intent-filter>
+        </service>
+
+        <activity
+            android:name="org.microg.gms.mlkit.BarcodeScanningActivity"
+            android:exported="true"
+            android:process=":ui"
+            android:excludeFromRecents="true"
+            android:theme="@style/Theme.AppCompat.DayNight.NoActionBar">
+            <intent-filter>
+                <action android:name="com.google.android.gms.mlkit.ACTION_SCAN_BARCODE" />
+
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <service
+            android:name="com.google.android.gms.maps.auth.ApiTokenService"
+            android:exported="true"/>
+
+        <service android:name="org.microg.gms.DummyService">
+            <intent-filter>
+                <action android:name="com.google.android.contextmanager.service.ContextManagerService.START" />
+                <action android:name="com.google.android.gms.accounts.ACCOUNT_SERVICE" />
+                <action android:name="com.google.android.gms.ads.identifier.service.EVENT_ATTESTATION" />
+                <action android:name="com.google.android.gms.ads.service.CACHE" />
+                <action android:name="com.google.android.gms.ads.service.CONSENT_LOOKUP" />
+                <action android:name="com.google.android.gms.ads.service.HTTP" />
+                <action android:name="com.google.android.gms.appstate.service.START" />
+                <action android:name="com.google.android.gms.appusage.service.START" />
+                <action android:name="com.google.android.gms.asterism.service.START" />
+                <action android:name="com.google.android.gms.audiomodem.service.AudioModemService.START" />
+                <action android:name="com.google.android.gms.auth.account.authapi.START" />
+                <action android:name="com.google.android.gms.auth.account.authenticator.auto.service.START" />
+                <action android:name="com.google.android.gms.auth.account.authenticator.chromeos.START" />
+                <action android:name="com.google.android.gms.auth.account.authenticator.tv.service.START" />
+                <action android:name="com.google.android.gms.auth.api.identity.service.credentialsaving.START" />
+                <action android:name="com.google.android.gms.auth.api.phone.service.InternalService.START" />
+                <action android:name="com.google.android.gms.auth.api.signin.service.START" />
+                <action android:name="com.google.android.gms.auth.config.service.START" />
+                <action android:name="com.google.android.gms.auth.cryptauth.cryptauthservice.START" />
+                <action android:name="com.google.android.gms.auth.proximity.devicesyncservice.START" />
+                <action android:name="com.google.android.gms.auth.proximity.securechannelservice.START" />
+                <action android:name="com.google.android.gms.auth.proximity.START" />
+                <action android:name="com.google.android.gms.auth.service.START" />
+                <action android:name="com.google.android.gms.backup.G1_BACKUP" />
+                <action android:name="com.google.android.gms.backup.G1_RESTORE" />
+                <action android:name="com.google.android.gms.backup.GMS_MODULE_RESTORE" />
+                <action android:name="com.google.android.gms.beacon.internal.IBleService.START" />
+                <action android:name="com.google.android.gms.carrierauth.service.START" />
+                <action android:name="com.google.android.gms.cast.firstparty.START" />
+                <action android:name="com.google.android.gms.cast_mirroring.service.START" />
+                <action android:name="com.google.android.gms.cast.remote_display.service.START" />
+                <action android:name="com.google.android.gms.chromesync.service.START" />
+                <action android:name="com.google.android.gms.common.download.START" />
+                <action android:name="com.google.android.gms.common.service.START" />
+                <action android:name="com.google.android.gms.config.START" />
+                <action android:name="com.google.android.gms.constellation.service.START" />
+                <action android:name="com.google.android.gms.deviceconnection.service.START" />
+                <action android:name="com.google.android.gms.enterprise.loader.service.START" />
+                <action android:name="com.google.android.gms.facs.internal.service.START" />
+                <action android:name="com.google.android.gms.fido.credentialstore.internal_service.START" />
+                <action android:name="com.google.android.gms.fido.fido2.regular.START" />
+                <action android:name="com.google.android.gms.fido.fido2.zeroparty.START" />
+                <action android:name="com.google.android.gms.fido.sourcedevice.service.START" />
+                <action android:name="com.google.android.gms.fido.targetdevice.internal_service.START" />
+                <action android:name="com.google.android.gms.fido.u2f.privileged.START" />
+                <action android:name="com.google.android.gms.fido.u2f.thirdparty.START" />
+                <action android:name="com.google.android.gms.fido.u2f.zeroparty.START" />
+                <action android:name="com.google.android.gms.fitness.BleApi" />
+                <action android:name="com.google.android.gms.fitness.GoalsApi" />
+                <action android:name="com.google.android.gms.fitness.GoogleFitnessService.START" />
+                <action android:name="com.google.android.gms.fitness.InternalApi" />
+                <action android:name="com.google.android.gms.fitness.SensorsApi" />
+                <action android:name="com.google.android.gms.fonts.service.START" />
+                <action android:name="com.google.android.gms.freighter.service.START" />
+                <action android:name="com.google.android.gms.growth.service.START" />
+                <action android:name="com.google.android.gms.googlehelp.service.GoogleHelpService.START" />
+                <action android:name="com.google.android.gms.herrevad.services.LightweightNetworkQualityAndroidService.START" />
+                <action android:name="com.google.android.gms.identity.service.BIND" />
+                <action android:name="com.google.android.gms.inappreach.service.START"/>
+                <action android:name="com.google.android.gms.instantapps.START" />
+                <action android:name="com.google.android.gms.kids.service.START" />
+                <action android:name="com.google.android.gms.learning.internal.dynamitesupport.START" />
+                <action android:name="com.google.android.gms.learning.intservice.START" />
+                <action android:name="com.google.android.gms.learning.predictor.START" />
+                <action android:name="com.google.android.gms.learning.trainer.START" />
+                <action android:name="com.google.android.gms.learning.training.background.START" />
+                <action android:name="com.google.android.gms.locationsharing.api.START" />
+                <action android:name="com.google.android.gms.locationsharingreporter.service.START" />
+                <action android:name="com.google.android.gms.lockbox.service.START" />
+                <action android:name="com.google.android.gms.matchstick.lighter.service.START" />
+                <action android:name="com.google.android.gms.mdm.services.DeviceManagerApiService.START" />
+                <action android:name="com.google.android.gms.mdns.service.START" />
+                <action android:name="com.google.android.gms.nearby.bootstrap.service.NearbyBootstrapService.START" />
+                <action android:name="com.google.android.gms.nearby.connection.service.START" />
+                <action android:name="com.google.android.gms.nearby.fastpair.START" />
+                <action android:name="com.google.android.gms.nearby.messages.service.NearbyMessagesService.START" />
+                <action android:name="com.google.android.gms.nearby.sharing.service.NearbySharingService.START" />
+                <action android:name="com.google.android.gms.nearby.sharing.START_SERVICE" />
+                <action android:name="com.google.android.gms.notifications.service.START" />
+                <action android:name="com.google.android.gms.ocr.service.internal.START" />
+                <action android:name="com.google.android.gms.ocr.service.START" />
+                <action android:name="com.google.android.gms.payse.service.BIND" />
+                <action android:name="com.google.android.gms.people.contactssync.service.START" />
+                <action android:name="com.google.android.gms.photos.autobackup.service.START" />
+                <action android:name="com.google.android.gms.plus.service.default.INTENT" />
+                <action android:name="com.google.android.gms.plus.service.image.INTENT" />
+                <action android:name="com.google.android.gms.plus.service.internal.START" />
+                <action android:name="com.google.android.gms.plus.service.START" />
+                <action android:name="com.google.android.gms.rcs.START" />
+                <action android:name="com.google.android.gms.romanesco.MODULE_BACKUP_AGENT" />
+                <action android:name="com.google.android.gms.romanesco.service.START" />
+                <action android:name="com.google.android.gms.search.service.SEARCH_AUTH_START" />
+                <action android:name="com.google.android.gms.sesame.service.BIND" />
+                <action android:name="com.google.android.gms.telephonyspam.service.START" />
+                <action android:name="com.google.android.gms.testsupport.service.START" />
+                <action android:name="com.google.android.gms.scheduler.ACTION_PROXY_SCHEDULE" />
+                <action android:name="com.google.android.gms.setup.auth.SecondDeviceAuth.START" />
+                <action android:name="com.google.android.gms.smartdevice.d2d.SourceDeviceService.START" />
+                <action android:name="com.google.android.gms.smartdevice.d2d.TargetDeviceService.START" />
+                <action android:name="com.google.android.gms.smartdevice.directtransfer.SourceDirectTransferService.START" />
+                <action android:name="com.google.android.gms.smartdevice.directtransfer.TargetDirectTransferService.START" />
+                <action android:name="com.google.android.gms.smartdevice.postsetup.PostSetupService.START" />
+                <action android:name="com.google.android.gms.smartdevice.setup.accounts.AccountsService.START" />
+                <action android:name="com.google.android.gms.smartdevice.wifi.START_WIFI_HELPER_SERVICE" />
+                <action android:name="com.google.android.gms.social.location.activity.service.START" />
+                <action android:name="com.google.android.gms.statementservice.EXECUTE" />
+                <action android:name="com.google.android.gms.stats.ACTION_UPLOAD_DROPBOX_ENTRIES" />
+                <action android:name="com.google.android.gms.speech.service.START" />
+                <action android:name="com.google.android.gms.thunderbird.service.START" />
+                <action android:name="com.google.android.gms.trustagent.BridgeApi.START" />
+                <action android:name="com.google.android.gms.trustagent.StateApi.START" />
+                <action android:name="com.google.android.gms.trustagent.trustlet.trustletmanagerservice.BIND" />
+                <action android:name="com.google.android.gms.trustlet.bluetooth.service.BIND" />
+                <action android:name="com.google.android.gms.trustlet.connectionlessble.service.BIND" />
+                <action android:name="com.google.android.gms.trustlet.face.service.BIND" />
+                <action android:name="com.google.android.gms.trustlet.nfc.service.BIND" />
+                <action android:name="com.google.android.gms.trustlet.onbody.service.BIND" />
+                <action android:name="com.google.android.gms.trustlet.place.service.BIND" />
+                <action android:name="com.google.android.gms.trustlet.voiceunlock.service.BIND" />
+                <action android:name="com.google.android.gms.udc.service.START" />
+                <action android:name="com.google.android.gms.update.START_API_SERVICE" />
+                <action android:name="com.google.android.gms.update.START_SERVICE" />
+                <action android:name="com.google.android.gms.update.START_SINGLE_USER_API_SERVICE" />
+                <action android:name="com.google.android.gms.update.START_TV_API_SERVICE" />
+                <action android:name="com.google.android.gms.userlocation.service.START" />
+                <action android:name="com.google.android.gms.vehicle.cabin.service.START" />
+                <action android:name="com.google.android.gms.vehicle.climate.service.START" />
+                <action android:name="com.google.android.gms.vehicle.info.service.START" />
+                <action android:name="com.google.android.gms.walletp2p.service.firstparty.BIND" />
+                <action android:name="com.google.android.gms.walletp2p.service.zeroparty.BIND" />
+                <action android:name="com.google.android.gms.wearable.BIND" />
+                <action android:name="com.google.android.gms.wearable.DATA_CHANGED" />
+                <action android:name="com.google.android.gms.wearable.NODE_CHANGED" />
+                <action android:name="com.google.android.mdd.service.START" />
+                <action android:name="com.google.android.mdh.service.START" />
+                <action android:name="com.google.android.mdh.service.listener.START" />
+                <action android:name="com.google.android.mobstore.service.START" />
+
+                <action
+                    android:name="com.google.android.gms.wearable.BIND_LISTENER"
+                    tools:ignore="WearableBindListener" />
+            </intent-filter>
+        </service>
+    </application>
+
+</manifest>
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java input/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java
--- inputbak/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java	2026-01-01 18:27:34.269989921 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java	2026-01-01 18:28:05.489989909 +0300
@@ -17,6 +17,8 @@
 import org.microg.gms.accountaction.ErrorResolverKt;
 import org.microg.gms.accountaction.Resolution;
 import org.microg.gms.common.NotOkayException;
+import com.google.android.gms.base.BuildConfig;
+import org.microg.gms.common.PackageSpoofUtils;
 import org.microg.gms.common.PackageUtils;
 import org.microg.gms.settings.SettingsContract;
 
@@ -32,7 +34,7 @@
 public class AuthManager {
 
     private static final String TAG = "GmsAuthManager";
-    public static final String PERMISSION_TREE_BASE = "com.google.android.googleapps.permission.GOOGLE_AUTH.";
+    public static final String PERMISSION_TREE_BASE = BuildConfig.BASE_PACKAGE_NAME + ".android.googleapps.permission.GOOGLE_AUTH.";
     public static final String PREF_AUTH_VISIBLE = SettingsContract.Auth.VISIBLE;
     public static final int ONE_HOUR_IN_SECONDS = 60 * 60;
     public Map<Object, Object> dynamicFields = new HashMap<>();
@@ -330,7 +332,10 @@
         }
         AuthRequest request = new AuthRequest().fromContext(context)
                 .source("android")
-                .app(packageName, getPackageSignature())
+                .app(
+                        PackageSpoofUtils.spoofPackageName(context.getPackageManager(), packageName),
+                        PackageSpoofUtils.spoofStringSignature(context.getPackageManager(), packageName, getPackageSignature())
+                )
                 .email(accountName)
                 .token(getAccountManager().getPassword(getAccount()))
                 .service(service)
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java.orig input/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java.orig
--- inputbak/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/auth/AuthManager.java.orig	2026-01-01 18:27:15.709989928 +0300
@@ -0,0 +1,367 @@
+/*
+ * SPDX-FileCopyrightText: 2023 microG Project Team
+ * SPDX-License-Identifier: Apache-2.0
+ */
+
+package org.microg.gms.auth;
+
+import android.accounts.Account;
+import android.accounts.AccountManager;
+import android.annotation.SuppressLint;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.net.Uri;
+import android.util.Log;
+
+import androidx.annotation.NonNull;
+import org.microg.gms.accountaction.ErrorResolverKt;
+import org.microg.gms.accountaction.Resolution;
+import org.microg.gms.common.NotOkayException;
+import org.microg.gms.common.PackageUtils;
+import org.microg.gms.settings.SettingsContract;
+
+import java.io.IOException;
+import java.util.HashMap;
+import java.util.Map;
+
+import static android.content.pm.ApplicationInfo.FLAG_SYSTEM;
+import static android.content.pm.ApplicationInfo.FLAG_UPDATED_SYSTEM_APP;
+import static android.os.Build.VERSION.SDK_INT;
+import static org.microg.gms.auth.AuthPrefs.isTrustGooglePermitted;
+
+public class AuthManager {
+
+    private static final String TAG = "GmsAuthManager";
+    public static final String PERMISSION_TREE_BASE = "com.google.android.googleapps.permission.GOOGLE_AUTH.";
+    public static final String PREF_AUTH_VISIBLE = SettingsContract.Auth.VISIBLE;
+    public static final int ONE_HOUR_IN_SECONDS = 60 * 60;
+    public Map<Object, Object> dynamicFields = new HashMap<>();
+    private final Context context;
+    private final String accountName;
+    private final String packageName;
+    private final String service;
+    private AccountManager accountManager;
+    private Account account;
+    private String packageSignature;
+    private String accountType;
+
+
+    private int delegationType;
+    private String delegateeUserId;
+    private String oauth2Foreground;
+    private String oauth2Prompt;
+    private String itCaveatTypes;
+    private String tokenRequestOptions;
+    public String includeEmail;
+    public String includeProfile;
+    public boolean isGmsApp;
+    public boolean ignoreStoredPermission = false;
+    public boolean forceRefreshToken = false;
+
+    public AuthManager(Context context, String accountName, String packageName, String service) {
+        this.context = context;
+        this.accountName = accountName;
+        this.packageName = packageName;
+        this.service = service;
+    }
+
+    public String getAccountType() {
+        if (accountType == null)
+            accountType = AuthConstants.DEFAULT_ACCOUNT_TYPE;
+        return accountType;
+    }
+
+    public AccountManager getAccountManager() {
+        if (accountManager == null)
+            accountManager = AccountManager.get(context);
+        return accountManager;
+    }
+
+    public Account getAccount() {
+        if (account == null)
+            account = new Account(accountName, getAccountType());
+        return account;
+    }
+
+    public void setPackageSignature(String packageSignature) {
+        this.packageSignature = packageSignature;
+    }
+
+    public String getPackageSignature() {
+        if (packageSignature == null)
+            packageSignature = PackageUtils.firstSignatureDigest(context, packageName);
+        return packageSignature;
+    }
+
+    public String buildTokenKey(String service) {
+        Uri.Builder builder = Uri.EMPTY.buildUpon();
+        if (delegationType != 0 && delegateeUserId != null)
+            builder.appendQueryParameter("delegation_type", Integer.toString(delegationType))
+                    .appendQueryParameter("delegatee_user_id", delegateeUserId);
+        if (tokenRequestOptions != null) builder.appendQueryParameter("token_request_options", tokenRequestOptions);
+        if (includeEmail != null) builder.appendQueryParameter("include_email", includeEmail);
+        if (includeProfile != null) builder.appendQueryParameter("include_profile", includeEmail);
+        String query = builder.build().getEncodedQuery();
+        return packageName + ":" + getPackageSignature() + ":" + service + (query != null ? ("?" + query) : "");
+    }
+
+    public String buildTokenKey() {
+        return buildTokenKey(service);
+    }
+
+    public String buildPermKey() {
+        return "perm." + buildTokenKey();
+    }
+
+    public void setPermitted(boolean value) {
+        setUserData(buildPermKey(), value ? "1" : "0");
+        if (SDK_INT >= 26 && value && packageName != null) {
+            // Make account persistently visible as we already granted access
+            accountManager.setAccountVisibility(getAccount(), packageName, AccountManager.VISIBILITY_VISIBLE);
+        }
+    }
+
+    public boolean isPermitted() {
+        if (!service.startsWith("oauth")) {
+            if (context.getPackageManager().checkPermission(PERMISSION_TREE_BASE + service, packageName) == PackageManager.PERMISSION_GRANTED) {
+                return true;
+            }
+        }
+        String perm = getUserData(buildPermKey());
+        if (!"1".equals(perm)) {
+            return false;
+        }
+        return true;
+    }
+
+    public void setExpiry(long expiry) {
+        setUserData(buildExpireKey(), Long.toString(expiry));
+    }
+
+    public String getUserData(String key) {
+        return getAccountManager().getUserData(getAccount(), key);
+    }
+
+    public void setUserData(String key, String value) {
+        getAccountManager().setUserData(getAccount(), key, value);
+    }
+
+    public void setDelegation(int delegationType, String delegateeUserId) {
+        if (delegationType != 0 && delegateeUserId != null) {
+            this.delegationType = delegationType;
+            this.delegateeUserId = delegateeUserId;
+        } else {
+            this.delegationType = 0;
+            this.delegateeUserId = null;
+        }
+    }
+
+    public void setOauth2Foreground(String oauth2Foreground) {
+        this.oauth2Foreground = oauth2Foreground;
+    }
+
+    public void setOauth2Prompt(String oauth2Prompt) {
+        this.oauth2Prompt = oauth2Prompt;
+    }
+
+    public void setItCaveatTypes(String itCaveatTypes) {
+        this.itCaveatTypes = itCaveatTypes;
+    }
+
+    public void setTokenRequestOptions(String tokenRequestOptions) {
+        this.tokenRequestOptions = tokenRequestOptions;
+    }
+
+    public void putDynamicFiled(Object key, Object value) {
+        this.dynamicFields.put(key, value);
+    }
+
+    public boolean accountExists() {
+        for (Account refAccount : getAccountManager().getAccountsByType(accountType)) {
+            if (refAccount.name.equalsIgnoreCase(accountName)) return true;
+        }
+        return false;
+    }
+
+    public String peekAuthToken() {
+        Log.d(TAG, "peekAuthToken: " + buildTokenKey());
+        return getAccountManager().peekAuthToken(getAccount(), buildTokenKey());
+    }
+
+    public String getAuthToken() {
+        if (service.startsWith("weblogin:")) return null;
+        if (System.currentTimeMillis() / 1000L >= getExpiry() - 300L) {
+            Log.d(TAG, "token present, but expired");
+            return null;
+        }
+        return peekAuthToken();
+    }
+
+    public String buildExpireKey() {
+        return "EXP." + buildTokenKey();
+    }
+
+    public long getExpiry() {
+        String exp = getUserData(buildExpireKey());
+        if (exp == null) return -1;
+        return Long.parseLong(exp);
+    }
+
+    public void setAuthToken(String auth) {
+        setAuthToken(service, auth);
+    }
+
+    public void setAuthToken(String service, String auth) {
+        getAccountManager().setAuthToken(getAccount(), buildTokenKey(service), auth);
+        if (SDK_INT >= 26 && packageName != null && auth != null) {
+            // Make account persistently visible as we already granted access
+            accountManager.setAccountVisibility(getAccount(), packageName, AccountManager.VISIBILITY_VISIBLE);
+        }
+    }
+
+    public void invalidateAuthToken() {
+        String authToken = peekAuthToken();
+        invalidateAuthToken(authToken);
+    }
+
+    @SuppressLint("MissingPermission")
+    public void invalidateAuthToken(String auth) {
+        getAccountManager().invalidateAuthToken(accountType, auth);
+    }
+
+    public void storeResponse(AuthResponse response) {
+        if (service.startsWith("weblogin:")) return;
+        if (response.accountId != null)
+            setUserData("GoogleUserId", response.accountId);
+        if (response.Sid != null)
+            setAuthToken("SID", response.Sid);
+        if (response.LSid != null)
+            setAuthToken("LSID", response.LSid);
+        if (response.auth != null && (response.expiry != 0 || response.storeConsentRemotely)) {
+            setAuthToken(response.auth);
+            if (response.expiry > 0) {
+                setExpiry(response.expiry);
+            } else {
+                setExpiry(System.currentTimeMillis() / 1000 + ONE_HOUR_IN_SECONDS); // make valid for one hour by default
+            }
+        }
+    }
+
+    private boolean isSystemApp() {
+        try {
+            int flags = context.getPackageManager().getApplicationInfo(packageName, 0).flags;
+            return (flags & FLAG_SYSTEM) > 0 || (flags & FLAG_UPDATED_SYSTEM_APP) > 0;
+        } catch (PackageManager.NameNotFoundException e) {
+            return false;
+        }
+    }
+
+    @NonNull
+    public AuthResponse requestAuthWithBackgroundResolution(boolean legacy) throws IOException {
+        try {
+            return requestAuth(legacy);
+        } catch (NotOkayException e) {
+            if (e.getMessage() != null) {
+                Resolution errorResolution = ErrorResolverKt.resolveAuthErrorMessage(context, e.getMessage());
+                if (errorResolution != null) {
+                    AuthResponse response = ErrorResolverKt.initiateFromBackgroundBlocking(
+                            errorResolution,
+                            context,
+                            getAccount(),
+                            // infinite loop is prevented
+                            () -> requestAuth(legacy)
+                    );
+                    if (response == null) throw new IOException(e);
+                    return response;
+                } else {
+                    throw new IOException(e);
+                }
+            } else {
+                throw new IOException(e);
+            }
+        }
+    }
+
+    @NonNull
+    public AuthResponse requestAuthWithForegroundResolution(boolean legacy) throws IOException {
+        try {
+            return requestAuth(legacy);
+        } catch (NotOkayException e) {
+            if (e.getMessage() != null) {
+                Resolution errorResolution = ErrorResolverKt.resolveAuthErrorMessage(context, e.getMessage());
+                if (errorResolution != null) {
+                    AuthResponse response = ErrorResolverKt.initiateFromForegroundBlocking(
+                            errorResolution,
+                            context,
+                            getAccount(),
+                            // infinite loop is prevented
+                            () -> requestAuth(legacy)
+                    );
+                    if (response == null) throw new IOException(e);
+                    return response;
+                } else {
+                    throw new IOException(e);
+                }
+            } else {
+                throw new IOException(e);
+            }
+        }
+    }
+
+    @NonNull
+    public AuthResponse requestAuth(boolean legacy) throws IOException {
+        if (service.equals(AuthConstants.SCOPE_GET_ACCOUNT_ID)) {
+            AuthResponse response = new AuthResponse();
+            response.accountId = response.auth = getAccountManager().getUserData(getAccount(), "GoogleUserId");
+            return response;
+        }
+        if (isPermitted() || isTrustGooglePermitted(context)) {
+            String token = getAuthToken();
+            if (token != null && !forceRefreshToken) {
+                AuthResponse response = new AuthResponse();
+                response.issueAdvice = "stored";
+                response.auth = token;
+                if (service.startsWith("oauth2:")) {
+                    response.grantedScopes = service.substring(7);
+                }
+                response.expiry = getExpiry();
+                return response;
+            }
+        }
+        AuthRequest request = new AuthRequest().fromContext(context)
+                .source("android")
+                .app(packageName, getPackageSignature())
+                .email(accountName)
+                .token(getAccountManager().getPassword(getAccount()))
+                .service(service)
+                .delegation(delegationType, delegateeUserId)
+                .oauth2Foreground(oauth2Foreground)
+                .oauth2Prompt(oauth2Prompt)
+                .oauth2IncludeProfile(includeProfile)
+                .oauth2IncludeEmail(includeEmail)
+                .itCaveatTypes(itCaveatTypes)
+                .tokenRequestOptions(tokenRequestOptions)
+                .systemPartition(isSystemApp())
+                .hasPermission(!ignoreStoredPermission && isPermitted())
+                .putDynamicFiledMap(dynamicFields);
+        if (isGmsApp) {
+            request.appIsGms();
+        }
+        if (legacy) {
+            request.callerIsGms().calledFromAccountManager();
+        } else {
+            request.callerIsApp();
+        }
+        AuthResponse response = request.getResponse();
+        if (!isPermitted() && !isTrustGooglePermitted(context)) {
+            response.auth = null;
+        } else {
+            storeResponse(response);
+        }
+        return response;
+    }
+
+    public String getService() {
+        return service;
+    }
+}
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/auth/login/LoginActivity.java input/play-services-core/src/main/java/org/microg/gms/auth/login/LoginActivity.java
--- inputbak/play-services-core/src/main/java/org/microg/gms/auth/login/LoginActivity.java	2026-01-01 18:27:34.269989921 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/auth/login/LoginActivity.java	2026-01-01 18:28:05.489989909 +0300
@@ -78,8 +78,7 @@
 import static android.view.inputmethod.InputMethodManager.SHOW_IMPLICIT;
 import static org.microg.gms.accountsettings.ui.ExtensionsKt.EXTRA_URL;
 import static org.microg.gms.auth.AuthPrefs.isAuthVisible;
-import static org.microg.gms.common.Constants.GMS_PACKAGE_NAME;
-import static org.microg.gms.common.Constants.GMS_VERSION_CODE;
+import static org.microg.gms.common.Constants.*;
 import static org.microg.gms.common.Constants.VENDING_PACKAGE_NAME;
 import static org.microg.gms.gcm.ExtensionsKt.ACTION_GCM_REGISTER_ACCOUNT;
 import static org.microg.gms.gcm.ExtensionsKt.KEY_GCM_REGISTER_ACCOUNT_NAME;
@@ -418,7 +417,7 @@
         sendBroadcast(intent, PERMISSION_UPDATE_ACCOUNT);
     }
     private void retrieveGmsToken(final Account account) {
-        final AuthManager authManager = new AuthManager(this, account.name, GMS_PACKAGE_NAME, "ac2dm");
+        final AuthManager authManager = new AuthManager(this, account.name, GOOGLE_SERVICES_PACKAGE_NAME, "ac2dm");
         authManager.setPermitted(true);
         new AuthRequest().fromContext(this)
                 .appIsGms()
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/auth/loginservice/AccountAuthenticator.java input/play-services-core/src/main/java/org/microg/gms/auth/loginservice/AccountAuthenticator.java
--- inputbak/play-services-core/src/main/java/org/microg/gms/auth/loginservice/AccountAuthenticator.java	2026-01-01 18:27:34.269989921 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/auth/loginservice/AccountAuthenticator.java	2026-01-01 18:28:05.497989909 +0300
@@ -30,6 +30,7 @@
 import com.google.android.gms.common.internal.CertData;
 import org.microg.gms.auth.*;
 import org.microg.gms.auth.login.LoginActivity;
+import org.microg.gms.common.PackageSpoofUtils;
 import org.microg.gms.common.PackageUtils;
 import org.microg.gms.auth.AuthResponse;
 import org.microg.gms.utils.PackageManagerUtilsKt;
@@ -142,7 +143,7 @@
                 Intent i = new Intent(context, AskPermissionActivity.class);
                 i.putExtras(options);
                 i.putExtra(KEY_ACCOUNT_AUTHENTICATOR_RESPONSE, response);
-                i.putExtra(KEY_ANDROID_PACKAGE_NAME, app);
+                i.putExtra(KEY_ANDROID_PACKAGE_NAME, PackageSpoofUtils.spoofPackageName(context.getPackageManager(), app));
                 i.putExtra(KEY_ACCOUNT_TYPE, account.type);
                 i.putExtra(KEY_ACCOUNT_NAME, account.name);
                 i.putExtra(KEY_AUTHTOKEN, authTokenType);
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/gservices/GServices.java input/play-services-core/src/main/java/org/microg/gms/gservices/GServices.java
--- inputbak/play-services-core/src/main/java/org/microg/gms/gservices/GServices.java	2026-01-01 18:27:34.273989921 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/gservices/GServices.java	2026-01-01 18:28:05.497989909 +0300
@@ -20,11 +20,12 @@
 import android.content.ContentValues;
 import android.database.Cursor;
 import android.net.Uri;
+import com.google.android.gms.base.BuildConfig;
 
 public class GServices {
-    public static final Uri CONTENT_URI = Uri.parse("content://com.google.android.gsf.gservices");
-    public static final Uri MAIN_URI = Uri.parse("content://com.google.android.gsf.gservices/main");
-    public static final Uri OVERRIDE_URI = Uri.parse("content://com.google.android.gsf.gservices/override");
+    public static final Uri CONTENT_URI = Uri.parse("content://" + BuildConfig.BASE_PACKAGE_NAME + ".android.gsf.gservices");
+    public static final Uri MAIN_URI = Uri.parse("content://" + BuildConfig.BASE_PACKAGE_NAME + ".android.gsf.gservices/main");
+    public static final Uri OVERRIDE_URI = Uri.parse("content://" + BuildConfig.BASE_PACKAGE_NAME + ".android.gsf.gservices/override");
 
     public static int setString(ContentResolver resolver, String key, String value) {
         ContentValues values = new ContentValues();
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/gservices/GServicesProvider.java input/play-services-core/src/main/java/org/microg/gms/gservices/GServicesProvider.java
--- inputbak/play-services-core/src/main/java/org/microg/gms/gservices/GServicesProvider.java	2026-01-01 18:27:34.273989921 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/gservices/GServicesProvider.java	2026-01-01 18:28:05.497989909 +0300
@@ -22,6 +22,7 @@
 import android.database.MatrixCursor;
 import android.net.Uri;
 import android.util.Log;
+import com.google.android.gms.base.BuildConfig;
 
 import java.util.HashMap;
 import java.util.HashSet;
@@ -39,7 +40,7 @@
  * if certain "experiments" are enabled on the device.
  */
 public class GServicesProvider extends ContentProvider {
-    public static final Uri CONTENT_URI = Uri.parse("content://com.google.android.gsf.gservices/");
+    public static final Uri CONTENT_URI = Uri.parse("content://" + BuildConfig.BASE_PACKAGE_NAME + ".android.gsf.gservices/");
     public static final Uri MAIN_URI = Uri.withAppendedPath(CONTENT_URI, "main");
     public static final Uri OVERRIDE_URI = Uri.withAppendedPath(CONTENT_URI, "override");
     public static final Uri PREFIX_URI = Uri.withAppendedPath(CONTENT_URI, "prefix");
diff -Naur inputbak/play-services-core/src/main/java/org/microg/gms/people/PeopleManager.java input/play-services-core/src/main/java/org/microg/gms/people/PeopleManager.java
--- inputbak/play-services-core/src/main/java/org/microg/gms/people/PeopleManager.java	2026-01-01 18:27:34.277989921 +0300
+++ input/play-services-core/src/main/java/org/microg/gms/people/PeopleManager.java	2026-01-01 18:28:05.501989909 +0300
@@ -155,7 +155,7 @@
     }
 
     public static String getUserInfoAuthKey(Context context, Account account) {
-        AuthManager authManager = new AuthManager(context, account.name, Constants.GMS_PACKAGE_NAME, USERINFO_SCOPE);
+        AuthManager authManager = new AuthManager(context, account.name, Constants.GOOGLE_SERVICES_PACKAGE_NAME, USERINFO_SCOPE);
         authManager.setPermitted(true);
         String result = authManager.getAuthToken();
         if (result == null) {
diff -Naur inputbak/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/WebViewHelper.kt input/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/WebViewHelper.kt
--- inputbak/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/WebViewHelper.kt	2026-01-01 18:27:34.289989921 +0300
+++ input/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/WebViewHelper.kt	2026-01-01 18:28:05.501989909 +0300
@@ -30,6 +30,7 @@
 import org.microg.gms.auth.AuthManager
 import org.microg.gms.auth.login.LoginActivity
 import org.microg.gms.common.Constants.GMS_PACKAGE_NAME
+import org.microg.gms.common.Constants.GOOGLE_SERVICES_PACKAGE_NAME
 import org.microg.gms.common.PackageUtils
 import java.net.URLEncoder
 import java.util.Locale
@@ -186,7 +187,7 @@
     private fun openWebWithAccount(accountName: String, url: String?) {
         try {
             val service = "weblogin:continue=" + URLEncoder.encode(url, "utf-8")
-            val authManager = AuthManager(activity, accountName, GMS_PACKAGE_NAME, service)
+            val authManager = AuthManager(activity, accountName, GOOGLE_SERVICES_PACKAGE_NAME, service)
             val authUrl = authManager.requestAuthWithForegroundResolution(false)?.auth
             if (authUrl?.contains("WILL_NOT_SIGN_IN") == true) {
                 throw RuntimeException("Would not sign in")
@@ -227,4 +228,4 @@
             }.toString())
         }"
     }
-}
\ No newline at end of file
+}
diff -Naur inputbak/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/extensions.kt input/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/extensions.kt
--- inputbak/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/extensions.kt	2026-01-01 18:27:34.293989920 +0300
+++ input/play-services-core/src/main/kotlin/org/microg/gms/accountsettings/ui/extensions.kt	2026-01-01 18:28:05.505989909 +0300
@@ -14,12 +14,14 @@
 import android.webkit.WebView
 import org.microg.gms.profile.Build.VERSION.SDK_INT
 
-const val ACTION_BROWSE_SETTINGS = "com.google.android.gms.accountsettings.action.BROWSE_SETTINGS"
-const val ACTION_MY_ACCOUNT = "com.google.android.gms.accountsettings.MY_ACCOUNT"
-const val ACTION_ACCOUNT_PREFERENCES_SETTINGS = "com.google.android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS"
-const val ACTION_PRIVACY_SETTINGS = "com.google.android.gms.accountsettings.PRIVACY_SETTINGS"
-const val ACTION_SECURITY_SETTINGS = "com.google.android.gms.accountsettings.SECURITY_SETTINGS"
-const val ACTION_LOCATION_SHARING = "com.google.android.gms.location.settings.LOCATION_SHARING"
+import com.google.android.gms.base.BuildConfig
+
+const val ACTION_BROWSE_SETTINGS = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.accountsettings.action.BROWSE_SETTINGS"
+const val ACTION_MY_ACCOUNT = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.accountsettings.MY_ACCOUNT"
+const val ACTION_ACCOUNT_PREFERENCES_SETTINGS = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS"
+const val ACTION_PRIVACY_SETTINGS = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.accountsettings.PRIVACY_SETTINGS"
+const val ACTION_SECURITY_SETTINGS = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.accountsettings.SECURITY_SETTINGS"
+const val ACTION_LOCATION_SHARING = BuildConfig.BASE_PACKAGE_NAME + ".android.gms.location.settings.LOCATION_SHARING"
 
 const val EXTRA_CALLING_PACKAGE_NAME = "extra.callingPackageName"
 const val EXTRA_IGNORE_ACCOUNT = "extra.ignoreAccount"
diff -Naur inputbak/play-services-core/src/main/kotlin/org/microg/gms/chimera/ServiceProvider.kt input/play-services-core/src/main/kotlin/org/microg/gms/chimera/ServiceProvider.kt
--- inputbak/play-services-core/src/main/kotlin/org/microg/gms/chimera/ServiceProvider.kt	2026-01-01 18:27:34.297989920 +0300
+++ input/play-services-core/src/main/kotlin/org/microg/gms/chimera/ServiceProvider.kt	2026-01-01 18:28:05.505989909 +0300
@@ -15,6 +15,7 @@
 import android.os.Bundle
 import android.util.Log
 import androidx.core.os.bundleOf
+import com.google.android.gms.base.BuildConfig
 import org.microg.gms.DummyService
 import org.microg.gms.common.GmsService
 import org.microg.gms.common.RemoteListenerProxy
@@ -79,7 +80,7 @@
 
     override fun getType(uri: Uri): String {
         Log.d(TAG, "getType: $uri")
-        return "vnd.android.cursor.item/com.google.android.gms.chimera"
+        return "vnd.android.cursor.item/" + BuildConfig.BASE_PACKAGE_NAME + ".android.gms.chimera"
     }
 
     companion object {
diff -Naur inputbak/play-services-core/src/main/kotlin/org/microg/gms/games/extensions.kt input/play-services-core/src/main/kotlin/org/microg/gms/games/extensions.kt
--- inputbak/play-services-core/src/main/kotlin/org/microg/gms/games/extensions.kt	2026-01-01 18:27:34.313989920 +0300
+++ input/play-services-core/src/main/kotlin/org/microg/gms/games/extensions.kt	2026-01-01 18:28:05.505989909 +0300
@@ -218,7 +218,7 @@
 }
 
 suspend fun registerForGames(context: Context, account: Account, queue: RequestQueue = singleInstanceOf { Volley.newRequestQueue(context.applicationContext) }) {
-    val authManager = AuthManager(context, account.name, Constants.GMS_PACKAGE_NAME, "oauth2:${Scopes.GAMES_FIRSTPARTY}")
+    val authManager = AuthManager(context, account.name, Constants.GOOGLE_SERVICES_PACKAGE_NAME, "oauth2:${Scopes.GAMES_FIRSTPARTY}")
     authManager.setOauth2Foreground("1")
     val authToken = withContext(Dispatchers.IO) { authManager.requestAuthWithBackgroundResolution(false).auth }
     val androidId = getSettings(context, CheckIn.getContentUri(context), arrayOf(CheckIn.ANDROID_ID)) { cursor: Cursor -> cursor.getLong(0) }
diff -Naur inputbak/play-services-core/src/main/res/xml/authenticator.xml input/play-services-core/src/main/res/xml/authenticator.xml
--- inputbak/play-services-core/src/main/res/xml/authenticator.xml	2026-01-01 18:27:34.369989920 +0300
+++ input/play-services-core/src/main/res/xml/authenticator.xml	2026-01-01 18:28:05.509989909 +0300
@@ -16,7 +16,7 @@
 
 <account-authenticator xmlns:android="http://schemas.android.com/apk/res/android"
     android:accountPreferences="@xml/preferences_auth"
-    android:accountType="com.google"
+    android:accountType="@string/base_package_name"
     android:customTokens="true"
     android:icon="@drawable/proprietary_auth_gls_ic_google_selected"
     android:smallIcon="@drawable/proprietary_auth_gls_ic_google_minitab_selected"
diff -Naur inputbak/play-services-core/src/main/res/xml/preferences_accounts.xml input/play-services-core/src/main/res/xml/preferences_accounts.xml
--- inputbak/play-services-core/src/main/res/xml/preferences_accounts.xml	2026-01-01 18:27:34.369989920 +0300
+++ input/play-services-core/src/main/res/xml/preferences_accounts.xml	2026-01-01 18:28:05.509989909 +0300
@@ -17,7 +17,7 @@
             android:title="@string/pref_add_account_summary">
             <intent
                 android:targetClass="org.microg.gms.auth.login.LoginActivity"
-                android:targetPackage="com.google.android.gms" />
+                android:targetPackage="@string/var_pref_start_gms_package" />
         </Preference>
     </PreferenceCategory>
     <PreferenceCategory
diff -Naur inputbak/play-services-core/src/main/res/xml/preferences_auth.xml input/play-services-core/src/main/res/xml/preferences_auth.xml
--- inputbak/play-services-core/src/main/res/xml/preferences_auth.xml	2026-01-01 18:27:34.369989920 +0300
+++ input/play-services-core/src/main/res/xml/preferences_auth.xml	2026-01-01 18:28:05.509989909 +0300
@@ -19,21 +19,21 @@
         android:key="k2"
         android:title="@string/prefs_account_security">
         <intent
-            android:action="com.google.android.gms.accountsettings.SECURITY_SETTINGS"
-            android:targetPackage="@string/package_id" />
+            android:action="@string/var_pref_auth_action_security_settings"
+            android:targetPackage="@string/var_pref_start_gms_package" />
     </PreferenceScreen>
     <PreferenceScreen
         android:key="k3"
         android:title="@string/prefs_account_privacy">
         <intent
-            android:action="com.google.android.gms.accountsettings.PRIVACY_SETTINGS"
-            android:targetPackage="@string/package_id" />
+            android:action="@string/var_pref_auth_action_privacy_settings"
+            android:targetPackage="@string/var_pref_start_gms_package" />
     </PreferenceScreen>
     <PreferenceScreen
         android:key="k4"
         android:title="@string/prefs_account">
         <intent
-            android:action="com.google.android.gms.accountsettings.ACCOUNT_PREFERENCES_SETTINGS"
-            android:targetPackage="@string/package_id" />
+            android:action="@string/var_pref_auth_action_preferences_settings"
+            android:targetPackage="@string/var_pref_start_gms_package" />
     </PreferenceScreen>
 </PreferenceScreen>
diff -Naur inputbak/play-services-core/src/main/res/xml/preferences_start.xml input/play-services-core/src/main/res/xml/preferences_start.xml
--- inputbak/play-services-core/src/main/res/xml/preferences_start.xml	2026-01-01 18:27:34.373989920 +0300
+++ input/play-services-core/src/main/res/xml/preferences_start.xml	2026-01-01 18:28:05.509989909 +0300
@@ -23,7 +23,7 @@
             android:title="@string/self_check_title">
             <intent
                 android:targetClass="org.microg.gms.ui.SelfCheckFragment$AsActivity"
-                android:targetPackage="@string/package_id" />
+                android:targetPackage="@string/var_pref_start_gms_package" />
         </Preference>
     </PreferenceCategory>
     <PreferenceCategory android:title="@string/prefcat_google_services" android:key="prefcat_google_services">
@@ -59,7 +59,7 @@
             app:isPreferenceVisible="false">
             <intent
                 android:targetClass="org.microg.gms.ui.GoogleMoreFragment$AsActivity"
-                android:targetPackage="@string/package_id" />
+                android:targetPackage="@string/var_pref_start_gms_package" />
         </Preference>
     </PreferenceCategory>
     <PreferenceCategory android:layout="@layout/preference_category_no_label" android:key="prefcat_other_services">
diff -Naur inputbak/play-services-droidguard/build.gradle input/play-services-droidguard/build.gradle
--- inputbak/play-services-droidguard/build.gradle	2026-01-01 18:27:34.393989920 +0300
+++ input/play-services-droidguard/build.gradle	2026-01-01 18:28:05.513989909 +0300
@@ -22,6 +22,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-droidguard/core/src/main/AndroidManifest.xml input/play-services-droidguard/core/src/main/AndroidManifest.xml
--- inputbak/play-services-droidguard/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.393989920 +0300
+++ input/play-services-droidguard/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.513989909 +0300
@@ -15,9 +15,9 @@
             android:exported="true"
             android:process="com.google.android.gms.unstable">
             <intent-filter>
-                <action android:name="com.google.android.gms.droidguard.service.INIT" />
-                <action android:name="com.google.android.gms.droidguard.service.PING" />
-                <action android:name="com.google.android.gms.droidguard.service.START" />
+                <action android:name="${basePackageName}.android.gms.droidguard.service.INIT" />
+                <action android:name="${basePackageName}.android.gms.droidguard.service.PING" />
+                <action android:name="${basePackageName}.android.gms.droidguard.service.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
diff -Naur inputbak/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java input/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java
--- inputbak/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java	2026-01-01 18:27:34.393989920 +0300
+++ input/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java	2026-01-01 18:28:05.513989909 +0300
@@ -13,6 +13,7 @@
 
 import androidx.annotation.Nullable;
 
+import com.google.android.gms.common.BuildConfig;
 import com.google.android.gms.framework.tracing.wrapper.TracingIntentService;
 
 import org.microg.gms.droidguard.core.DroidGuardPreferences;
@@ -114,7 +115,7 @@
     @Nullable
     @Override
     public final IBinder onBind(Intent intent) {
-        if (intent != null && intent.getAction() != null && intent.getAction().equals("com.google.android.gms.droidguard.service.START")) {
+        if (intent != null && intent.getAction() != null && intent.getAction().equals(BuildConfig.BASE_PACKAGE_NAME + ".android.gms.droidguard.service.START")) {
             HardwareAttestationBlockingProvider.ensureEnabled(DroidGuardPreferences.isHardwareAttestationBlocked(this));
             SerialUnflaky.INSTANCE.fetch();
             return new DroidGuardServiceBroker(this);
diff -Naur inputbak/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java.orig input/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java.orig
--- inputbak/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-droidguard/core/src/main/java/com/google/android/gms/droidguard/DroidGuardChimeraService.java.orig	2026-01-01 18:27:15.857989928 +0300
@@ -0,0 +1,148 @@
+/*
+ * SPDX-FileCopyrightText: 2021, microG Project Team
+ * SPDX-License-Identifier: Apache-2.0
+ */
+
+package com.google.android.gms.droidguard;
+
+import android.content.Intent;
+import android.os.Handler;
+import android.os.IBinder;
+import android.util.Base64;
+import android.util.Log;
+
+import androidx.annotation.Nullable;
+
+import com.google.android.gms.framework.tracing.wrapper.TracingIntentService;
+
+import org.microg.gms.droidguard.core.DroidGuardPreferences;
+import org.microg.gms.droidguard.core.DroidGuardServiceBroker;
+import org.microg.gms.droidguard.GuardCallback;
+import org.microg.gms.droidguard.core.NetworkHandleProxyFactory;
+import org.microg.gms.droidguard.PingData;
+import org.microg.gms.droidguard.Request;
+import org.microg.gms.droidguard.core.HardwareAttestationBlockingProvider;
+import org.microg.gms.droidguard.core.SerialUnflaky;
+
+import java.util.Collections;
+import java.util.concurrent.Executor;
+import java.util.concurrent.LinkedBlockingQueue;
+import java.util.concurrent.ThreadPoolExecutor;
+import java.util.concurrent.TimeUnit;
+
+public class DroidGuardChimeraService extends TracingIntentService {
+    public static final Object a = new Object();
+    // factory
+    public NetworkHandleProxyFactory b;
+    // widevine
+    public Object c;
+    // executor
+    public Executor d;
+    // log
+    public Object e;
+
+    private static final Object f = new Object();
+
+    // ping
+    private Object g;
+    // handler
+    private Handler h;
+
+
+    public DroidGuardChimeraService() {
+        super("DG");
+        setIntentRedelivery(true);
+    }
+
+    public DroidGuardChimeraService(NetworkHandleProxyFactory factory, Object ping, Object database) {
+        super("DG");
+        setIntentRedelivery(true);
+        this.b = factory;
+        this.g = ping;
+        this.h = new Handler();
+    }
+
+    // fsc
+    private final void c(byte[] data) {
+        PingData ping = null;
+        if (data != null) {
+            Log.d("GmsGuardChimera", "c(" + Base64.encodeToString(data, Base64.NO_WRAP) + ")", new RuntimeException().fillInStackTrace());
+            try {
+                ping = PingData.ADAPTER.decode(data);
+            } catch (Exception e) {
+                Log.w("GmsGuardChimera", e);
+            }
+        } else {
+            Log.d("GmsGuardChimera", "c(null)", new RuntimeException().fillInStackTrace());
+        }
+        try {
+            byte[] bytes = b.createPingHandle(getPackageName(), "full", b(""), ping).run(Collections.emptyMap());
+            Log.d("GmsGuardChimera", "c.bytes = " + Base64.encodeToString(bytes, Base64.NO_WRAP));
+            Request fastRequest = b.createRequest("fast", getPackageName(), null, bytes);
+            b.fetchFromServer("fast", fastRequest);
+        } catch (Exception e) {
+            Log.w("GmsGuardChimera", e);
+        }
+    }
+
+    // handle intent
+    public final void a(@Nullable Intent intent) {
+        Log.d("GmsGuardChimera", "a(" + intent + ")");
+        if (intent != null && intent.getAction() != null && intent.getAction().equals("com.google.android.gms.droidguard.service.PING")) {
+            byte[] byteData = intent.getByteArrayExtra("data");
+            if (byteData == null) {
+                int[] intData = intent.getIntArrayExtra("data");
+                if (intData == null) {
+                    c(null);
+                    return;
+                }
+                byteData = new byte[intData.length];
+                for (int i = 0; i < intData.length; i++) {
+                    byteData[i] = (byte) intData[i];
+                }
+            }
+            c(byteData);
+        }
+    }
+
+    // getCallback
+    public final GuardCallback b(String packageName) {
+        Log.d("GmsGuardChimera", "b[getCallback](" + packageName + ")");
+        return new GuardCallback(this, packageName);
+    }
+
+    @Nullable
+    @Override
+    public final IBinder onBind(Intent intent) {
+        if (intent != null && intent.getAction() != null && intent.getAction().equals("com.google.android.gms.droidguard.service.START")) {
+            HardwareAttestationBlockingProvider.ensureEnabled(DroidGuardPreferences.isHardwareAttestationBlocked(this));
+            SerialUnflaky.INSTANCE.fetch();
+            return new DroidGuardServiceBroker(this);
+        }
+        return null;
+    }
+
+    @Override
+    public void onCreate() {
+        this.e = new Object();
+        this.b = new NetworkHandleProxyFactory(this);
+        this.g = new Object();
+        this.h = new Handler();
+        this.c = new Object();
+        this.d = new ThreadPoolExecutor(1, 1, 0, TimeUnit.NANOSECONDS, new LinkedBlockingQueue<>(1), new ThreadPoolExecutor.DiscardPolicy());
+        HardwareAttestationBlockingProvider.ensureEnabled(DroidGuardPreferences.isHardwareAttestationBlocked(this));
+        SerialUnflaky.INSTANCE.fetch();
+        super.onCreate();
+    }
+
+    @Override
+    public void onDestroy() {
+        super.onDestroy();
+        this.e = null;
+        this.b = null;
+        this.g = null;
+        this.h = null;
+        this.c = null;
+        this.d = null;
+    }
+}
diff -Naur inputbak/play-services-fido/core/build.gradle input/play-services-fido/core/build.gradle
--- inputbak/play-services-fido/core/build.gradle	2026-01-01 18:27:34.413989920 +0300
+++ input/play-services-fido/core/build.gradle	2026-01-01 18:28:05.517989909 +0300
@@ -44,6 +44,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     buildFeatures {
diff -Naur inputbak/play-services-fido/core/src/main/AndroidManifest.xml input/play-services-fido/core/src/main/AndroidManifest.xml
--- inputbak/play-services-fido/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.413989920 +0300
+++ input/play-services-fido/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.517989909 +0300
@@ -21,7 +21,7 @@
             android:name=".privileged.Fido2PrivilegedService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.fido.fido2.privileged.START" />
+                <action android:name="${basePackageName}.android.gms.fido.fido2.privileged.START" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </service>
diff -Naur inputbak/play-services-gcm/build.gradle input/play-services-gcm/build.gradle
--- inputbak/play-services-gcm/build.gradle	2026-01-01 18:27:34.477989920 +0300
+++ input/play-services-gcm/build.gradle	2026-01-01 18:28:05.517989909 +0300
@@ -15,6 +15,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     compileOptions {
diff -Naur inputbak/play-services-gcm/src/main/AndroidManifest.xml input/play-services-gcm/src/main/AndroidManifest.xml
--- inputbak/play-services-gcm/src/main/AndroidManifest.xml	2026-01-01 18:27:34.477989920 +0300
+++ input/play-services-gcm/src/main/AndroidManifest.xml	2026-01-01 18:28:05.517989909 +0300
@@ -18,7 +18,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android">
 
     <!-- Permissions required for GCM -->
-    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE"/>
+    <uses-permission android:name="${basePackageName}.android.c2dm.permission.RECEIVE"/>
     <uses-permission android:name="android.permission.INTERNET"/>
 
     <!-- Move to play-services-measurement -->
diff -Naur inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmListenerService.java input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmListenerService.java
--- inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmListenerService.java	2026-01-01 18:27:34.477989920 +0300
+++ input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmListenerService.java	2026-01-01 18:28:05.521989909 +0300
@@ -53,7 +53,7 @@
  *     android:name=".YourGcmListenerService"
  *     android:exported="false" >
  *     <intent-filter>
- *         <action android:name="com.google.android.c2dm.intent.RECEIVE" />
+ *         <action android:name="${basePackageName}.android.c2dm.intent.RECEIVE" />
  *     </intent-filter>
  * </service></pre>
  */
diff -Naur inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmNetworkManager.java input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmNetworkManager.java
--- inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmNetworkManager.java	2026-01-01 18:27:34.477989920 +0300
+++ input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmNetworkManager.java	2026-01-01 18:28:05.525989909 +0300
@@ -67,9 +67,9 @@
  * <pre>
  * <service android:name=".MyUploadService"
  *     android:exported="true"
- *     android:permission="com.google.android.gms.permission.BIND_NETWORK_TASK_SERVICE" >
+ *     android:permission="${basePackageName}.android.gms.permission.BIND_NETWORK_TASK_SERVICE" >
  *     <intent-filter>
- *        <action android:name="com.google.android.gms.gcm.ACTION_TASK_READY" />
+ *        <action android:name="${basePackageName}.android.gms.gcm.ACTION_TASK_READY" />
  *     </intent-filter>
  * </service>
  * </pre>
diff -Naur inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmReceiver.java input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmReceiver.java
--- inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmReceiver.java	2026-01-01 18:27:34.477989920 +0300
+++ input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmReceiver.java	2026-01-01 18:28:05.525989909 +0300
@@ -44,12 +44,12 @@
  * <p/>
  * <pre>
  * <receiver
- *     android:name="com.google.android.gms.gcm.GcmReceiver"
+ *     android:name="${basePackageName}.android.gms.gcm.GcmReceiver"
  *     android:exported="true"
- *     android:permission="com.google.android.c2dm.permission.SEND" >
+ *     android:permission="${basePackageName}.android.c2dm.permission.SEND" >
  *     <intent-filter>
- *         <action android:name="com.google.android.c2dm.intent.RECEIVE" />
- *         <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
+ *         <action android:name="${basePackageName}.android.c2dm.intent.RECEIVE" />
+ *         <action android:name="${basePackageName}.android.c2dm.intent.REGISTRATION" />
  *         <category android:name="YOUR_PACKAGE_NAME" />
  *     </intent-filter>
  * </receiver></pre>
diff -Naur inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmTaskService.java input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmTaskService.java
--- inputbak/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmTaskService.java	2026-01-01 18:27:34.477989920 +0300
+++ input/play-services-gcm/src/main/java/com/google/android/gms/gcm/GcmTaskService.java	2026-01-01 18:28:05.525989909 +0300
@@ -38,10 +38,10 @@
  * {@link com.google.android.gms.gcm.GcmTaskService#SERVICE_ACTION_EXECUTE_TASK}. Here's an example:
  * <pre>
  *     <service android:name="MyTaskService"
- *              android:permission="com.google.android.gms.permission.BIND_NETWORK_TASK_SERVICE"
+ *              android:permission="${basePackageName}.android.gms.permission.BIND_NETWORK_TASK_SERVICE"
  *              android:exported="true">
  *              <intent-filter>
- *                  <action android:name="com.google.android.gms.gcm.ACTION_TASK_READY"/>
+ *                  <action android:name="${basePackageName}.android.gms.gcm.ACTION_TASK_READY"/>
  *              </intent-filter>
  *     </service>
  * </pre>
diff -Naur inputbak/play-services-gmscompliance/core/build.gradle input/play-services-gmscompliance/core/build.gradle
--- inputbak/play-services-gmscompliance/core/build.gradle	2026-01-01 18:27:34.481989920 +0300
+++ input/play-services-gmscompliance/core/build.gradle	2026-01-01 18:28:05.529989909 +0300
@@ -35,6 +35,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-gmscompliance/core/src/main/AndroidManifest.xml input/play-services-gmscompliance/core/src/main/AndroidManifest.xml
--- inputbak/play-services-gmscompliance/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.481989920 +0300
+++ input/play-services-gmscompliance/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.529989909 +0300
@@ -9,7 +9,7 @@
     <application>
         <service android:name="org.microg.gms.gmscompliance.GmsDeviceComplianceService">
             <intent-filter>
-                <action android:name="com.google.android.gms.gmscompliance.service.START" />
+                <action android:name="${basePackageName}.android.gms.gmscompliance.service.START" />
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/play-services-iid/build.gradle input/play-services-iid/build.gradle
--- inputbak/play-services-iid/build.gradle	2026-01-01 18:27:34.481989920 +0300
+++ input/play-services-iid/build.gradle	2026-01-01 18:28:05.529989909 +0300
@@ -19,6 +19,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     compileOptions {
diff -Naur inputbak/play-services-iid/src/main/AndroidManifest.xml input/play-services-iid/src/main/AndroidManifest.xml
--- inputbak/play-services-iid/src/main/AndroidManifest.xml	2026-01-01 18:27:34.481989920 +0300
+++ input/play-services-iid/src/main/AndroidManifest.xml	2026-01-01 18:28:05.529989909 +0300
@@ -7,6 +7,6 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android">
 
     <!-- Permissions required for IID -->
-    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE"/>
+    <uses-permission android:name="${basePackageName}.android.c2dm.permission.RECEIVE"/>
     <uses-permission android:name="android.permission.INTERNET"/>
 </manifest>
diff -Naur inputbak/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java input/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java
--- inputbak/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java	2026-01-01 18:27:34.485989920 +0300
+++ input/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java	2026-01-01 18:28:05.533989909 +0300
@@ -44,7 +44,7 @@
  * <pre>
  * <service android:name=".YourInstanceIDListenerService" android:exported="false">
  *     <intent-filter>
- *         <action android:name="com.google.android.gms.iid.InstanceID"/>
+ *         <action android:name="${basePackageName}.android.gms.iid.InstanceID"/>
  *     </intent-filter>
  * </service></pre>
  * Do not export this service. Instead, keep it private to prevent other apps
diff -Naur inputbak/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java.orig input/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java.orig
--- inputbak/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java.orig	1970-01-01 03:00:00.000000000 +0300
+++ input/play-services-iid/src/main/java/com/google/android/gms/iid/InstanceIDListenerService.java.orig	2026-01-01 18:28:05.533989909 +0300
@@ -0,0 +1,139 @@
+/*
+ * Copyright (C) 2013-2017 microG Project Team
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.google.android.gms.iid;
+
+import android.app.Service;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.os.Handler;
+import android.os.IBinder;
+import android.os.Looper;
+import android.os.Message;
+import androidx.legacy.content.WakefulBroadcastReceiver;
+import com.google.android.gms.stats.GCoreWakefulBroadcastReceiver;
+
+import static org.microg.gms.gcm.GcmConstants.ACTION_C2DM_REGISTRATION;
+import static org.microg.gms.gcm.GcmConstants.ACTION_INSTANCE_ID;
+import static org.microg.gms.gcm.GcmConstants.EXTRA_FROM;
+import static org.microg.gms.gcm.GcmConstants.EXTRA_GSF_INTENT;
+
+/**
+ * Base class to handle Instance ID service notifications on token
+ * refresh.
+ * <p/>
+ * Any app using Instance ID or GCM must include a class extending
+ * InstanceIDListenerService and implement {@link com.google.android.gms.iid.InstanceIDListenerService#onTokenRefresh()}.
+ * <p/>
+ * Include the following in the manifest:
+ * <pre>
+ * <service android:name=".YourInstanceIDListenerService" android:exported="false">
+ *     <intent-filter>
+ *         <action android:name="com.google.android.gms.iid.InstanceID"/>
+ *     </intent-filter>
+ * </service></pre>
+ * Do not export this service. Instead, keep it private to prevent other apps
+ * accessing your service.
+ */
+public class InstanceIDListenerService extends Service {
+
+    private BroadcastReceiver registrationReceiver = new BroadcastReceiver() {
+        @Override
+        public void onReceive(Context context, Intent intent) {
+            handleIntent(intent);
+            stop();
+        }
+    };
+    private MessengerCompat messengerCompat = new MessengerCompat(new Handler(Looper.getMainLooper()) {
+        @Override
+        public void handleMessage(Message msg) {
+            handleIntent((Intent) msg.obj);
+        }
+    });
+
+    private int counter = 0;
+    private int startId = -1;
+
+    private void handleIntent(Intent intent) {
+        // TODO
+    }
+
+    public IBinder onBind(Intent intent) {
+        if (intent != null && ACTION_INSTANCE_ID.equals(intent.getAction())) {
+            return messengerCompat.getBinder();
+        }
+        return null;
+    }
+
+    public void onCreate() {
+        IntentFilter filter = new IntentFilter(ACTION_C2DM_REGISTRATION);
+        filter.addCategory(getPackageName());
+        registerReceiver(registrationReceiver, filter);
+    }
+
+    public void onDestroy() {
+        unregisterReceiver(registrationReceiver);
+    }
+
+    public int onStartCommand(Intent intent, int flags, int startId) {
+        synchronized (this) {
+            this.counter++;
+            if (startId > this.startId) this.startId = startId;
+        }
+        try {
+            if (intent != null) {
+                if (ACTION_INSTANCE_ID.equals(intent.getAction()) && intent.hasExtra(EXTRA_GSF_INTENT)) {
+                    startService((Intent) intent.getParcelableExtra(EXTRA_GSF_INTENT));
+                    return START_STICKY;
+                }
+
+                handleIntent(intent);
+
+                if (intent.hasExtra(EXTRA_FROM))
+                    GCoreWakefulBroadcastReceiver.completeWakefulIntent(intent);
+            }
+        } finally {
+            stop();
+        }
+        return START_NOT_STICKY;
+    }
+
+    /**
+     * Called when the system determines that the tokens need to be refreshed. The application
+     * should call getToken() and send the tokens to all application servers.
+     * <p/>
+     * This will not be called very frequently, it is needed for key rotation and to handle special
+     * cases.
+     * <p/>
+     * The system will throttle the refresh event across all devices to avoid overloading
+     * application servers with token updates.
+     */
+    public void onTokenRefresh() {
+        // To be overwritten
+    }
+
+    private void stop() {
+        synchronized (this) {
+            counter--;
+            if (counter <= 0) {
+                stopSelf(startId);
+            }
+        }
+    }
+
+}
diff -Naur inputbak/play-services-location/core/build.gradle input/play-services-location/core/build.gradle
--- inputbak/play-services-location/core/build.gradle	2026-01-01 18:27:34.489989920 +0300
+++ input/play-services-location/core/build.gradle	2026-01-01 18:28:05.533989909 +0300
@@ -43,6 +43,10 @@
         targetSdkVersion androidTargetSdk
         buildConfigField "String", "FORCE_SHOW_BACKGROUND_PERMISSION", "\"\""
         buildConfigField "boolean", "SHOW_NOTIFICATION_WHEN_NOT_PERMITTED", "false"
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     lintOptions {
diff -Naur inputbak/play-services-location/core/provider/build.gradle input/play-services-location/core/provider/build.gradle
--- inputbak/play-services-location/core/provider/build.gradle	2026-01-01 18:27:34.489989920 +0300
+++ input/play-services-location/core/provider/build.gradle	2026-01-01 18:28:05.537989909 +0300
@@ -41,6 +41,10 @@
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
         buildConfigField "String", "ICHNAEA_USER_AGENT", "\"microG/${version}\""
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-location/core/provider/src/main/AndroidManifest.xml input/play-services-location/core/provider/src/main/AndroidManifest.xml
--- inputbak/play-services-location/core/provider/src/main/AndroidManifest.xml	2026-01-01 18:27:34.489989920 +0300
+++ input/play-services-location/core/provider/src/main/AndroidManifest.xml	2026-01-01 18:28:05.537989909 +0300
@@ -78,7 +78,7 @@
             android:permission="android.permission.WRITE_SECURE_SETTINGS">
             <intent-filter>
                 <action android:name="com.android.location.service.GeocodeProvider" />
-                <action android:name="com.google.android.location.GeocodeProvider" />
+                <action android:name="${basePackageName}.android.location.GeocodeProvider" />
             </intent-filter>
             <meta-data
                 android:name="serviceVersion"
diff -Naur inputbak/play-services-location/core/src/huawei/AndroidManifest.xml input/play-services-location/core/src/huawei/AndroidManifest.xml
--- inputbak/play-services-location/core/src/huawei/AndroidManifest.xml	2026-01-01 18:27:34.497989920 +0300
+++ input/play-services-location/core/src/huawei/AndroidManifest.xml	2026-01-01 18:28:05.537989909 +0300
@@ -17,15 +17,15 @@
             android:name="org.microg.gms.location.manager.LocationManagerService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.location.internal.GoogleLocationManagerService.START" />
+                <action android:name="${basePackageName}.android.location.internal.GoogleLocationManagerService.START" />
             </intent-filter>
         </service>
         <service
             android:name="org.microg.gms.location.reporting.ReportingAndroidService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.location.reporting.service.START" />
-                <action android:name="com.google.android.gms.location.reporting.service.START" />
+                <action android:name="${basePackageName}.android.location.reporting.service.START" />
+                <action android:name="${basePackageName}.android.gms.location.reporting.service.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
diff -Naur inputbak/play-services-location/core/src/main/AndroidManifest.xml input/play-services-location/core/src/main/AndroidManifest.xml
--- inputbak/play-services-location/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.497989920 +0300
+++ input/play-services-location/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.537989909 +0300
@@ -31,7 +31,7 @@
             android:launchMode="singleTask"
             android:theme="@style/Theme.App.Translucent">
             <intent-filter android:priority="-1">
-                <action android:name="com.google.android.gms.location.settings.CHECK_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.location.settings.CHECK_SETTINGS" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
@@ -62,7 +62,7 @@
             android:name="org.microg.gms.location.manager.LocationManagerService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.location.internal.GoogleLocationManagerService.START" />
+                 <action android:name="${basePackageName}.android.location.internal.GoogleLocationManagerService.START" />
             </intent-filter>
         </service>
 
@@ -70,8 +70,8 @@
             android:name="org.microg.gms.location.reporting.ReportingAndroidService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.location.reporting.service.START" />
-                <action android:name="com.google.android.gms.location.reporting.service.START" />
+                <action android:name="${basePackageName}.android.location.reporting.service.START" />
+                <action android:name="${basePackageName}.android.gms.location.reporting.service.START" />
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
diff -Naur inputbak/play-services-maps/build.gradle input/play-services-maps/build.gradle
--- inputbak/play-services-maps/build.gradle	2026-01-01 18:27:34.541989920 +0300
+++ input/play-services-maps/build.gradle	2026-01-01 18:28:05.541989909 +0300
@@ -21,6 +21,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     compileOptions {
diff -Naur inputbak/play-services-maps/src/main/AndroidManifest.xml input/play-services-maps/src/main/AndroidManifest.xml
--- inputbak/play-services-maps/src/main/AndroidManifest.xml	2026-01-01 18:27:34.817989920 +0300
+++ input/play-services-maps/src/main/AndroidManifest.xml	2026-01-01 18:28:05.909989908 +0300
@@ -12,7 +12,7 @@
     <uses-feature android:glEsVersion="0x00020000" android:required="true"/>
 
     <queries>
-        <package android:name="com.google.android.apps.maps"/>
+        <package android:name="${basePackageName}.android.apps.maps"/>
     </queries>
 
     <application>
diff -Naur inputbak/play-services-nearby/build.gradle input/play-services-nearby/build.gradle
--- inputbak/play-services-nearby/build.gradle	2026-01-01 18:27:34.853989920 +0300
+++ input/play-services-nearby/build.gradle	2026-01-01 18:28:05.909989908 +0300
@@ -21,6 +21,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     compileOptions {
diff -Naur inputbak/play-services-nearby/core/build.gradle input/play-services-nearby/core/build.gradle
--- inputbak/play-services-nearby/core/build.gradle	2026-01-01 18:27:34.853989920 +0300
+++ input/play-services-nearby/core/build.gradle	2026-01-01 18:28:05.909989908 +0300
@@ -40,6 +40,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     buildFeatures {
diff -Naur inputbak/play-services-nearby/core/package/build.gradle input/play-services-nearby/core/package/build.gradle
--- inputbak/play-services-nearby/core/package/build.gradle	2026-01-01 18:27:34.853989920 +0300
+++ input/play-services-nearby/core/package/build.gradle	2026-01-01 18:28:05.913989908 +0300
@@ -24,6 +24,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-nearby/core/package/src/main/AndroidManifest.xml input/play-services-nearby/core/package/src/main/AndroidManifest.xml
--- inputbak/play-services-nearby/core/package/src/main/AndroidManifest.xml	2026-01-01 18:27:34.853989920 +0300
+++ input/play-services-nearby/core/package/src/main/AndroidManifest.xml	2026-01-01 18:28:05.913989908 +0300
@@ -15,7 +15,7 @@
     <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />
 
     <permission
-        android:name="com.google.android.gms.nearby.exposurenotification.EXPOSURE_CALLBACK"
+        android:name="${basePackageName}.android.gms.nearby.exposurenotification.EXPOSURE_CALLBACK"
         android:protectionLevel="normal" />
 
     <application>
diff -Naur inputbak/play-services-nearby/core/src/main/AndroidManifest.xml input/play-services-nearby/core/src/main/AndroidManifest.xml
--- inputbak/play-services-nearby/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.857989920 +0300
+++ input/play-services-nearby/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.913989908 +0300
@@ -5,7 +5,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android">
 
     <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
-    <uses-permission android:name="com.google.android.gms.nearby.exposurenotification.EXPOSURE_CALLBACK" />
+    <uses-permission android:name="${basePackageName}.android.gms.nearby.exposurenotification.EXPOSURE_CALLBACK" />
     <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
 
     <application>
@@ -30,7 +30,7 @@
             android:process=":persistent"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.nearby.exposurenotification.START" />
+                <action android:name="${basePackageName}.android.gms.nearby.exposurenotification.START" />
             </intent-filter>
         </service>
 
@@ -71,7 +71,7 @@
             android:process=":ui"
             android:theme="@style/Theme.AppCompat.DayNight">
             <intent-filter android:priority="-100">
-                <action android:name="com.google.android.gms.settings.EXPOSURE_NOTIFICATION_SETTINGS" />
+                <action android:name="${basePackageName}.android.gms.settings.EXPOSURE_NOTIFICATION_SETTINGS" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
diff -Naur inputbak/play-services-nearby/src/main/AndroidManifest.xml input/play-services-nearby/src/main/AndroidManifest.xml
--- inputbak/play-services-nearby/src/main/AndroidManifest.xml	2026-01-01 18:27:34.873989920 +0300
+++ input/play-services-nearby/src/main/AndroidManifest.xml	2026-01-01 18:28:05.913989908 +0300
@@ -6,8 +6,8 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android">
     <application>
         <service
-                android:name="com.google.android.gms.nearby.exposurenotification.WakeUpService"
+                android:name="${basePackageName}.android.gms.nearby.exposurenotification.WakeUpService"
                 android:exported="true"
-                android:permission="com.google.android.gms.nearby.exposurenotification.EXPOSURE_CALLBACK"/>
+                android:permission="${basePackageName}.android.gms.nearby.exposurenotification.EXPOSURE_CALLBACK"/>
     </application>
 </manifest>
diff -Naur inputbak/play-services-oss-licenses/build.gradle input/play-services-oss-licenses/build.gradle
--- inputbak/play-services-oss-licenses/build.gradle	2026-01-01 18:27:34.889989920 +0300
+++ input/play-services-oss-licenses/build.gradle	2026-01-01 18:28:05.913989908 +0300
@@ -21,6 +21,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     lintOptions {
diff -Naur inputbak/play-services-oss-licenses/core/build.gradle input/play-services-oss-licenses/core/build.gradle
--- inputbak/play-services-oss-licenses/core/build.gradle	2026-01-01 18:27:34.889989920 +0300
+++ input/play-services-oss-licenses/core/build.gradle	2026-01-01 18:28:05.917989908 +0300
@@ -23,6 +23,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-oss-licenses/core/src/main/AndroidManifest.xml input/play-services-oss-licenses/core/src/main/AndroidManifest.xml
--- inputbak/play-services-oss-licenses/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.889989920 +0300
+++ input/play-services-oss-licenses/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.917989908 +0300
@@ -10,7 +10,7 @@
             android:name=".OssLicensesService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.oss.licenses.service.START" />
+                <action android:name="${basePackageName}.android.gms.oss.licenses.service.START" />
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/play-services-oss-licenses/src/main/AndroidManifest.xml input/play-services-oss-licenses/src/main/AndroidManifest.xml
--- inputbak/play-services-oss-licenses/src/main/AndroidManifest.xml	2026-01-01 18:27:34.889989920 +0300
+++ input/play-services-oss-licenses/src/main/AndroidManifest.xml	2026-01-01 18:28:05.917989908 +0300
@@ -7,8 +7,8 @@
 
     <application>
         <activity
-            android:name="com.google.android.gms.oss.licenses.OssLicensesMenuActivity"
+            android:name="${basePackageName}.android.gms.oss.licenses.OssLicensesMenuActivity"
             android:label="@string/oss_license_title" />
-        <activity android:name="com.google.android.gms.oss.licenses.OssLicensesActivity" />
+        <activity android:name="${basePackageName}.android.gms.oss.licenses.OssLicensesActivity" />
     </application>
 </manifest>
diff -Naur inputbak/play-services-panorama/core/build.gradle input/play-services-panorama/core/build.gradle
--- inputbak/play-services-panorama/core/build.gradle	2026-01-01 18:27:34.905989920 +0300
+++ input/play-services-panorama/core/build.gradle	2026-01-01 18:28:05.917989908 +0300
@@ -28,6 +28,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-panorama/core/src/main/AndroidManifest.xml input/play-services-panorama/core/src/main/AndroidManifest.xml
--- inputbak/play-services-panorama/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.905989920 +0300
+++ input/play-services-panorama/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.917989908 +0300
@@ -8,7 +8,7 @@
     <application>
         <service android:name="org.microg.gms.panorama.PanoramaService">
             <intent-filter>
-                <action android:name="com.google.android.gms.panorama.service.START" />
+                <action android:name="${basePackageName}.android.gms.panorama.service.START" />
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/play-services-pay/core/build.gradle input/play-services-pay/core/build.gradle
--- inputbak/play-services-pay/core/build.gradle	2026-01-01 18:27:34.905989920 +0300
+++ input/play-services-pay/core/build.gradle	2026-01-01 18:28:05.921989908 +0300
@@ -28,6 +28,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-pay/core/src/main/AndroidManifest.xml input/play-services-pay/core/src/main/AndroidManifest.xml
--- inputbak/play-services-pay/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.905989920 +0300
+++ input/play-services-pay/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.921989908 +0300
@@ -6,13 +6,13 @@
 
     <application>
         <activity-alias
-            android:name="com.google.android.gms.pay.main.PayActivity"
+            android:name="${basePackageName}.android.gms.pay.main.PayActivity"
             android:exported="true"
             android:process=":ui"
             android:targetActivity="org.microg.gms.pay.PayActivity">
             <intent-filter>
-                <action android:name="com.google.android.gms.pay.PAY" />
-                <action android:name="com.google.android.gms.pay.PAY_OPTIONAL" />
+                <action android:name="${basePackageName}.android.gms.pay.PAY"/>
+                <action android:name="${basePackageName}.android.gms.pay.PAY_OPTIONAL"/>
 
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
@@ -24,7 +24,7 @@
 
         <service android:name="org.microg.gms.pay.PayService">
             <intent-filter>
-                <action android:name="com.google.android.gms.pay.service.BIND" />
+                <action android:name="${basePackageName}.android.gms.pay.service.BIND" />
             </intent-filter>
         </service>
         <service
diff -Naur inputbak/play-services-recaptcha/core/build.gradle input/play-services-recaptcha/core/build.gradle
--- inputbak/play-services-recaptcha/core/build.gradle	2026-01-01 18:27:34.925989920 +0300
+++ input/play-services-recaptcha/core/build.gradle	2026-01-01 18:28:05.921989908 +0300
@@ -43,6 +43,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-recaptcha/core/src/main/AndroidManifest.xml input/play-services-recaptcha/core/src/main/AndroidManifest.xml
--- inputbak/play-services-recaptcha/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.925989920 +0300
+++ input/play-services-recaptcha/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.921989908 +0300
@@ -11,7 +11,7 @@
         <service android:name="org.microg.gms.recaptcha.RecaptchaService"
                  android:process=":ui">
             <intent-filter>
-                <action android:name="com.google.android.gms.recaptcha.service.START"/>
+                <action android:name="${basePackageName}.android.gms.recaptcha.service.START"/>
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/play-services-safetynet/core/build.gradle input/play-services-safetynet/core/build.gradle
--- inputbak/play-services-safetynet/core/build.gradle	2026-01-01 18:27:34.933989920 +0300
+++ input/play-services-safetynet/core/build.gradle	2026-01-01 18:28:05.925989908 +0300
@@ -47,6 +47,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-safetynet/core/src/main/AndroidManifest.xml input/play-services-safetynet/core/src/main/AndroidManifest.xml
--- inputbak/play-services-safetynet/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.937989920 +0300
+++ input/play-services-safetynet/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.925989908 +0300
@@ -9,7 +9,7 @@
     <application>
         <service android:name="org.microg.gms.safetynet.SafetyNetClientService">
             <intent-filter>
-                <action android:name="com.google.android.gms.safetynet.service.START" />
+                <action android:name="${basePackageName}.android.gms.safetynet.service.START" />
             </intent-filter>
         </service>
         <activity
diff -Naur inputbak/play-services-tapandpay/core/build.gradle input/play-services-tapandpay/core/build.gradle
--- inputbak/play-services-tapandpay/core/build.gradle	2026-01-01 18:27:34.945989920 +0300
+++ input/play-services-tapandpay/core/build.gradle	2026-01-01 18:28:05.925989908 +0300
@@ -28,6 +28,10 @@
         versionName version
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
+
+        manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
     }
 
     sourceSets {
diff -Naur inputbak/play-services-tapandpay/core/src/main/AndroidManifest.xml input/play-services-tapandpay/core/src/main/AndroidManifest.xml
--- inputbak/play-services-tapandpay/core/src/main/AndroidManifest.xml	2026-01-01 18:27:34.945989920 +0300
+++ input/play-services-tapandpay/core/src/main/AndroidManifest.xml	2026-01-01 18:28:05.925989908 +0300
@@ -9,7 +9,7 @@
         <service android:name="org.microg.gms.tapandpay.TapAndPayService"
                  android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.gms.tapandpay.service.BIND"/>
+                <action android:name="${basePackageName}.android.gms.tapandpay.service.BIND"/>
             </intent-filter>
         </service>
     </application>
diff -Naur inputbak/vending-app/build.gradle input/vending-app/build.gradle
--- inputbak/vending-app/build.gradle	2026-01-01 18:27:35.009989920 +0300
+++ input/vending-app/build.gradle	2026-01-01 18:28:05.929989908 +0300
@@ -17,7 +17,9 @@
         versionCode vendingAppVersionCode
         minSdkVersion androidMinSdk
         targetSdkVersion androidTargetSdk
-
+	manifestPlaceholders = [
+                basePackageName: "$basePackageName"
+        ]
         multiDexEnabled true
     }
 
diff -Naur inputbak/vending-app/src/main/AndroidManifest.xml input/vending-app/src/main/AndroidManifest.xml
--- inputbak/vending-app/src/main/AndroidManifest.xml	2026-01-01 18:27:35.009989920 +0300
+++ input/vending-app/src/main/AndroidManifest.xml	2026-01-01 18:51:08.597989381 +0300
@@ -18,8 +18,8 @@
     <uses-permission android:name="org.microg.gms.permission.READ_SETTINGS" />
     <uses-permission android:name="org.microg.gms.permission.WRITE_SETTINGS" />
     <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
-    <uses-permission android:name="com.google.android.gms.permission.READ_SETTINGS" />
-    <uses-permission android:name="com.google.android.gms.permission.WRITE_SETTINGS" />
+    <uses-permission android:name="${basePackageName}.android.gms.permission.READ_SETTINGS" />
+    <uses-permission android:name="${basePackageName}.android.gms.permission.WRITE_SETTINGS" />
     <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
     <uses-permission android:name="android.permission.REQUEST_INSTALL_PACKAGES"/>
     <uses-permission android:name="android.permission.QUERY_ALL_PACKAGES" />
@@ -78,11 +78,11 @@
 
         <meta-data
             android:name="org.microg.gms.settings:source-package"
-            android:value="com.google.android.gms" />
+            android:value="${basePackageName}.android.gms" />
 
         <meta-data
             android:name="org.microg.gms.profile:source-package"
-            android:value="com.google.android.gms" />
+            android:value="${basePackageName}.android.gms" />
 
         <activity
             android:name=".GrantFakeSignaturePermissionActivity"
@@ -102,7 +102,7 @@
             android:name="com.google.android.finsky.externalreferrer.GetInstallReferrerService"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.google.android.finsky.BIND_GET_INSTALL_REFERRER_SERVICE" />
+                <action android:name="${basePackageName}.android.finsky.BIND_GET_INSTALL_REFERRER_SERVICE" />
             </intent-filter>
         </service>
 
diff -Naur inputbak/vending-app/src/main/java/org/microg/vending/billing/Constants.kt input/vending-app/src/main/java/org/microg/vending/billing/Constants.kt
--- inputbak/vending-app/src/main/java/org/microg/vending/billing/Constants.kt	2026-01-01 18:27:35.021989920 +0300
+++ input/vending-app/src/main/java/org/microg/vending/billing/Constants.kt	2026-01-01 18:28:05.929989908 +0300
@@ -5,6 +5,8 @@
 
 package org.microg.vending.billing
 
+import com.google.android.gms.common.BuildConfig
+
 const val TAG = "Billing"
 
 // TODO: What versions to use?
@@ -13,5 +15,5 @@
 const val VENDING_PACKAGE_NAME = "com.android.vending"
 // TODO: Replace key name
 const val KEY_IAP_SHEET_UI_PARAM = "key_iap_sheet_ui_param"
-const val DEFAULT_ACCOUNT_TYPE = "com.google"
+const val DEFAULT_ACCOUNT_TYPE = BuildConfig.BASE_PACKAGE_NAME
 const val ADD_PAYMENT_METHOD_URL = "https://play.google.com/store/paymentmethods"
\ No newline at end of file
